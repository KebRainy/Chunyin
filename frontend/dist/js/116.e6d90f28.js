"use strict";(self["webpackChunkdemo2"]=self["webpackChunkdemo2"]||[]).push([[116],{707:function(e,l,t){t.d(l,{_z:function(){return o},iA:function(){return r}});var a=t(7277);const n=()=>(0,a.A)({url:"/messages",method:"get"}),u=e=>(0,a.A)({url:`/messages/with/${e}`,method:"get"}),o=(e,l)=>(0,a.A)({url:`/messages/with/${e}`,method:"post",data:l}),r={fetchConversations:n,fetchConversationWith:u,sendMessage:o}},1116:function(e,l,t){t.r(l),t.d(l,{default:function(){return y}});t(4114);var a=t(641),n=t(953),u=t(33),o=t(5220),r=t(2549),s=t(707),i=t(6400),d=t(163),c=t(8548);const v={key:0,class:"user-home"},f={class:"profile-hero"},p={class:"hero-left"},k={class:"uid"},m={class:"bio"},g={class:"stats"},h={key:0,class:"hero-right"};var w={__name:"UserHome",setup(e){const l=(0,o.rd)(),t=(0,o.lq)(),w=(0,i.k)(),_=(0,n.KR)(null),b=(0,n.KR)(!1),y=(0,n.KR)(!1),L=(0,n.Kh)({content:""}),A=(0,n.KR)(!1),C=async e=>{const l=await(0,r.l2)(e);_.value=l.data},F=()=>!!w.isLoggedIn||(d.nk.warning("请先登录"),l.push("/login"),!1),V=async()=>{if(F()){b.value=!0;try{_.value.following?(await(0,r.Qt)(_.value.id),_.value.following=!1,_.value.followerCount-=1):(await(0,r.pV)(_.value.id),_.value.following=!0,_.value.followerCount+=1)}finally{b.value=!1}}},U=()=>{F()&&(y.value=!0)},W=async()=>{if(L.content.trim()){A.value=!0;try{await(0,s._z)(_.value.id,{content:L.content}),d.nk.success("私信已发送"),L.content="",y.value=!1}finally{A.value=!1}}else d.nk.warning("请输入私信内容")};return(0,a.wB)(()=>t.params.id,e=>{e&&C(e)},{immediate:!0}),(0,a.sV)(()=>{C(t.params.id)}),(e,l)=>{const t=(0,a.g2)("el-icon"),o=(0,a.g2)("el-avatar"),r=(0,a.g2)("el-button"),s=(0,a.g2)("el-empty"),i=(0,a.g2)("el-card"),d=(0,a.g2)("el-input"),w=(0,a.g2)("el-dialog");return _.value?((0,a.uX)(),(0,a.CE)("div",v,[(0,a.Lk)("div",f,[(0,a.Lk)("div",p,[(0,a.bF)(o,{size:96,src:_.value.avatarUrl,alt:`${_.value.username||"用户"}的头像`},{default:(0,a.k6)(()=>[(0,a.bF)(t,null,{default:(0,a.k6)(()=>[(0,a.bF)((0,n.R1)(c.User))]),_:1})]),_:1},8,["src","alt"]),(0,a.Lk)("div",null,[(0,a.Lk)("h2",null,(0,u.v_)(_.value.username),1),(0,a.Lk)("p",k,"UID "+(0,u.v_)(_.value.id)+" · "+(0,u.v_)(_.value.role),1),(0,a.Lk)("p",m,(0,u.v_)(_.value.bio||"这位用户很低调，还没有简介"),1),(0,a.Lk)("div",g,[(0,a.Lk)("div",null,[(0,a.Lk)("strong",null,(0,u.v_)(_.value.followerCount),1),l[3]||(l[3]=(0,a.Lk)("span",null,"粉丝",-1))]),(0,a.Lk)("div",null,[(0,a.Lk)("strong",null,(0,u.v_)(_.value.followingCount),1),l[4]||(l[4]=(0,a.Lk)("span",null,"关注",-1))])])])]),_.value.self?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("div",h,[(0,a.bF)(r,{type:"primary",plain:_.value.following,loading:b.value,onClick:V},{default:(0,a.k6)(()=>[(0,a.eW)((0,u.v_)(_.value.following?"已关注":"关注"),1)]),_:1},8,["plain","loading"]),(0,a.bF)(r,{onClick:U},{default:(0,a.k6)(()=>[...l[5]||(l[5]=[(0,a.eW)("发私信",-1)])]),_:1})]))]),(0,a.bF)(i,null,{header:(0,a.k6)(()=>[...l[6]||(l[6]=[(0,a.Lk)("div",{class:"card-header"},[(0,a.Lk)("span",null,"最近动态")],-1)])]),default:(0,a.k6)(()=>[(0,a.bF)(s,{description:"Ta 的公开动态暂未开放，敬请期待"})]),_:1}),(0,a.bF)(w,{modelValue:y.value,"onUpdate:modelValue":l[2]||(l[2]=e=>y.value=e),title:"发送私信"},{footer:(0,a.k6)(()=>[(0,a.bF)(r,{onClick:l[1]||(l[1]=e=>y.value=!1)},{default:(0,a.k6)(()=>[...l[7]||(l[7]=[(0,a.eW)("取消",-1)])]),_:1}),(0,a.bF)(r,{type:"primary",loading:A.value,onClick:W},{default:(0,a.k6)(()=>[...l[8]||(l[8]=[(0,a.eW)(" 发送 ",-1)])]),_:1},8,["loading"])]),default:(0,a.k6)(()=>[(0,a.bF)(d,{modelValue:L.content,"onUpdate:modelValue":l[0]||(l[0]=e=>L.content=e),type:"textarea",rows:4,placeholder:"把想说的话写在这里..."},null,8,["modelValue"])]),_:1},8,["modelValue"])])):((0,a.uX)(),(0,a.Wv)(s,{key:1,description:"正在加载..."}))}}},_=t(6262);const b=(0,_.A)(w,[["__scopeId","data-v-6a497190"]]);var y=b},2549:function(e,l,t){t.d(l,{Qt:function(){return s},ec:function(){return o},fG:function(){return v},hP:function(){return c},hc:function(){return i},l2:function(){return n},pV:function(){return r},qw:function(){return d},r7:function(){return u}});var a=t(7277);const n=e=>(0,a.A)({url:`/users/${e}`,method:"get"}),u=e=>(0,a.A)({url:"/users/profile",method:"put",data:e}),o=e=>(0,a.A)({url:"/users/password",method:"put",data:e}),r=e=>(0,a.A)({url:`/users/${e}/follow`,method:"post"}),s=e=>(0,a.A)({url:`/users/${e}/follow`,method:"delete"}),i=()=>(0,a.A)({url:"/users/followees",method:"get"}),d=e=>(0,a.A)({url:"/collections",method:"get",params:e}),c=e=>(0,a.A)({url:"/footprints",method:"get",params:e}),v=e=>(0,a.A)({url:"/footprints",method:"post",data:e})}}]);
//# sourceMappingURL=116.e6d90f28.js.map