{"version":3,"file":"js/116.e6d90f28.js","mappings":"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","sources":["webpack://demo2/./src/api/message.js","webpack://demo2/./src/views/user/UserHome.vue","webpack://demo2/./src/views/user/UserHome.vue?c90d","webpack://demo2/./src/api/user.js"],"sourcesContent":["import request from './request'\n\nexport const fetchConversations = () => {\n  return request({\n    url: '/messages',\n    method: 'get'\n  })\n}\n\nexport const fetchConversationWith = (userId) => {\n  return request({\n    url: `/messages/with/${userId}`,\n    method: 'get'\n  })\n}\n\nexport const sendMessage = (userId, data) => {\n  return request({\n    url: `/messages/with/${userId}`,\n    method: 'post',\n    data\n  })\n}\n\nexport const messageApi = {\n  fetchConversations,\n  fetchConversationWith,\n  sendMessage\n}\n","<template>\r\n  <div class=\"user-home\" v-if=\"profile\">\r\n    <div class=\"profile-hero\">\r\n      <div class=\"hero-left\">\r\n        <el-avatar :size=\"96\" :src=\"profile.avatarUrl\" :alt=\"`${profile.username || '用户'}的头像`\">\r\n          <el-icon><User /></el-icon>\r\n        </el-avatar>\r\n        <div>\r\n          <h2>{{ profile.username }}</h2>\r\n          <p class=\"uid\">UID {{ profile.id }} · {{ profile.role }}</p>\r\n          <p class=\"bio\">{{ profile.bio || '这位用户很低调，还没有简介' }}</p>\r\n          <div class=\"stats\">\r\n            <div>\r\n              <strong>{{ profile.followerCount }}</strong>\r\n              <span>粉丝</span>\r\n            </div>\r\n            <div>\r\n              <strong>{{ profile.followingCount }}</strong>\r\n              <span>关注</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"hero-right\" v-if=\"!profile.self\">\r\n        <el-button\r\n          type=\"primary\"\r\n          :plain=\"profile.following\"\r\n          :loading=\"followLoading\"\r\n          @click=\"toggleFollow\"\r\n        >\r\n          {{ profile.following ? '已关注' : '关注' }}\r\n        </el-button>\r\n        <el-button @click=\"openMessage\">发私信</el-button>\r\n      </div>\r\n    </div>\r\n\r\n    <el-card>\r\n      <template #header>\r\n        <div class=\"card-header\">\r\n          <span>最近动态</span>\r\n        </div>\r\n      </template>\r\n      <el-empty description=\"Ta 的公开动态暂未开放，敬请期待\" />\r\n    </el-card>\r\n\r\n    <el-dialog v-model=\"messageVisible\" title=\"发送私信\">\r\n      <el-input\r\n        v-model=\"messageForm.content\"\r\n        type=\"textarea\"\r\n        :rows=\"4\"\r\n        placeholder=\"把想说的话写在这里...\"\r\n      />\r\n      <template #footer>\r\n        <el-button @click=\"messageVisible = false\">取消</el-button>\r\n        <el-button type=\"primary\" :loading=\"messageLoading\" @click=\"sendMessageToUser\">\r\n          发送\r\n        </el-button>\r\n      </template>\r\n    </el-dialog>\r\n  </div>\r\n  <el-empty v-else description=\"正在加载...\" />\r\n</template>\r\n\r\n<script setup>\r\nimport { onMounted, reactive, ref, watch } from 'vue'\r\nimport { useRouter, useRoute } from 'vue-router'\r\nimport { fetchUserProfile, followUser, unfollowUser } from '@/api/user'\r\nimport { sendMessage } from '@/api/message'\r\nimport { useUserStore } from '@/store/modules/user'\r\nimport { ElMessage } from 'element-plus'\r\nimport { User } from '@element-plus/icons-vue'\r\n\r\nconst router = useRouter()\r\nconst route = useRoute()\r\nconst userStore = useUserStore()\r\n\r\nconst profile = ref(null)\r\nconst followLoading = ref(false)\r\n\r\nconst messageVisible = ref(false)\r\nconst messageForm = reactive({\r\n  content: ''\r\n})\r\nconst messageLoading = ref(false)\r\n\r\nconst loadProfile = async (id) => {\r\n  const res = await fetchUserProfile(id)\r\n  profile.value = res.data\r\n}\r\n\r\nconst ensureLogin = () => {\r\n  if (!userStore.isLoggedIn) {\r\n    ElMessage.warning('请先登录')\r\n    router.push('/login')\r\n    return false\r\n  }\r\n  return true\r\n}\r\n\r\nconst toggleFollow = async () => {\r\n  if (!ensureLogin()) return\r\n  followLoading.value = true\r\n  try {\r\n    if (profile.value.following) {\r\n      await unfollowUser(profile.value.id)\r\n      profile.value.following = false\r\n      profile.value.followerCount -= 1\r\n    } else {\r\n      await followUser(profile.value.id)\r\n      profile.value.following = true\r\n      profile.value.followerCount += 1\r\n    }\r\n  } finally {\r\n    followLoading.value = false\r\n  }\r\n}\r\n\r\nconst openMessage = () => {\r\n  if (!ensureLogin()) return\r\n  messageVisible.value = true\r\n}\r\n\r\nconst sendMessageToUser = async () => {\r\n  if (!messageForm.content.trim()) {\r\n    ElMessage.warning('请输入私信内容')\r\n    return\r\n  }\r\n  messageLoading.value = true\r\n  try {\r\n    await sendMessage(profile.value.id, { content: messageForm.content })\r\n    ElMessage.success('私信已发送')\r\n    messageForm.content = ''\r\n    messageVisible.value = false\r\n  } finally {\r\n    messageLoading.value = false\r\n  }\r\n}\r\n\r\nwatch(\r\n  () => route.params.id,\r\n  (newId) => {\r\n    if (newId) {\r\n      loadProfile(newId)\r\n    }\r\n  },\r\n  { immediate: true }\r\n)\r\n\r\nonMounted(() => {\r\n  loadProfile(route.params.id)\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n.user-home {\r\n  max-width: 900px;\r\n  margin: 0 auto;\r\n  padding: 24px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 20px;\r\n}\r\n\r\n.profile-hero {\r\n  background: #fff;\r\n  border-radius: 24px;\r\n  padding: 24px;\r\n  display: flex;\r\n  justify-content: space-between;\r\n  box-shadow: 0 12px 30px rgba(31, 45, 61, 0.08);\r\n}\r\n\r\n.hero-left {\r\n  display: flex;\r\n  gap: 20px;\r\n}\r\n\r\n.uid {\r\n  color: #909399;\r\n  margin: 4px 0;\r\n}\r\n\r\n.bio {\r\n  color: #606266;\r\n  margin: 8px 0;\r\n}\r\n\r\n.stats {\r\n  display: flex;\r\n  gap: 24px;\r\n}\r\n\r\n.stats div {\r\n  text-align: center;\r\n}\r\n\r\n.stats strong {\r\n  font-size: 20px;\r\n  display: block;\r\n}\r\n\r\n.stats span {\r\n  font-size: 12px;\r\n  color: #909399;\r\n}\r\n\r\n.hero-right {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 12px;\r\n}\r\n\r\n.card-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n}\r\n</style>\r\n","import script from \"./UserHome.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./UserHome.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./UserHome.vue?vue&type=style&index=0&id=6a497190&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-6a497190\"]])\n\nexport default __exports__","import request from './request'\r\n\r\nexport const fetchUserProfile = (id) => {\r\n  return request({\r\n    url: `/users/${id}`,\r\n    method: 'get'\r\n  })\r\n}\r\n\r\nexport const updateProfile = (data) => {\r\n  return request({\r\n    url: '/users/profile',\r\n    method: 'put',\r\n    data\r\n  })\r\n}\r\n\r\nexport const changePassword = (data) => {\r\n  return request({\r\n    url: '/users/password',\r\n    method: 'put',\r\n    data\r\n  })\r\n}\r\n\r\nexport const followUser = (id) => {\r\n  return request({\r\n    url: `/users/${id}/follow`,\r\n    method: 'post'\r\n  })\r\n}\r\n\r\nexport const unfollowUser = (id) => {\r\n  return request({\r\n    url: `/users/${id}/follow`,\r\n    method: 'delete'\r\n  })\r\n}\r\n\r\nexport const getFollowees = () => {\r\n  return request({\r\n    url: '/users/followees',\r\n    method: 'get'\r\n  })\r\n}\r\n\r\nexport const getCollections = (params) => {\r\n  return request({\r\n    url: '/collections',\r\n    method: 'get',\r\n    params\r\n  })\r\n}\r\n\r\nexport const getFootprints = (params) => {\r\n  return request({\r\n    url: '/footprints',\r\n    method: 'get',\r\n    params\r\n  })\r\n}\r\n\r\nexport const recordFootprint = (data) => {\r\n  return request({\r\n    url: '/footprints',\r\n    method: 'post',\r\n    data\r\n  })\r\n}\r\n"],"names":["fetchConversations","request","url","method","fetchConversationWith","userId","sendMessage","data","messageApi","router","useRouter","route","useRoute","userStore","useUserStore","profile","ref","followLoading","messageVisible","messageForm","reactive","content","messageLoading","loadProfile","async","res","fetchUserProfile","id","value","ensureLogin","isLoggedIn","ElMessage","warning","push","toggleFollow","following","unfollowUser","followerCount","followUser","openMessage","sendMessageToUser","trim","success","watch","params","newId","immediate","onMounted","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","_createVNode","_component_el_avatar","size","src","avatarUrl","alt","username","_component_el_icon","_unref","User","_toDisplayString","_hoisted_4","role","_hoisted_5","bio","_hoisted_6","followingCount","self","_hoisted_7","_component_el_button","type","plain","loading","onClick","_cache","_component_el_card","header","_withCtx","class","_component_el_empty","description","_component_el_dialog","$event","title","footer","_component_el_input","rows","placeholder","_createBlock","__exports__","updateProfile","changePassword","getFollowees","getCollections","getFootprints","recordFootprint"],"ignoreList":[],"sourceRoot":""}