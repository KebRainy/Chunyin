(self["webpackChunkdemo2"]=self["webpackChunkdemo2"]||[]).push([[144],{2549:function(e,t,a){"use strict";a.d(t,{Qt:function(){return o},ec:function(){return u},fG:function(){return v},hP:function(){return d},hc:function(){return i},l2:function(){return n},pV:function(){return r},qw:function(){return c},r7:function(){return s}});var l=a(7277);const n=e=>(0,l.A)({url:`/users/${e}`,method:"get"}),s=e=>(0,l.A)({url:"/users/profile",method:"put",data:e}),u=e=>(0,l.A)({url:"/users/password",method:"put",data:e}),r=e=>(0,l.A)({url:`/users/${e}/follow`,method:"post"}),o=e=>(0,l.A)({url:`/users/${e}/follow`,method:"delete"}),i=()=>(0,l.A)({url:"/users/followees",method:"get"}),c=e=>(0,l.A)({url:"/collections",method:"get",params:e}),d=e=>(0,l.A)({url:"/footprints",method:"get",params:e}),v=e=>(0,l.A)({url:"/footprints",method:"post",data:e})},6033:function(e,t,a){!function(t,l){e.exports=l(a(4353))}(0,function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var a=t(e),l={name:"zh-cn",weekdays:"æ˜ŸæœŸæ—¥_æ˜ŸæœŸä¸€_æ˜ŸæœŸäºŒ_æ˜ŸæœŸä¸‰_æ˜ŸæœŸå››_æ˜ŸæœŸäº”_æ˜ŸæœŸå…­".split("_"),weekdaysShort:"å‘¨æ—¥_å‘¨ä¸€_å‘¨äºŒ_å‘¨ä¸‰_å‘¨å››_å‘¨äº”_å‘¨å…­".split("_"),weekdaysMin:"æ—¥_ä¸€_äºŒ_ä¸‰_å››_äº”_å…­".split("_"),months:"ä¸€æœˆ_äºŒæœˆ_ä¸‰æœˆ_å››æœˆ_äº”æœˆ_å…­æœˆ_ä¸ƒæœˆ_å…«æœˆ_ä¹æœˆ_åæœˆ_åä¸€æœˆ_åäºŒæœˆ".split("_"),monthsShort:"1æœˆ_2æœˆ_3æœˆ_4æœˆ_5æœˆ_6æœˆ_7æœˆ_8æœˆ_9æœˆ_10æœˆ_11æœˆ_12æœˆ".split("_"),ordinal:function(e,t){return"W"===t?e+"å‘¨":e+"æ—¥"},weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYYå¹´MæœˆDæ—¥",LLL:"YYYYå¹´MæœˆDæ—¥Ahç‚¹mmåˆ†",LLLL:"YYYYå¹´MæœˆDæ—¥ddddAhç‚¹mmåˆ†",l:"YYYY/M/D",ll:"YYYYå¹´MæœˆDæ—¥",lll:"YYYYå¹´MæœˆDæ—¥ HH:mm",llll:"YYYYå¹´MæœˆDæ—¥dddd HH:mm"},relativeTime:{future:"%så†…",past:"%så‰",s:"å‡ ç§’",m:"1 åˆ†é’Ÿ",mm:"%d åˆ†é’Ÿ",h:"1 å°æ—¶",hh:"%d å°æ—¶",d:"1 å¤©",dd:"%d å¤©",M:"1 ä¸ªæœˆ",MM:"%d ä¸ªæœˆ",y:"1 å¹´",yy:"%d å¹´"},meridiem:function(e,t){var a=100*e+t;return a<600?"å‡Œæ™¨":a<900?"æ—©ä¸Š":a<1100?"ä¸Šåˆ":a<1300?"ä¸­åˆ":a<1800?"ä¸‹åˆ":"æ™šä¸Š"}};return a.default.locale(l,null,!0),l})},6144:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return ae}});a(4114);var l=a(641),n=a(33),s=a(953),u=a(5220),r=a(163),o=a(8548),i=a(4353),c=a.n(i),d=a(8660),v=a.n(d),m=(a(6033),a(4402)),f=a(2549),k=a(6400);const h={class:"post-detail-container"},p={key:0,class:"loading"},_={key:1,class:"not-found"},y={key:2,class:"post-detail"},g={class:"post-header"},C={class:"author-info"},L={class:"post-meta"},Y={class:"time"},w={key:0,class:"location"},b={key:1,class:"ip"},M={key:2,class:"ip"},F={class:"post-body"},X={class:"post-content"},E={key:0,class:"post-images"},x=["src","alt"],A={key:1,class:"post-tags"},R={class:"post-actions"},$={class:"action-item"},D={class:"action-item"},I={class:"comments-section"},H={key:0,class:"comment-input"},K={key:0,class:"reply-target"},S={key:1,class:"login-prompt"},T={class:"comments-list"},U={key:0,class:"no-comments"},z={key:1},W={class:"comment-content"},P={class:"comment-header"},Q={class:"comment-author"},V={class:"comment-time"},q={class:"comment-text"},G={class:"comment-actions"},B={key:0,class:"reply-list"},N={class:"comment-header"},j={class:"comment-author"},O={class:"comment-time"},J={class:"comment-text"};var Z={__name:"PostDetail",setup(e){c().extend(v()),c().locale("zh-cn");const t=(0,u.lq)(),a=(0,u.rd)(),i=(0,k.k)(),d=(0,s.KR)(null),Z=(0,s.KR)(!0),ee=(0,s.KR)(!1),te=(0,s.KR)(!1),ae=(0,s.KR)(""),le=(0,s.KR)(!1),ne=(0,s.KR)([]),se=(0,s.KR)(null),ue=async()=>{Z.value=!0;try{const e=await m.x.getPost(t.params.id);d.value=e.data,ee.value=e.data?.liked||!1,te.value=e.data?.favorited||!1,await re(),oe()}catch(e){r.nk.error("åŠ è½½åŠ¨æ€å¤±è´¥")}finally{Z.value=!1}},re=async()=>{try{const e=await m.x.getComments(t.params.id);ne.value=e.data||[]}catch(e){r.nk.error("åŠ è½½è¯„è®ºå¤±è´¥")}},oe=async()=>{if(i.isLoggedIn&&d.value)try{await(0,f.fG)({targetType:"POST",targetId:d.value.id,title:d.value.author?.username||"åŠ¨æ€",summary:d.value.content?.slice(0,80),coverUrl:d.value.imageUrls?.[0]})}catch(e){}},ie=e=>{if(!e)return"";const t=c()(e),a=c()(),l=a.diff(t,"minute");if(l<60)return`${Math.max(1,l)}åˆ†é’Ÿå‰`;const n=a.diff(t,"hour");return n<24?`${n}å°æ—¶å‰`:t.isSame(a,"year")?t.format("MæœˆDæ—¥ HH:mm"):t.format("YYYYå¹´MæœˆDæ—¥ HH:mm")},ce=e=>{a.push(`/users/${e}`)},de=async()=>{if(i.isLoggedIn)try{const e=await m.x.likePost(d.value.id);ee.value=e.data,d.value.likeCount=Math.max(0,(d.value.likeCount||0)+(ee.value?1:-1))}catch(e){r.nk.error("æ“ä½œå¤±è´¥ï¼Œè¯·ç¨åå†è¯•")}else r.nk.warning("è¯·å…ˆç™»å½•")},ve=async()=>{if(i.isLoggedIn)try{const e=await m.x.favoritePost(d.value.id);te.value=e.data,d.value.favoriteCount=Math.max(0,(d.value.favoriteCount||0)+(te.value?1:-1))}catch(e){r.nk.error("æ“ä½œå¤±è´¥ï¼Œè¯·ç¨åå†è¯•")}else r.nk.warning("è¯·å…ˆç™»å½•")},me=async()=>{if(ae.value.trim()){if(!i.isLoggedIn)return r.nk.warning("è¯·å…ˆç™»å½•"),void a.push("/login");le.value=!0;try{await m.x.createComment(d.value.id,{content:ae.value,parentId:se.value?.id||null}),ae.value="",se.value=null,await re(),d.value.commentCount+=1,r.nk.success("è¯„è®ºå‘å¸ƒæˆåŠŸ")}catch(e){r.nk.error("è¯„è®ºå‘å¸ƒå¤±è´¥")}finally{le.value=!1}}else r.nk.warning("è¯„è®ºå†…å®¹ä¸èƒ½ä¸ºç©º")},fe=e=>{se.value=e,ae.value=`@${e.author?.username} `};return(0,l.sV)(()=>{ue()}),(e,t)=>{const a=(0,l.g2)("el-skeleton"),u=(0,l.g2)("el-empty"),r=(0,l.g2)("el-avatar"),c=(0,l.g2)("el-tag"),v=(0,l.g2)("el-icon"),m=(0,l.g2)("el-input"),f=(0,l.g2)("el-button");return(0,l.uX)(),(0,l.CE)("div",h,[Z.value?((0,l.uX)(),(0,l.CE)("div",p,[(0,l.bF)(a,{rows:5,animated:""})])):d.value?((0,l.uX)(),(0,l.CE)("div",y,[(0,l.Lk)("div",g,[(0,l.bF)(r,{src:d.value.author.avatarUrl,size:48,class:"avatar",alt:`${d.value.author.username}çš„å¤´åƒ`,onClick:t[0]||(t[0]=e=>ce(d.value.author.id))},null,8,["src","alt"]),(0,l.Lk)("div",C,[(0,l.Lk)("div",{class:"username",onClick:t[1]||(t[1]=e=>ce(d.value.author.id))},(0,n.v_)(d.value.author.username),1),(0,l.Lk)("div",L,[(0,l.Lk)("span",Y,(0,n.v_)(ie(d.value.createdAt)),1),d.value.location?((0,l.uX)(),(0,l.CE)("span",w,"ğŸ“ "+(0,n.v_)(d.value.location),1)):(0,l.Q3)("",!0),d.value.ipRegion?((0,l.uX)(),(0,l.CE)("span",b,"IP å±åœ° "+(0,n.v_)(d.value.ipRegion),1)):d.value.ipAddressMasked?((0,l.uX)(),(0,l.CE)("span",M,(0,n.v_)(d.value.ipAddressMasked),1)):(0,l.Q3)("",!0)])])]),(0,l.Lk)("div",F,[(0,l.Lk)("div",X,(0,n.v_)(d.value.content),1),d.value.imageUrls&&d.value.imageUrls.length>0?((0,l.uX)(),(0,l.CE)("div",E,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(d.value.imageUrls,(e,t)=>((0,l.uX)(),(0,l.CE)("img",{key:t,src:e,alt:`${d.value.author?.username||"ç”¨æˆ·"}çš„åˆ†äº«å›¾ç‰‡${t+1}`,class:"post-image"},null,8,x))),128))])):(0,l.Q3)("",!0),d.value.tags?.length?((0,l.uX)(),(0,l.CE)("div",A,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(d.value.tags,e=>((0,l.uX)(),(0,l.Wv)(c,{key:e,effect:"dark"},{default:(0,l.k6)(()=>[(0,l.eW)(" # "+(0,n.v_)(e),1)]),_:2},1024))),128))])):(0,l.Q3)("",!0)]),(0,l.Lk)("div",R,[(0,l.Lk)("div",$,[(0,l.bF)(v,null,{default:(0,l.k6)(()=>[(0,l.bF)((0,s.R1)(o.View))]),_:1}),(0,l.Lk)("span",null,"æµè§ˆ "+(0,n.v_)(d.value.viewCount||0),1)]),(0,l.Lk)("div",{class:(0,n.C4)(["action-item",{active:ee.value}]),onClick:de},[(0,l.bF)(v,null,{default:(0,l.k6)(()=>[(0,l.bF)((0,s.R1)(o.GobletFull))]),_:1}),(0,l.Lk)("span",null,(0,n.v_)(ee.value?"å·²èµ":"ç‚¹èµ")+" "+(0,n.v_)(d.value.likeCount||0),1)],2),(0,l.Lk)("div",D,[(0,l.bF)(v,null,{default:(0,l.k6)(()=>[(0,l.bF)((0,s.R1)(o.ChatDotSquare))]),_:1}),(0,l.Lk)("span",null,"è¯„è®º "+(0,n.v_)(d.value.commentCount||0),1)]),(0,l.Lk)("div",{class:(0,n.C4)(["action-item",{active:te.value}]),onClick:ve},[(0,l.bF)(v,null,{default:(0,l.k6)(()=>[(0,l.bF)((0,s.R1)(o.Star))]),_:1}),(0,l.Lk)("span",null,(0,n.v_)(te.value?"å·²æ”¶è—":"æ”¶è—")+" "+(0,n.v_)(d.value.favoriteCount||0),1)],2)]),(0,l.Lk)("div",I,[t[8]||(t[8]=(0,l.Lk)("h3",null,"è¯„è®º",-1)),(0,s.R1)(i).isLoggedIn?((0,l.uX)(),(0,l.CE)("div",H,[(0,l.bF)(m,{modelValue:ae.value,"onUpdate:modelValue":t[2]||(t[2]=e=>ae.value=e),type:"textarea",placeholder:"å†™ä¸‹ä½ çš„è¯„è®º...",rows:"3"},null,8,["modelValue"]),se.value?((0,l.uX)(),(0,l.CE)("div",K,[(0,l.eW)(" å›å¤ @"+(0,n.v_)(se.value.author?.username)+" ",1),(0,l.bF)(f,{text:"",size:"small",onClick:t[3]||(t[3]=e=>se.value=null)},{default:(0,l.k6)(()=>[...t[4]||(t[4]=[(0,l.eW)("å–æ¶ˆ",-1)])]),_:1})])):(0,l.Q3)("",!0),(0,l.bF)(f,{type:"primary",onClick:me,loading:le.value},{default:(0,l.k6)(()=>[...t[5]||(t[5]=[(0,l.eW)(" å‘å¸ƒè¯„è®º ",-1)])]),_:1},8,["loading"])])):((0,l.uX)(),(0,l.CE)("div",S,[(0,l.bF)(u,{description:"è¯·ç™»å½•åå‘è¡¨è¯„è®º"})])),(0,l.Lk)("div",T,[0===ne.value.length?((0,l.uX)(),(0,l.CE)("div",U," æš‚æ— è¯„è®º ")):((0,l.uX)(),(0,l.CE)("div",z,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(ne.value,e=>((0,l.uX)(),(0,l.CE)("div",{key:e.id,class:"comment-item"},[(0,l.bF)(r,{src:e.author?.avatarUrl,size:32,alt:`${e.author?.username||"ç”¨æˆ·"}çš„å¤´åƒ`},null,8,["src","alt"]),(0,l.Lk)("div",W,[(0,l.Lk)("div",P,[(0,l.Lk)("span",Q,(0,n.v_)(e.author?.username),1),(0,l.Lk)("span",V,(0,n.v_)(ie(e.createdAt)),1)]),(0,l.Lk)("div",q,(0,n.v_)(e.content),1),(0,l.Lk)("div",G,[(0,l.bF)(f,{text:"",size:"small",onClick:t=>fe(e)},{default:(0,l.k6)(()=>[...t[6]||(t[6]=[(0,l.eW)("å›å¤",-1)])]),_:1},8,["onClick"])]),e.replies?.length?((0,l.uX)(),(0,l.CE)("div",B,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(e.replies,e=>((0,l.uX)(),(0,l.CE)("div",{key:e.id,class:"reply-item"},[(0,l.bF)(r,{src:e.author?.avatarUrl,size:24,alt:`${e.author?.username||"ç”¨æˆ·"}çš„å¤´åƒ`},null,8,["src","alt"]),(0,l.Lk)("div",null,[(0,l.Lk)("div",N,[(0,l.Lk)("span",j,(0,n.v_)(e.author?.username),1),(0,l.Lk)("span",O,(0,n.v_)(ie(e.createdAt)),1)]),(0,l.Lk)("div",J,(0,n.v_)(e.content),1),(0,l.bF)(f,{text:"",size:"small",onClick:t=>fe(e)},{default:(0,l.k6)(()=>[...t[7]||(t[7]=[(0,l.eW)("å›å¤",-1)])]),_:1},8,["onClick"])])]))),128))])):(0,l.Q3)("",!0)])]))),128))]))])])])):((0,l.uX)(),(0,l.CE)("div",_,[(0,l.bF)(u,{description:"åŠ¨æ€ä¸å­˜åœ¨æˆ–å·²è¢«åˆ é™¤"})]))])}}},ee=a(6262);const te=(0,ee.A)(Z,[["__scopeId","data-v-41931b71"]]);var ae=te},8660:function(e){!function(t,a){e.exports=a()}(0,function(){"use strict";return function(e,t,a){e=e||{};var l=t.prototype,n={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function s(e,t,a,n){return l.fromToBase(e,t,a,n)}a.en.relativeTime=n,l.fromToBase=function(t,l,s,u,r){for(var o,i,c,d=s.$locale().relativeTime||n,v=e.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],m=v.length,f=0;f<m;f+=1){var k=v[f];k.d&&(o=u?a(t).diff(s,k.d,!0):s.diff(t,k.d,!0));var h=(e.rounding||Math.round)(Math.abs(o));if(c=o>0,h<=k.r||!k.r){h<=1&&f>0&&(k=v[f-1]);var p=d[k.l];r&&(h=r(""+h)),i="string"==typeof p?p.replace("%d",h):p(h,l,k.l,c);break}}if(l)return i;var _=c?d.future:d.past;return"function"==typeof _?_(i):_.replace("%s",i)},l.to=function(e,t){return s(e,t,this,!0)},l.from=function(e,t){return s(e,t,this)};var u=function(e){return e.$u?a.utc():a()};l.toNow=function(e){return this.to(u(this),e)},l.fromNow=function(e){return this.from(u(this),e)}}})}}]);
//# sourceMappingURL=144.e08a3d96.js.map