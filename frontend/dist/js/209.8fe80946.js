"use strict";(self["webpackChunkChunyin"]=self["webpackChunkChunyin"]||[]).push([[209],{5209:function(e,a,l){l.r(a),l.d(a,{default:function(){return $}});var s=l(641),u=l(3751),t=l(33),n=l(953),r=l(4353),i=l.n(r),c=l(5220),o=l(7277);const v=e=>(0,o.A)({url:"/search",method:"get",params:e});var d=l(163);const k={class:"search-page"},p={class:"search-hero"},y={class:"search-tabs"},_=["onClick"],b={class:"result-panel"},m={key:0,class:"loading"},h={key:1},C={class:"result-header"},L={class:"eyebrow"},g={class:"result-count"},w={key:0,class:"empty"},f={key:1,class:"result-list"},F={class:"card-meta"},E={class:"card-content"},X={class:"card-actions"},A={class:"card-meta"},K={class:"card-content"},q={class:"card-actions"},W=["onClick"];var I={__name:"Search",setup(e){const a=(0,c.lq)(),l=(0,c.rd)(),r=(0,n.KR)(a.query.q||""),o=(0,n.KR)("post"),I=(0,n.KR)(!1),R=(0,n.Kh)({posts:[],wikis:[],users:[]}),Y=[{label:"动态",value:"post",description:"相关动态"},{label:"维基",value:"wiki",description:"百科词条"},{label:"用户",value:"user",description:"创作者与饮者"}],$=(0,s.EW)(()=>Y.find(e=>e.value===o.value)||Y[0]),x={post:"posts",wiki:"wikis",user:"users"},S=(0,s.EW)(()=>R[x[o.value]]||[]),U=async()=>{if(!r.value)return;I.value=!0,l.replace({path:"/search",query:{q:r.value}});const e=x[o.value];R[e]=[];try{const a=await v({keyword:r.value,type:o.value}),l=a.data||{};Array.isArray(l.items)?R[e]=l.items:Array.isArray(l[e])?R[e]=l[e]:R[e]=[]}catch(a){console.error("搜索失败:",a),d.nk.error("搜索失败，请稍后再试")}finally{I.value=!1}},V=e=>{o.value!==e&&(o.value=e,r.value&&U())},D=e=>{e&&window.open(`/posts/${e}`,"_blank")},H=e=>{e&&window.open(`/wiki/${e}`,"_blank")},M=e=>{e&&window.open(`/users/${e}`,"_blank")},j=e=>e?i()(e).format("YYYY.MM.DD HH:mm"):"";return(0,s.wB)(()=>a.query.q,e=>{r.value=e||"",r.value&&U()},{immediate:!0}),(e,a)=>{const l=(0,s.g2)("Search",!0),n=(0,s.g2)("el-icon"),i=(0,s.g2)("el-button"),c=(0,s.g2)("el-input"),v=(0,s.g2)("el-skeleton"),d=(0,s.g2)("el-empty"),R=(0,s.g2)("el-tag"),x=(0,s.g2)("User"),z=(0,s.g2)("el-avatar");return(0,s.uX)(),(0,s.CE)("div",k,[(0,s.Lk)("section",p,[a[1]||(a[1]=(0,s.Lk)("div",null,[(0,s.Lk)("p",{class:"eyebrow"},"Search"),(0,s.Lk)("h1",null,"探索醇饮社区")],-1)),(0,s.bF)(c,{modelValue:r.value,"onUpdate:modelValue":a[0]||(a[0]=e=>r.value=e),placeholder:"输入关键词，例如 IPA、陈年葡萄酒、用户名",onKeyup:(0,u.jR)(U,["enter"])},{append:(0,s.k6)(()=>[(0,s.bF)(i,{type:"primary",loading:I.value,onClick:U},{default:(0,s.k6)(()=>[(0,s.bF)(n,null,{default:(0,s.k6)(()=>[(0,s.bF)(l)]),_:1})]),_:1},8,["loading"])]),_:1},8,["modelValue"]),(0,s.Lk)("div",y,[((0,s.uX)(),(0,s.CE)(s.FK,null,(0,s.pI)(Y,e=>(0,s.Lk)("button",{key:e.value,class:(0,t.C4)(["tab-chip",{active:o.value===e.value}]),onClick:a=>V(e.value)},(0,t.v_)(e.label),11,_)),64))])]),(0,s.Lk)("section",b,[I.value?((0,s.uX)(),(0,s.CE)("div",m,[(0,s.bF)(v,{rows:5,animated:""})])):((0,s.uX)(),(0,s.CE)("div",h,[(0,s.Lk)("header",C,[(0,s.Lk)("div",null,[(0,s.Lk)("p",L,(0,t.v_)($.value.label),1),(0,s.Lk)("h3",null,(0,t.v_)($.value.description),1)]),(0,s.Lk)("span",g,(0,t.v_)(S.value.length)+" 条结果",1)]),0===S.value.length?((0,s.uX)(),(0,s.CE)("div",w,[(0,s.bF)(d,{description:"暂无相关内容"})])):((0,s.uX)(),(0,s.CE)("div",f,["post"===o.value?((0,s.uX)(!0),(0,s.CE)(s.FK,{key:0},(0,s.pI)(S.value,e=>((0,s.uX)(),(0,s.CE)("div",{class:"result-card post",key:e.id},[(0,s.Lk)("div",F,[(0,s.Lk)("strong",null,(0,t.v_)(e.author?.username||"匿名用户"),1),(0,s.Lk)("span",null,(0,t.v_)(j(e.createdAt)),1)]),(0,s.Lk)("p",E,(0,t.v_)(e.content),1),(0,s.Lk)("div",X,[e.ipRegion?((0,s.uX)(),(0,s.Wv)(R,{key:0,size:"small"},{default:(0,s.k6)(()=>[(0,s.eW)((0,t.v_)(e.ipRegion),1)]),_:2},1024)):(0,s.Q3)("",!0),(0,s.bF)(i,{text:"",type:"primary",onClick:a=>D(e.id)},{default:(0,s.k6)(()=>[...a[2]||(a[2]=[(0,s.eW)("查看动态",-1)])]),_:1},8,["onClick"])])]))),128)):"wiki"===o.value?((0,s.uX)(!0),(0,s.CE)(s.FK,{key:1},(0,s.pI)(S.value,e=>((0,s.uX)(),(0,s.CE)("div",{class:"result-card wiki",key:e.id},[(0,s.Lk)("div",A,[(0,s.Lk)("h4",null,(0,t.v_)(e.title),1),(0,s.Lk)("span",null,(0,t.v_)(j(e.updatedAt)),1)]),(0,s.Lk)("p",K,(0,t.v_)(e.summary||"这条词条暂未添加摘要"),1),(0,s.Lk)("div",q,[(0,s.Lk)("span",null,(0,t.v_)(e.lastEditorName||"系统"),1),(0,s.bF)(i,{text:"",type:"primary",onClick:a=>H(e.slug||e.id)},{default:(0,s.k6)(()=>[...a[3]||(a[3]=[(0,s.eW)("查看词条",-1)])]),_:1},8,["onClick"])])]))),128)):((0,s.uX)(!0),(0,s.CE)(s.FK,{key:2},(0,s.pI)(S.value,e=>((0,s.uX)(),(0,s.CE)("div",{class:"result-card user",key:e.id,onClick:a=>M(e.id)},[(0,s.bF)(z,{src:e.avatarUrl,alt:`${e.username}的头像`},{default:(0,s.k6)(()=>[(0,s.bF)(n,null,{default:(0,s.k6)(()=>[(0,s.bF)(x)]),_:1})]),_:1},8,["src","alt"]),(0,s.Lk)("div",null,[(0,s.Lk)("strong",null,(0,t.v_)(e.username),1),(0,s.Lk)("p",null,(0,t.v_)(e.bio||"这个人还没有简介"),1)]),(0,s.bF)(i,{text:"",type:"primary"},{default:(0,s.k6)(()=>[...a[4]||(a[4]=[(0,s.eW)("查看",-1)])]),_:1})],8,W))),128))]))]))])])}}},R=l(6262);const Y=(0,R.A)(I,[["__scopeId","data-v-04a7ce6c"]]);var $=Y}}]);
//# sourceMappingURL=209.8fe80946.js.map