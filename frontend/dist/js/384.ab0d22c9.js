"use strict";(self["webpackChunkdemo2"]=self["webpackChunkdemo2"]||[]).push([[384],{7384:function(e,a,l){l.r(a),l.d(a,{default:function(){return S}});l(4114);var t=l(641),s=l(3751),u=l(953),i=l(33),n=l(5220),r=l(8548),o=l(4353),c=l.n(o),v=l(8930),d=l(6400);const k={class:"wiki-landing"},p={class:"wiki-hero"},g={class:"hero-search"},L={class:"hero-actions"},m={class:"hero-stats"},h={class:"stat-card"},w={class:"value"},y={class:"stat-card"},f={class:"value"},C={class:"stat-card"},b={class:"value"},_={class:"wiki-content"},A={class:"list-panel"},W={class:"section-header"},R={class:"count"},E={key:0,class:"loading"},F={key:1,class:"wiki-list"},I=["onClick"],K={key:2,class:"pager"},X={key:0,class:"preview-panel"},z={class:"preview-header"},$={class:"preview-actions"},M={class:"preview-summary"},Q=["innerHTML"],D={class:"preview-meta"};var V={__name:"WikiList",setup(e){const a=(0,n.rd)(),l=(0,d.k)(),o=(0,u.KR)(""),V=(0,u.KR)([]),Y=(0,u.KR)(1),H=(0,u.KR)(6),S=(0,u.KR)(0),T=(0,u.KR)(null),j=(0,u.KR)(!1),x=(0,u.KR)({entryCount:0,editCount:0,contributorCount:0}),N=(0,t.EW)(()=>!(!l.userInfo||!T.value)&&("ADMIN"===l.userInfo.role||T.value.author?.id===l.userInfo.id)),P=async()=>{j.value=!0;try{const e=await(0,v.FW)({page:Y.value,pageSize:H.value,keyword:o.value||void 0});V.value=e.data.items||[],S.value=e.data.total||0,T.value=V.value[0]||null}catch(e){}finally{j.value=!1}},U=async()=>{const e=await(0,v.Wb)();x.value=e.data||x.value},B=()=>{Y.value=1,P()},q=e=>{Y.value=e,P()},G=e=>{T.value=e},J=()=>{a.push("/wiki/edit")},O=()=>{T.value&&a.push(`/wiki/edit/${T.value.id}`)},Z=e=>{a.push(`/wiki/${e.slug}`)},ee=e=>e?e.replace(/\n/g,"<br/>"):'<p class="empty">这个条目暂时没有正文</p>',ae=e=>c()(e).format("YYYY.MM.DD");return(0,t.sV)(()=>{P(),U()}),(e,a)=>{const n=(0,t.g2)("el-icon"),c=(0,t.g2)("el-button"),v=(0,t.g2)("el-input"),d=(0,t.g2)("el-skeleton"),P=(0,t.g2)("el-tag"),U=(0,t.g2)("el-pagination");return(0,t.uX)(),(0,t.CE)("div",k,[(0,t.Lk)("section",p,[a[6]||(a[6]=(0,t.Lk)("div",{class:"hero-content"},[(0,t.Lk)("p",{class:"eyebrow"},"醇饮百科"),(0,t.Lk)("h1",null,"搜一搜，就能找到任何关于酒饮的答案"),(0,t.Lk)("p",{class:"subtitle"},"社区共建 · 实时更新 · 支持多端访问")],-1)),(0,t.Lk)("div",g,[(0,t.bF)(v,{modelValue:o.value,"onUpdate:modelValue":a[0]||(a[0]=e=>o.value=e),placeholder:"输入关键词查找条目，如“IPA”“威士忌调和”",size:"large",onKeyup:(0,s.jR)(B,["enter"]),clearable:""},{append:(0,t.k6)(()=>[(0,t.bF)(c,{type:"primary",onClick:B},{default:(0,t.k6)(()=>[(0,t.bF)(n,null,{default:(0,t.k6)(()=>[(0,t.bF)((0,u.R1)(r.Search))]),_:1})]),_:1})]),_:1},8,["modelValue"]),(0,t.Lk)("div",L,[(0,u.R1)(l).isLoggedIn?((0,t.uX)(),(0,t.Wv)(c,{key:0,type:"primary",plain:"",onClick:J},{default:(0,t.k6)(()=>[...a[2]||(a[2]=[(0,t.eW)(" + 新建条目 ",-1)])]),_:1})):(0,t.Q3)("",!0)])]),(0,t.Lk)("div",m,[(0,t.Lk)("div",h,[(0,t.Lk)("p",w,(0,i.v_)(x.value.entryCount),1),a[3]||(a[3]=(0,t.Lk)("p",{class:"label"},"词条数量",-1))]),(0,t.Lk)("div",y,[(0,t.Lk)("p",f,(0,i.v_)(x.value.editCount),1),a[4]||(a[4]=(0,t.Lk)("p",{class:"label"},"有效编辑",-1))]),(0,t.Lk)("div",C,[(0,t.Lk)("p",b,(0,i.v_)(x.value.contributorCount),1),a[5]||(a[5]=(0,t.Lk)("p",{class:"label"},"贡献者",-1))])])]),(0,t.Lk)("section",_,[(0,t.Lk)("div",A,[(0,t.Lk)("div",W,[(0,t.Lk)("h3",null,(0,i.v_)(o.value?"搜索结果":"精选词条"),1),(0,t.Lk)("span",R,"共 "+(0,i.v_)(S.value)+" 条",1)]),j.value?((0,t.uX)(),(0,t.CE)("div",E,[(0,t.bF)(d,{rows:4,animated:""})])):((0,t.uX)(),(0,t.CE)("div",F,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(V.value,e=>((0,t.uX)(),(0,t.CE)("div",{key:e.id,class:(0,i.C4)(["wiki-item",{active:T.value?.id===e.id}]),onClick:a=>G(e)},[(0,t.Lk)("h4",null,(0,i.v_)(e.title),1),(0,t.Lk)("p",null,(0,i.v_)(e.summary||"这是一条等待补充的条目"),1),(0,t.Lk)("small",null,"更新 · "+(0,i.v_)(ae(e.updatedAt)),1),"PUBLISHED"===e.status?((0,t.uX)(),(0,t.Wv)(P,{key:0,size:"small",type:"success"},{default:(0,t.k6)(()=>[...a[7]||(a[7]=[(0,t.eW)("已发布",-1)])]),_:1})):(0,t.Q3)("",!0)],10,I))),128))])),S.value>H.value?((0,t.uX)(),(0,t.CE)("div",K,[(0,t.bF)(U,{layout:"prev, pager, next","current-page":Y.value,"page-size":H.value,total:S.value,onCurrentChange:q},null,8,["current-page","page-size","total"])])):(0,t.Q3)("",!0)]),T.value?((0,t.uX)(),(0,t.CE)("div",X,[(0,t.Lk)("div",z,[(0,t.Lk)("div",null,[a[8]||(a[8]=(0,t.Lk)("p",{class:"eyebrow"},"条目预览",-1)),(0,t.Lk)("h2",null,(0,i.v_)(T.value.title),1)]),(0,t.Lk)("div",$,[(0,t.bF)(c,{size:"small",onClick:a[1]||(a[1]=e=>Z(T.value))},{default:(0,t.k6)(()=>[...a[9]||(a[9]=[(0,t.eW)("查看详情",-1)])]),_:1}),(0,u.R1)(l).isLoggedIn&&N.value?((0,t.uX)(),(0,t.Wv)(c,{key:0,size:"small",type:"primary",onClick:O},{default:(0,t.k6)(()=>[...a[10]||(a[10]=[(0,t.eW)(" 编辑 ",-1)])]),_:1})):(0,t.Q3)("",!0)])]),(0,t.Lk)("p",M,(0,i.v_)(T.value.summary||"这条词条尚未填写摘要"),1),(0,t.Lk)("div",{class:"preview-content",innerHTML:ee(T.value.content)},null,8,Q),(0,t.Lk)("p",D,"最后编辑："+(0,i.v_)(T.value.lastEditorName||"系统")+" · "+(0,i.v_)(ae(T.value.updatedAt)),1)])):(0,t.Q3)("",!0)])])}}},Y=l(6262);const H=(0,Y.A)(V,[["__scopeId","data-v-4404b53f"]]);var S=H},8930:function(e,a,l){l.d(a,{Dz:function(){return i},ET:function(){return u},FW:function(){return s},MC:function(){return c},Q5:function(){return n},Wb:function(){return o},ko:function(){return d},xl:function(){return v},zj:function(){return r}});var t=l(7277);const s=e=>(0,t.A)({url:"/wiki/pages",method:"get",params:e}),u=e=>(0,t.A)({url:`/wiki/pages/${e}`,method:"get"}),i=e=>(0,t.A)({url:`/wiki/pages/${e}/history`,method:"get"}),n=e=>(0,t.A)({url:`/wiki/pages/${e}/discussions`,method:"get"}),r=(e,a)=>(0,t.A)({url:`/wiki/pages/${e}/discussions`,method:"post",data:a}),o=()=>(0,t.A)({url:"/wiki/pages/stats",method:"get"}),c=e=>(0,t.A)({url:"/wiki/pages",method:"post",data:e}),v=(e,a)=>(0,t.A)({url:`/wiki/pages/${e}`,method:"put",data:a}),d=e=>(0,t.A)({url:`/wiki/pages/${e}/favorite`,method:"post"})}}]);
//# sourceMappingURL=384.ab0d22c9.js.map