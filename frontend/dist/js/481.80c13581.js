"use strict";(self["webpackChunkChunyin"]=self["webpackChunkChunyin"]||[]).push([[481],{2481:function(a,e,t){t.r(e),t.d(e,{default:function(){return N}});var i=t(641),s=t(33),n=t(953),l=t(5220),r=t(163),u=t(7918),c=t(8548),v=t(8027);const d={class:"activity-detail"},o={class:"detail-container"},p={class:"card-header"},k={class:"activity-info"},m={class:"info-item"},f={key:0,class:"info-item"},y={key:0,class:"address"},g={class:"info-item"},b={class:"info-item"},E={key:1,class:"info-item remark"},h={key:2,class:"review-status"},_={key:3,class:"review-status"},C={class:"action-buttons"},L={class:"participants-list"},P={class:"participant-name"};var A={__name:"ActivityDetail",setup(a){const e=(0,l.lq)(),t=((0,l.rd)(),(0,n.KR)(!1)),A=(0,n.KR)(!1),F=(0,n.KR)(null),w=(0,n.KR)([]),N=async()=>{t.value=!0;try{const a=await(0,v.qP)(e.params.id);200===a.code&&(F.value=a.data)}catch(a){r.nk.error("加载活动详情失败")}finally{t.value=!1}},D=async()=>{try{await u.s.confirm("确定要参与此活动吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"info"}),A.value=!0;try{const a=await(0,v.Kg)(e.params.id);200===a.code&&(r.nk.success("参与成功"),await N())}catch(a){r.nk.error(a.response?.data?.message||"参与失败")}finally{A.value=!1}}catch{}},I=async()=>{try{await u.s.confirm("确定要取消参与此活动吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),A.value=!0;try{const a=await(0,v.IE)(e.params.id);200===a.code&&(r.nk.success("已取消参与"),await N())}catch(a){r.nk.error(a.response?.data?.message||"取消参与失败")}finally{A.value=!1}}catch{}},R=()=>{r.nk.info("评价功能开发中")},W=a=>{if(!a)return"";const e=new Date(a);return e.toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})},X=a=>{const e={PENDING:"待审核",APPROVED:"已通过",REJECTED:"已拒绝",ONGOING:"进行中",FINISHED:"已结束",CANCELLED:"已取消"};return e[a]||a},z=a=>{const e={PENDING:"warning",APPROVED:"success",REJECTED:"danger",ONGOING:"primary",FINISHED:"info",CANCELLED:"info"};return e[a]||""};return(0,i.sV)(()=>{N()}),(a,e)=>{const l=(0,i.g2)("el-button"),r=(0,i.g2)("el-tag"),u=(0,i.g2)("el-icon"),v=(0,i.g2)("el-alert"),N=(0,i.g2)("el-card"),Q=(0,i.g2)("el-avatar"),O=(0,i.gN)("loading");return(0,i.uX)(),(0,i.CE)("div",d,[(0,i.bo)(((0,i.uX)(),(0,i.CE)("div",o,[(0,i.bF)(l,{onClick:e[0]||(e[0]=e=>a.$router.back()),style:{"margin-bottom":"20px"}},{default:(0,i.k6)(()=>[...e[1]||(e[1]=[(0,i.eW)("返回",-1)])]),_:1}),F.value?((0,i.uX)(),(0,i.Wv)(N,{key:0,class:"activity-card"},{header:(0,i.k6)(()=>[(0,i.Lk)("div",p,[(0,i.Lk)("h2",null,(0,s.v_)(F.value.beverageName)+" 组局",1),(0,i.bF)(r,{type:z(F.value.status)},{default:(0,i.k6)(()=>[(0,i.eW)((0,s.v_)(X(F.value.status)),1)]),_:1},8,["type"])])]),default:(0,i.k6)(()=>[(0,i.Lk)("div",k,[(0,i.Lk)("div",m,[(0,i.bF)(u,null,{default:(0,i.k6)(()=>[(0,i.bF)((0,n.R1)(c.Clock))]),_:1}),e[2]||(e[2]=(0,i.Lk)("span",{class:"label"},"活动时间：",-1)),(0,i.Lk)("span",null,(0,s.v_)(W(F.value.activityTime)),1)]),F.value.barName?((0,i.uX)(),(0,i.CE)("div",f,[(0,i.bF)(u,null,{default:(0,i.k6)(()=>[(0,i.bF)((0,n.R1)(c.LocationFilled))]),_:1}),e[3]||(e[3]=(0,i.Lk)("span",{class:"label"},"酒吧：",-1)),(0,i.Lk)("span",null,(0,s.v_)(F.value.barName),1),F.value.barAddress?((0,i.uX)(),(0,i.CE)("span",y,"（"+(0,s.v_)(F.value.barAddress)+"）",1)):(0,i.Q3)("",!0)])):(0,i.Q3)("",!0),(0,i.Lk)("div",g,[(0,i.bF)(u,null,{default:(0,i.k6)(()=>[(0,i.bF)((0,n.R1)(c.User))]),_:1}),e[4]||(e[4]=(0,i.Lk)("span",{class:"label"},"参与人数：",-1)),(0,i.Lk)("span",null,(0,s.v_)(F.value.currentParticipants)+" / "+(0,s.v_)(F.value.maxParticipants)+" 人",1)]),(0,i.Lk)("div",b,[(0,i.bF)(u,null,{default:(0,i.k6)(()=>[(0,i.bF)((0,n.R1)(c.UserFilled))]),_:1}),e[5]||(e[5]=(0,i.Lk)("span",{class:"label"},"发起者：",-1)),(0,i.Lk)("span",null,(0,s.v_)(F.value.organizerName),1)]),F.value.remark?((0,i.uX)(),(0,i.CE)("div",E,[e[6]||(e[6]=(0,i.Lk)("span",{class:"label"},"备注：",-1)),(0,i.Lk)("p",null,(0,s.v_)(F.value.remark),1)])):(0,i.Q3)("",!0),"PENDING"===F.value.reviewStatus?((0,i.uX)(),(0,i.CE)("div",h,[(0,i.bF)(v,{type:"warning",closable:!1},{default:(0,i.k6)(()=>[...e[7]||(e[7]=[(0,i.eW)("活动待审核中",-1)])]),_:1})])):(0,i.Q3)("",!0),"REJECTED"===F.value.reviewStatus?((0,i.uX)(),(0,i.CE)("div",_,[(0,i.bF)(v,{type:"error",closable:!1},{default:(0,i.k6)(()=>[...e[8]||(e[8]=[(0,i.eW)("活动审核未通过",-1)])]),_:1})])):(0,i.Q3)("",!0)]),(0,i.Lk)("div",C,["APPROVED"!==F.value.reviewStatus||F.value.isParticipated||F.value.isOrganizer||F.value.isFinished?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.Wv)(l,{key:0,type:"primary",disabled:F.value.currentParticipants>=F.value.maxParticipants,onClick:D,loading:A.value},{default:(0,i.k6)(()=>[(0,i.eW)((0,s.v_)(F.value.currentParticipants>=F.value.maxParticipants?"人数已满":"参与活动"),1)]),_:1},8,["disabled","loading"])),!F.value.isParticipated||F.value.isOrganizer||F.value.isFinished?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.Wv)(l,{key:1,type:"danger",onClick:I,loading:A.value},{default:(0,i.k6)(()=>[...e[9]||(e[9]=[(0,i.eW)(" 取消参与 ",-1)])]),_:1},8,["loading"])),F.value.isFinished&&F.value.isParticipated?((0,i.uX)(),(0,i.Wv)(l,{key:2,type:"success",onClick:R},{default:(0,i.k6)(()=>[...e[10]||(e[10]=[(0,i.eW)(" 写评价 ",-1)])]),_:1})):(0,i.Q3)("",!0)])]),_:1})):(0,i.Q3)("",!0),F.value&&"APPROVED"===F.value.reviewStatus?((0,i.uX)(),(0,i.Wv)(N,{key:1,class:"participants-card"},{header:(0,i.k6)(()=>[(0,i.Lk)("h3",null,"参与者列表（"+(0,s.v_)(F.value.currentParticipants)+"人）",1)]),default:(0,i.k6)(()=>[(0,i.Lk)("div",L,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(w.value,a=>((0,i.uX)(),(0,i.CE)("div",{key:a.id,class:"participant-item"},[(0,i.bF)(Q,{src:a.avatar,size:40},{default:(0,i.k6)(()=>[(0,i.eW)((0,s.v_)(a.name?.charAt(0)),1)]),_:2},1032,["src"]),(0,i.Lk)("span",P,(0,s.v_)(a.name),1),a.id===F.value.organizerId?((0,i.uX)(),(0,i.Wv)(r,{key:0,type:"primary",size:"small"},{default:(0,i.k6)(()=>[...e[11]||(e[11]=[(0,i.eW)(" 发起者 ",-1)])]),_:1})):(0,i.Q3)("",!0)]))),128))])]),_:1})):(0,i.Q3)("",!0)])),[[O,t.value]])])}}},F=t(6262);const w=(0,F.A)(A,[["__scopeId","data-v-0a862a67"]]);var N=w},8027:function(a,e,t){t.d(e,{AJ:function(){return r},E1:function(){return s},IE:function(){return v},Kg:function(){return c},Qs:function(){return n},dR:function(){return l},h3:function(){return o},kz:function(){return d},qP:function(){return u}});t(8111),t(2489);var i=t(7277);const s=a=>(0,i.A)({url:"/activities",method:"post",data:a}),n=(a=1,e=10)=>(0,i.A)({url:"/activities/my-created",method:"get",params:{page:a,size:e}}),l=(a,e,t=1,s=10)=>(0,i.A)({url:"/activities/recommended",method:"get",params:{barId:a,beverageId:e,page:t,size:s}}),r=(a=1,e=10)=>(0,i.A)({url:"/activities/my-participated",method:"get",params:{page:a,size:e}}),u=a=>(0,i.A)({url:`/activities/${a}`,method:"get"}),c=a=>(0,i.A)({url:`/activities/${a}/join`,method:"post"}),v=a=>(0,i.A)({url:`/activities/${a}/cancel`,method:"post"}),d=(a,e)=>(0,i.A)({url:`/activities/${a}/review`,method:"post",data:e}),o=(a=1,e=10)=>(0,i.A)({url:"/activities/pending",method:"get",params:{page:a,size:e}})}}]);
//# sourceMappingURL=481.80c13581.js.map