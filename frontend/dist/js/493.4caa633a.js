"use strict";(self["webpackChunkChunyin"]=self["webpackChunkChunyin"]||[]).push([[493],{8930:function(e,a,l){l.d(a,{Dz:function(){return u},ET:function(){return i},FW:function(){return s},MC:function(){return d},Q5:function(){return o},Wb:function(){return v},dV:function(){return n},ko:function(){return p},m6:function(){return r},xl:function(){return k},zj:function(){return c}});var t=l(7277);const s=e=>(0,t.A)({url:"/wiki/pages",method:"get",params:e}),i=e=>(0,t.A)({url:`/wiki/pages/${e}`,method:"get"}),u=e=>(0,t.A)({url:`/wiki/pages/${e}/history`,method:"get"}),n=(e,a)=>(0,t.A)({url:`/wiki/pages/${e}/history/${a}`,method:"get"}),r=(e,a)=>(0,t.A)({url:`/wiki/pages/${e}/history/${a}/restore`,method:"post"}),o=e=>(0,t.A)({url:`/wiki/pages/${e}/discussions`,method:"get"}),c=(e,a)=>(0,t.A)({url:`/wiki/pages/${e}/discussions`,method:"post",data:a}),v=()=>(0,t.A)({url:"/wiki/pages/stats",method:"get"}),d=e=>(0,t.A)({url:"/wiki/pages",method:"post",data:e}),k=(e,a)=>(0,t.A)({url:`/wiki/pages/${e}`,method:"put",data:a}),p=e=>(0,t.A)({url:`/wiki/pages/${e}/favorite`,method:"post"})},9493:function(e,a,l){l.r(a),l.d(a,{default:function(){return T}});l(4114);var t=l(641),s=l(3751),i=l(953),u=l(33),n=l(5220),r=l(8548),o=l(4353),c=l.n(o),v=l(8930),d=l(6400),k=l(3263),p=l(9418);const g={class:"wiki-landing"},h={class:"wiki-hero"},L={class:"hero-search"},m={class:"hero-actions"},y={class:"hero-stats"},w={class:"stat-card"},f={class:"value"},C={class:"stat-card"},b={class:"value"},_={class:"stat-card"},A={class:"value"},W={class:"wiki-content"},$={class:"list-panel"},E={class:"section-header"},R={class:"count"},z={key:0,class:"loading"},F={key:1,class:"wiki-list"},K=["onClick"],X={key:2,class:"pager"},I={key:0,class:"preview-panel"},Q={class:"preview-header"},M={class:"preview-actions"},V={class:"preview-summary"},D=["innerHTML"],Y={class:"preview-meta"};var j={__name:"WikiList",setup(e){const a=(0,n.rd)(),l=(0,d.k)(),o=(0,i.KR)(""),j=(0,i.KR)([]),H=(0,i.KR)(1),S=(0,i.KR)(6),T=(0,i.KR)(0),x=(0,i.KR)(null),P=(0,i.KR)(!1),U=(0,i.KR)({entryCount:0,editCount:0,contributorCount:0}),B=new k.A({html:!0,linkify:!0,breaks:!0}),N=(0,t.EW)(()=>l.isLoggedIn),q=async()=>{P.value=!0;try{const e=await(0,v.FW)({page:H.value,pageSize:S.value,keyword:o.value||void 0});j.value=e.data.items||[],T.value=e.data.total||0,x.value=j.value[0]||null}catch(e){}finally{P.value=!1}},G=async()=>{const e=await(0,v.Wb)();U.value=e.data||U.value},J=()=>{H.value=1,q()},O=e=>{H.value=e,q()},Z=e=>{x.value=e},ee=()=>{a.push("/wiki/edit")},ae=()=>{x.value&&a.push(`/wiki/edit/${x.value.id}`)},le=e=>{a.push(`/wiki/${e.slug}`)},te=e=>{if(!e)return'<p class="empty">这个条目暂时没有正文</p>';const a=e.split("\n").slice(0,8).join("\n");return p.A.sanitize(B.render(a))},se=e=>c()(e).format("YYYY.MM.DD");return(0,t.sV)(()=>{q(),G()}),(e,a)=>{const n=(0,t.g2)("el-icon"),c=(0,t.g2)("el-button"),v=(0,t.g2)("el-input"),d=(0,t.g2)("el-skeleton"),k=(0,t.g2)("el-tag"),p=(0,t.g2)("el-pagination");return(0,t.uX)(),(0,t.CE)("div",g,[(0,t.Lk)("section",h,[a[6]||(a[6]=(0,t.Lk)("div",{class:"hero-content"},[(0,t.Lk)("p",{class:"eyebrow"},"醇饮百科"),(0,t.Lk)("h1",null,"搜一搜，就能找到任何关于酒饮的答案"),(0,t.Lk)("p",{class:"subtitle"},"社区共建 · 实时更新 · 支持多端访问")],-1)),(0,t.Lk)("div",L,[(0,t.bF)(v,{modelValue:o.value,"onUpdate:modelValue":a[0]||(a[0]=e=>o.value=e),placeholder:"输入关键词查找条目，如“IPA”“威士忌调和”",size:"large",onKeyup:(0,s.jR)(J,["enter"]),clearable:""},{append:(0,t.k6)(()=>[(0,t.bF)(c,{type:"primary",onClick:J},{default:(0,t.k6)(()=>[(0,t.bF)(n,null,{default:(0,t.k6)(()=>[(0,t.bF)((0,i.R1)(r.Search))]),_:1})]),_:1})]),_:1},8,["modelValue"]),(0,t.Lk)("div",m,[(0,i.R1)(l).isLoggedIn?((0,t.uX)(),(0,t.Wv)(c,{key:0,type:"primary",plain:"",onClick:ee},{default:(0,t.k6)(()=>[...a[2]||(a[2]=[(0,t.eW)(" + 新建条目 ",-1)])]),_:1})):(0,t.Q3)("",!0)])]),(0,t.Lk)("div",y,[(0,t.Lk)("div",w,[(0,t.Lk)("p",f,(0,u.v_)(U.value.entryCount),1),a[3]||(a[3]=(0,t.Lk)("p",{class:"label"},"词条数量",-1))]),(0,t.Lk)("div",C,[(0,t.Lk)("p",b,(0,u.v_)(U.value.editCount),1),a[4]||(a[4]=(0,t.Lk)("p",{class:"label"},"有效编辑",-1))]),(0,t.Lk)("div",_,[(0,t.Lk)("p",A,(0,u.v_)(U.value.contributorCount),1),a[5]||(a[5]=(0,t.Lk)("p",{class:"label"},"贡献者",-1))])])]),(0,t.Lk)("section",W,[(0,t.Lk)("div",$,[(0,t.Lk)("div",E,[(0,t.Lk)("h3",null,(0,u.v_)(o.value?"搜索结果":"精选词条"),1),(0,t.Lk)("span",R,"共 "+(0,u.v_)(T.value)+" 条",1)]),P.value?((0,t.uX)(),(0,t.CE)("div",z,[(0,t.bF)(d,{rows:4,animated:""})])):((0,t.uX)(),(0,t.CE)("div",F,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(j.value,e=>((0,t.uX)(),(0,t.CE)("div",{key:e.id,class:(0,u.C4)(["wiki-item",{active:x.value?.id===e.id}]),onClick:a=>Z(e)},[(0,t.Lk)("h4",null,(0,u.v_)(e.title),1),(0,t.Lk)("p",null,(0,u.v_)(e.summary||"这是一条等待补充的条目"),1),(0,t.Lk)("small",null,"更新 · "+(0,u.v_)(se(e.updatedAt)),1),"PUBLISHED"===e.status?((0,t.uX)(),(0,t.Wv)(k,{key:0,size:"small",type:"success"},{default:(0,t.k6)(()=>[...a[7]||(a[7]=[(0,t.eW)("已发布",-1)])]),_:1})):(0,t.Q3)("",!0)],10,K))),128))])),T.value>S.value?((0,t.uX)(),(0,t.CE)("div",X,[(0,t.bF)(p,{layout:"prev, pager, next","current-page":H.value,"page-size":S.value,total:T.value,onCurrentChange:O},null,8,["current-page","page-size","total"])])):(0,t.Q3)("",!0)]),x.value?((0,t.uX)(),(0,t.CE)("div",I,[(0,t.Lk)("div",Q,[(0,t.Lk)("div",null,[a[8]||(a[8]=(0,t.Lk)("p",{class:"eyebrow"},"条目预览",-1)),(0,t.Lk)("h2",null,(0,u.v_)(x.value.title),1)]),(0,t.Lk)("div",M,[(0,t.bF)(c,{size:"small",onClick:a[1]||(a[1]=e=>le(x.value))},{default:(0,t.k6)(()=>[...a[9]||(a[9]=[(0,t.eW)("查看详情",-1)])]),_:1}),N.value&&x.value?((0,t.uX)(),(0,t.Wv)(c,{key:0,size:"small",type:"primary",onClick:ae},{default:(0,t.k6)(()=>[...a[10]||(a[10]=[(0,t.eW)(" 编辑 ",-1)])]),_:1})):(0,t.Q3)("",!0)])]),(0,t.Lk)("p",V,(0,u.v_)(x.value.summary||"这条词条尚未填写摘要"),1),(0,t.Lk)("div",{class:"preview-content",innerHTML:te(x.value.content)},null,8,D),(0,t.Lk)("p",Y,"最后编辑："+(0,u.v_)(x.value.lastEditorName||"系统")+" · "+(0,u.v_)(se(x.value.updatedAt)),1)])):(0,t.Q3)("",!0)])])}}},H=l(6262);const S=(0,H.A)(j,[["__scopeId","data-v-abb257de"]]);var T=S}}]);
//# sourceMappingURL=493.4caa633a.js.map