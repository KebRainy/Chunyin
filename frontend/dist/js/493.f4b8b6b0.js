"use strict";(self["webpackChunkChunyin"]=self["webpackChunkChunyin"]||[]).push([[493],{9493:function(e,a,l){l.r(a),l.d(a,{default:function(){return T}});l(4114);var s=l(641),t=l(3751),u=l(953),i=l(33),n=l(5220),v=l(8548),c=l(4353),r=l.n(c),k=l(8930),o=l(6400),d=l(3263),p=l(9418);const L={class:"wiki-landing"},y={class:"wiki-hero"},C={class:"hero-search"},g={class:"hero-actions"},h={class:"hero-stats"},m={class:"stat-card"},b={class:"value"},w={class:"stat-card"},_={class:"value"},f={class:"stat-card"},R={class:"value"},W={class:"wiki-content"},E={class:"list-panel"},K={class:"section-header"},X={class:"count"},F={key:0,class:"loading"},z={key:1,class:"wiki-list"},A=["onClick"],I={key:2,class:"pager"},Q={key:0,class:"preview-panel"},M={class:"preview-header"},V={class:"preview-actions"},Y={class:"preview-summary"},D=["innerHTML"],H={class:"preview-meta"};var S={__name:"WikiList",setup(e){const a=(0,n.rd)(),l=(0,o.k)(),c=(0,u.KR)(""),S=(0,u.KR)([]),j=(0,u.KR)(1),P=(0,u.KR)(6),T=(0,u.KR)(0),U=(0,u.KR)(null),$=(0,u.KR)(!1),x=(0,u.KR)({entryCount:0,editCount:0,contributorCount:0}),B=new d.A({html:!0,linkify:!0,breaks:!0}),N=(0,s.EW)(()=>l.isLoggedIn),q=async()=>{$.value=!0;try{const e=await(0,k.FW)({page:j.value,pageSize:P.value,keyword:c.value||void 0});S.value=e.data.items||[],T.value=e.data.total||0,U.value=S.value[0]||null}catch(e){}finally{$.value=!1}},G=async()=>{const e=await(0,k.Wb)();x.value=e.data||x.value},J=()=>{j.value=1,q()},O=e=>{j.value=e,q()},Z=e=>{U.value=e},ee=()=>{a.push("/wiki/edit")},ae=()=>{U.value&&a.push(`/wiki/edit/${U.value.id}`)},le=e=>{a.push(`/wiki/${e.slug}`)},se=e=>{if(!e)return'<p class="empty">这个条目暂时没有正文</p>';const a=e.split("\n").slice(0,8).join("\n");return p.A.sanitize(B.render(a))},te=e=>r()(e).format("YYYY.MM.DD");return(0,s.sV)(()=>{q(),G()}),(e,a)=>{const n=(0,s.g2)("el-icon"),r=(0,s.g2)("el-button"),k=(0,s.g2)("el-input"),o=(0,s.g2)("el-skeleton"),d=(0,s.g2)("el-tag"),p=(0,s.g2)("el-pagination");return(0,s.uX)(),(0,s.CE)("div",L,[(0,s.Lk)("section",y,[a[6]||(a[6]=(0,s.Lk)("div",{class:"hero-content"},[(0,s.Lk)("p",{class:"eyebrow"},"醇饮百科"),(0,s.Lk)("h1",null,"搜一搜，就能找到任何关于酒饮的答案"),(0,s.Lk)("p",{class:"subtitle"},"社区共建 · 实时更新 · 支持多端访问")],-1)),(0,s.Lk)("div",C,[(0,s.bF)(k,{modelValue:c.value,"onUpdate:modelValue":a[0]||(a[0]=e=>c.value=e),placeholder:"输入关键词查找条目，如“IPA”“威士忌调和”",size:"large",onKeyup:(0,t.jR)(J,["enter"]),clearable:""},{append:(0,s.k6)(()=>[(0,s.bF)(r,{type:"primary",onClick:J},{default:(0,s.k6)(()=>[(0,s.bF)(n,null,{default:(0,s.k6)(()=>[(0,s.bF)((0,u.R1)(v.Search))]),_:1})]),_:1})]),_:1},8,["modelValue"]),(0,s.Lk)("div",g,[(0,u.R1)(l).isLoggedIn?((0,s.uX)(),(0,s.Wv)(r,{key:0,type:"primary",plain:"",onClick:ee},{default:(0,s.k6)(()=>[...a[2]||(a[2]=[(0,s.eW)(" + 新建条目 ",-1)])]),_:1})):(0,s.Q3)("",!0)])]),(0,s.Lk)("div",h,[(0,s.Lk)("div",m,[(0,s.Lk)("p",b,(0,i.v_)(x.value.entryCount),1),a[3]||(a[3]=(0,s.Lk)("p",{class:"label"},"词条数量",-1))]),(0,s.Lk)("div",w,[(0,s.Lk)("p",_,(0,i.v_)(x.value.editCount),1),a[4]||(a[4]=(0,s.Lk)("p",{class:"label"},"有效编辑",-1))]),(0,s.Lk)("div",f,[(0,s.Lk)("p",R,(0,i.v_)(x.value.contributorCount),1),a[5]||(a[5]=(0,s.Lk)("p",{class:"label"},"贡献者",-1))])])]),(0,s.Lk)("section",W,[(0,s.Lk)("div",E,[(0,s.Lk)("div",K,[(0,s.Lk)("h3",null,(0,i.v_)(c.value?"搜索结果":"精选词条"),1),(0,s.Lk)("span",X,"共 "+(0,i.v_)(T.value)+" 条",1)]),$.value?((0,s.uX)(),(0,s.CE)("div",F,[(0,s.bF)(o,{rows:4,animated:""})])):((0,s.uX)(),(0,s.CE)("div",z,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(S.value,e=>((0,s.uX)(),(0,s.CE)("div",{key:e.id,class:(0,i.C4)(["wiki-item",{active:U.value?.id===e.id}]),onClick:a=>Z(e)},[(0,s.Lk)("h4",null,(0,i.v_)(e.title),1),(0,s.Lk)("p",null,(0,i.v_)(e.summary||"这是一条等待补充的条目"),1),(0,s.Lk)("small",null,"更新 · "+(0,i.v_)(te(e.updatedAt)),1),"PUBLISHED"===e.status?((0,s.uX)(),(0,s.Wv)(d,{key:0,size:"small",type:"success"},{default:(0,s.k6)(()=>[...a[7]||(a[7]=[(0,s.eW)("已发布",-1)])]),_:1})):(0,s.Q3)("",!0)],10,A))),128))])),T.value>P.value?((0,s.uX)(),(0,s.CE)("div",I,[(0,s.bF)(p,{layout:"prev, pager, next","current-page":j.value,"page-size":P.value,total:T.value,onCurrentChange:O},null,8,["current-page","page-size","total"])])):(0,s.Q3)("",!0)]),U.value?((0,s.uX)(),(0,s.CE)("div",Q,[(0,s.Lk)("div",M,[(0,s.Lk)("div",null,[a[8]||(a[8]=(0,s.Lk)("p",{class:"eyebrow"},"条目预览",-1)),(0,s.Lk)("h2",null,(0,i.v_)(U.value.title),1)]),(0,s.Lk)("div",V,[(0,s.bF)(r,{size:"small",onClick:a[1]||(a[1]=e=>le(U.value))},{default:(0,s.k6)(()=>[...a[9]||(a[9]=[(0,s.eW)("查看详情",-1)])]),_:1}),N.value&&U.value?((0,s.uX)(),(0,s.Wv)(r,{key:0,size:"small",type:"primary",onClick:ae},{default:(0,s.k6)(()=>[...a[10]||(a[10]=[(0,s.eW)(" 编辑 ",-1)])]),_:1})):(0,s.Q3)("",!0)])]),(0,s.Lk)("p",Y,(0,i.v_)(U.value.summary||"这条词条尚未填写摘要"),1),(0,s.Lk)("div",{class:"preview-content",innerHTML:se(U.value.content)},null,8,D),(0,s.Lk)("p",H,"最后编辑："+(0,i.v_)(U.value.lastEditorName||"系统")+" · "+(0,i.v_)(te(U.value.updatedAt)),1)])):(0,s.Q3)("",!0)])])}}},j=l(6262);const P=(0,j.A)(S,[["__scopeId","data-v-abb257de"]]);var T=P}}]);
//# sourceMappingURL=493.f4b8b6b0.js.map