(self["webpackChunkChunyin"]=self["webpackChunkChunyin"]||[]).push([[563],{2549:function(e,t,s){"use strict";s.d(t,{Qt:function(){return u},ec:function(){return o},fG:function(){return v},hP:function(){return d},hc:function(){return i},l2:function(){return l},pV:function(){return r},qw:function(){return c},r7:function(){return n}});var a=s(7277);const l=e=>(0,a.A)({url:`/users/${e}`,method:"get"}),n=e=>(0,a.A)({url:"/users/profile",method:"put",data:e}),o=e=>(0,a.A)({url:"/users/password",method:"put",data:e}),r=e=>(0,a.A)({url:`/users/${e}/follow`,method:"post"}),u=e=>(0,a.A)({url:`/users/${e}/follow`,method:"delete"}),i=()=>(0,a.A)({url:"/users/followees",method:"get"}),c=e=>(0,a.A)({url:"/collections",method:"get",params:e}),d=e=>(0,a.A)({url:"/footprints",method:"get",params:e}),v=e=>(0,a.A)({url:"/footprints",method:"post",data:e})},6617:function(e,t,s){"use strict";s.d(t,{A:function(){return W}});var a=s(641),l=s(33),n=s(953),o=s(4353),r=s.n(o),u=s(8660),i=s.n(u),c=s(8548);const d={key:0,class:"recommend-badge"},v={key:1,class:"card-media"},f=["src","alt"],m={class:"image-overlay"},p={class:"overlay-item"},h={class:"overlay-item"},y={key:0,class:"count"},k={key:2,class:"card-media no-image"},g={class:"no-image-text"},C={class:"image-overlay"},_={class:"overlay-item"},b={class:"overlay-item"},F={class:"card-body"},w={class:"content"},X={key:0,class:"tags"},E={class:"card-meta"},L={class:"author"},$={class:"name"},A={class:"time"};var R={__name:"PostCard",props:{post:{type:Object,required:!0},layout:{type:String,default:"masonry"}},emits:["select"],setup(e){r().extend(i());const t=e=>e?e.length>29?`${e.slice(0,29)}...`:e:"",s=e=>e?e.length>60?`${e.slice(0,60)}...`:e:"分享此刻的灵感",o=e=>{if(!e)return"";const t=r()(e),s=r()(),a=s.diff(t,"minute");if(a<60)return`${a||1}分钟前`;const l=s.diff(t,"hour");return l<24?`${l}小时前`:t.isSame(s,"year")?t.format("M月D日"):t.format("YYYY年M月D日")};return(r,u)=>{const i=(0,a.g2)("el-icon"),R=(0,a.g2)("el-tag"),M=(0,a.g2)("el-avatar");return(0,a.uX)(),(0,a.CE)("div",{class:(0,l.C4)(["post-card",e.layout,{"is-recommended":e.post.isRecommended}]),onClick:u[0]||(u[0]=t=>r.$emit("select",e.post))},[e.post.isRecommended?((0,a.uX)(),(0,a.CE)("div",d,[(0,a.bF)(i,null,{default:(0,a.k6)(()=>[(0,a.bF)((0,n.R1)(c.MagicStick))]),_:1}),u[1]||(u[1]=(0,a.Lk)("span",null,"猜你喜欢",-1))])):(0,a.Q3)("",!0),e.post.imageUrls?.length?((0,a.uX)(),(0,a.CE)("div",v,[(0,a.Lk)("img",{src:e.post.imageUrls[0],alt:e.post.content||`${e.post.author?.username||"用户"}的分享图片`},null,8,f),(0,a.Lk)("div",m,[(0,a.Lk)("span",p,[(0,a.bF)(i,null,{default:(0,a.k6)(()=>[(0,a.bF)((0,n.R1)(c.View))]),_:1}),(0,a.eW)((0,l.v_)(e.post.viewCount||0),1)]),(0,a.Lk)("span",h,[(0,a.bF)(i,null,{default:(0,a.k6)(()=>[(0,a.bF)((0,n.R1)(c.GobletFull))]),_:1}),(0,a.eW)((0,l.v_)(e.post.likeCount||0),1)])]),e.post.imageUrls.length>1?((0,a.uX)(),(0,a.CE)("span",y,"+"+(0,l.v_)(e.post.imageUrls.length-1),1)):(0,a.Q3)("",!0)])):((0,a.uX)(),(0,a.CE)("div",k,[(0,a.Lk)("p",g,(0,l.v_)(s(e.post.content)),1),(0,a.Lk)("div",C,[(0,a.Lk)("span",_,[(0,a.bF)(i,null,{default:(0,a.k6)(()=>[(0,a.bF)((0,n.R1)(c.View))]),_:1}),(0,a.eW)((0,l.v_)(e.post.viewCount||0),1)]),(0,a.Lk)("span",b,[(0,a.bF)(i,null,{default:(0,a.k6)(()=>[(0,a.bF)((0,n.R1)(c.GobletFull))]),_:1}),(0,a.eW)((0,l.v_)(e.post.likeCount||0),1)])])])),(0,a.Lk)("div",F,[(0,a.Lk)("p",w,(0,l.v_)(t(e.post.content)),1),e.post.tags?.length?((0,a.uX)(),(0,a.CE)("div",X,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.post.tags.slice(0,2),e=>((0,a.uX)(),(0,a.Wv)(R,{key:e,size:"small",effect:"light"},{default:(0,a.k6)(()=>[(0,a.eW)(" # "+(0,l.v_)(e),1)]),_:2},1024))),128))])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",E,[(0,a.Lk)("div",L,[(0,a.bF)(M,{src:e.post.author?.avatarUrl,size:28,alt:`${e.post.author?.username||"用户"}的头像`},null,8,["src","alt"]),(0,a.Lk)("p",$,(0,l.v_)(e.post.author?.username),1)]),(0,a.Lk)("span",A,(0,l.v_)(o(e.post.createdAt)),1)])],2)}}},M=s(6262);const K=(0,M.A)(R,[["__scopeId","data-v-2be613fd"]]);var W=K},8660:function(e){!function(t,s){e.exports=s()}(0,function(){"use strict";return function(e,t,s){e=e||{};var a=t.prototype,l={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function n(e,t,s,l){return a.fromToBase(e,t,s,l)}s.en.relativeTime=l,a.fromToBase=function(t,a,n,o,r){for(var u,i,c,d=n.$locale().relativeTime||l,v=e.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],f=v.length,m=0;m<f;m+=1){var p=v[m];p.d&&(u=o?s(t).diff(n,p.d,!0):n.diff(t,p.d,!0));var h=(e.rounding||Math.round)(Math.abs(u));if(c=u>0,h<=p.r||!p.r){h<=1&&m>0&&(p=v[m-1]);var y=d[p.l];r&&(h=r(""+h)),i="string"==typeof y?y.replace("%d",h):y(h,a,p.l,c);break}}if(a)return i;var k=c?d.future:d.past;return"function"==typeof k?k(i):k.replace("%s",i)},a.to=function(e,t){return n(e,t,this,!0)},a.from=function(e,t){return n(e,t,this)};var o=function(e){return e.$u?s.utc():s()};a.toNow=function(e){return this.to(o(this),e)},a.fromNow=function(e){return this.from(o(this),e)}}})},9563:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return X}});s(4114);var a=s(641),l=s(33),n=s(953),o=s(5220),r=s(4402),u=s(2549),i=s(6617);const c={class:"feed-container"},d={class:"followees-section"},v={key:0,class:"followees-loading"},f={key:1,class:"followees-list"},m=["title","onClick"],p={class:"followee-name"},h={class:"feed-posts"},y={key:0,class:"loading"},k={key:1,class:"empty"},g={key:2,class:"masonry-grid"},C={key:3,class:"load-more"},_={key:4,class:"no-more"};var b={__name:"Feed",setup(e){const t=(0,o.rd)(),s=(0,n.KR)([]),b=(0,n.KR)(!0),F=(0,n.KR)(1),w=(0,n.KR)(12),X=(0,n.KR)(!0),E=(0,n.KR)([]),L=(0,n.KR)(!0),$=async()=>{try{const e=await(0,u.hc)();E.value=e.data||[]}catch(e){console.error("Failed to load followees:",e)}finally{L.value=!1}},A=async()=>{b.value=!0;try{const e=await r.x.listFeed(F.value,w.value),t=e.data,a=t.items||[];1===F.value?s.value=a:s.value.push(...a),X.value=a.length>=w.value}catch(e){console.error("Failed to load feed:",e)}finally{b.value=!1}},R=()=>{F.value++,A()},M=e=>{t.push(`/posts/${e}`)},K=e=>{t.push(`/users/${e}`)};return(0,a.sV)(()=>{$(),A()}),(e,t)=>{const n=(0,a.g2)("el-avatar"),o=(0,a.g2)("el-empty"),r=(0,a.g2)("el-button");return(0,a.uX)(),(0,a.CE)("div",c,[(0,a.Lk)("div",d,[L.value?((0,a.uX)(),(0,a.CE)("div",v,"加载关注列表...")):((0,a.uX)(),(0,a.CE)("div",f,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(E.value,e=>((0,a.uX)(),(0,a.CE)("div",{key:e.id,class:"followee-avatar",title:e.username,onClick:t=>K(e.id)},[(0,a.bF)(n,{src:e.avatarUrl,size:48,alt:`${e.username}的头像`},null,8,["src","alt"]),(0,a.Lk)("span",p,(0,l.v_)(e.username),1)],8,m))),128))]))]),(0,a.Lk)("div",h,[b.value&&0===s.value.length?((0,a.uX)(),(0,a.CE)("div",y,"加载中...")):0===s.value.length?((0,a.uX)(),(0,a.CE)("div",k,[(0,a.bF)(o,{description:"还没有关注的动态"})])):((0,a.uX)(),(0,a.CE)("div",g,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(s.value,e=>((0,a.uX)(),(0,a.Wv)(i.A,{key:e.id,post:e,onSelect:t=>M(e.id)},null,8,["post","onSelect"]))),128))])),!b.value&&X.value?((0,a.uX)(),(0,a.CE)("div",C,[(0,a.bF)(r,{onClick:R},{default:(0,a.k6)(()=>[...t[0]||(t[0]=[(0,a.eW)("加载更多",-1)])]),_:1})])):(0,a.Q3)("",!0),!X.value&&s.value.length>0?((0,a.uX)(),(0,a.CE)("div",_," 已加载全部内容 ")):(0,a.Q3)("",!0)])])}}},F=s(6262);const w=(0,F.A)(b,[["__scopeId","data-v-3826e89c"]]);var X=w}}]);
//# sourceMappingURL=563.de293c66.js.map