(self["webpackChunkdemo2"]=self["webpackChunkdemo2"]||[]).push([[563],{2549:function(e,t,s){"use strict";s.d(t,{Qt:function(){return u},ec:function(){return o},fG:function(){return v},hP:function(){return d},hc:function(){return i},l2:function(){return l},pV:function(){return n},qw:function(){return c},r7:function(){return r}});var a=s(7277);const l=e=>(0,a.A)({url:`/users/${e}`,method:"get"}),r=e=>(0,a.A)({url:"/users/profile",method:"put",data:e}),o=e=>(0,a.A)({url:"/users/password",method:"put",data:e}),n=e=>(0,a.A)({url:`/users/${e}/follow`,method:"post"}),u=e=>(0,a.A)({url:`/users/${e}/follow`,method:"delete"}),i=()=>(0,a.A)({url:"/users/followees",method:"get"}),c=e=>(0,a.A)({url:"/collections",method:"get",params:e}),d=e=>(0,a.A)({url:"/footprints",method:"get",params:e}),v=e=>(0,a.A)({url:"/footprints",method:"post",data:e})},3530:function(e,t,s){"use strict";s.d(t,{A:function(){return M}});var a=s(641),l=s(33),r=s(953),o=s(4353),n=s.n(o),u=s(8660),i=s.n(u),c=s(8548);const d={key:0,class:"card-media"},v=["src","alt"],f={class:"image-overlay"},p={class:"overlay-item"},m={class:"overlay-item"},h={key:0,class:"count"},y={key:1,class:"card-media no-image"},k={class:"no-image-text"},g={class:"image-overlay"},C={class:"overlay-item"},_={class:"overlay-item"},w={class:"card-body"},b={class:"content"},F={key:0,class:"tags"},X={class:"card-meta"},E={class:"author"},L={class:"name"},$={class:"time"};var A={__name:"PostCard",props:{post:{type:Object,required:!0},layout:{type:String,default:"masonry"}},emits:["select"],setup(e){n().extend(i());const t=e=>e?e.length>29?`${e.slice(0,29)}...`:e:"",s=e=>e?e.length>60?`${e.slice(0,60)}...`:e:"分享此刻的灵感",o=e=>{if(!e)return"";const t=n()(e),s=n()(),a=s.diff(t,"minute");if(a<60)return`${a||1}分钟前`;const l=s.diff(t,"hour");return l<24?`${l}小时前`:t.isSame(s,"year")?t.format("M月D日"):t.format("YYYY年M月D日")};return(n,u)=>{const i=(0,a.g2)("el-icon"),A=(0,a.g2)("el-tag"),R=(0,a.g2)("el-avatar");return(0,a.uX)(),(0,a.CE)("div",{class:(0,l.C4)(["post-card",e.layout]),onClick:u[0]||(u[0]=t=>n.$emit("select",e.post))},[e.post.imageUrls?.length?((0,a.uX)(),(0,a.CE)("div",d,[(0,a.Lk)("img",{src:e.post.imageUrls[0],alt:e.post.content||`${e.post.author?.username||"用户"}的分享图片`},null,8,v),(0,a.Lk)("div",f,[(0,a.Lk)("span",p,[(0,a.bF)(i,null,{default:(0,a.k6)(()=>[(0,a.bF)((0,r.R1)(c.View))]),_:1}),(0,a.eW)((0,l.v_)(e.post.viewCount||0),1)]),(0,a.Lk)("span",m,[(0,a.bF)(i,null,{default:(0,a.k6)(()=>[(0,a.bF)((0,r.R1)(c.GobletFull))]),_:1}),(0,a.eW)((0,l.v_)(e.post.likeCount||0),1)])]),e.post.imageUrls.length>1?((0,a.uX)(),(0,a.CE)("span",h,"+"+(0,l.v_)(e.post.imageUrls.length-1),1)):(0,a.Q3)("",!0)])):((0,a.uX)(),(0,a.CE)("div",y,[(0,a.Lk)("p",k,(0,l.v_)(s(e.post.content)),1),(0,a.Lk)("div",g,[(0,a.Lk)("span",C,[(0,a.bF)(i,null,{default:(0,a.k6)(()=>[(0,a.bF)((0,r.R1)(c.View))]),_:1}),(0,a.eW)((0,l.v_)(e.post.viewCount||0),1)]),(0,a.Lk)("span",_,[(0,a.bF)(i,null,{default:(0,a.k6)(()=>[(0,a.bF)((0,r.R1)(c.GobletFull))]),_:1}),(0,a.eW)((0,l.v_)(e.post.likeCount||0),1)])])])),(0,a.Lk)("div",w,[(0,a.Lk)("p",b,(0,l.v_)(t(e.post.content)),1),e.post.tags?.length?((0,a.uX)(),(0,a.CE)("div",F,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.post.tags.slice(0,2),e=>((0,a.uX)(),(0,a.Wv)(A,{key:e,size:"small",effect:"light"},{default:(0,a.k6)(()=>[(0,a.eW)(" # "+(0,l.v_)(e),1)]),_:2},1024))),128))])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",X,[(0,a.Lk)("div",E,[(0,a.bF)(R,{src:e.post.author?.avatarUrl,size:28,alt:`${e.post.author?.username||"用户"}的头像`},null,8,["src","alt"]),(0,a.Lk)("p",L,(0,l.v_)(e.post.author?.username),1)]),(0,a.Lk)("span",$,(0,l.v_)(o(e.post.createdAt)),1)])],2)}}},R=s(6262);const K=(0,R.A)(A,[["__scopeId","data-v-099876c4"]]);var M=K},8660:function(e){!function(t,s){e.exports=s()}(0,function(){"use strict";return function(e,t,s){e=e||{};var a=t.prototype,l={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function r(e,t,s,l){return a.fromToBase(e,t,s,l)}s.en.relativeTime=l,a.fromToBase=function(t,a,r,o,n){for(var u,i,c,d=r.$locale().relativeTime||l,v=e.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],f=v.length,p=0;p<f;p+=1){var m=v[p];m.d&&(u=o?s(t).diff(r,m.d,!0):r.diff(t,m.d,!0));var h=(e.rounding||Math.round)(Math.abs(u));if(c=u>0,h<=m.r||!m.r){h<=1&&p>0&&(m=v[p-1]);var y=d[m.l];n&&(h=n(""+h)),i="string"==typeof y?y.replace("%d",h):y(h,a,m.l,c);break}}if(a)return i;var k=c?d.future:d.past;return"function"==typeof k?k(i):k.replace("%s",i)},a.to=function(e,t){return r(e,t,this,!0)},a.from=function(e,t){return r(e,t,this)};var o=function(e){return e.$u?s.utc():s()};a.toNow=function(e){return this.to(o(this),e)},a.fromNow=function(e){return this.from(o(this),e)}}})},9563:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return X}});s(4114);var a=s(641),l=s(33),r=s(953),o=s(5220),n=s(4402),u=s(2549),i=s(3530);const c={class:"feed-container"},d={class:"followees-section"},v={key:0,class:"followees-loading"},f={key:1,class:"followees-list"},p=["title","onClick"],m={class:"followee-name"},h={class:"feed-posts"},y={key:0,class:"loading"},k={key:1,class:"empty"},g={key:2,class:"masonry-grid"},C={key:3,class:"load-more"},_={key:4,class:"no-more"};var w={__name:"Feed",setup(e){const t=(0,o.rd)(),s=(0,r.KR)([]),w=(0,r.KR)(!0),b=(0,r.KR)(1),F=(0,r.KR)(12),X=(0,r.KR)(!0),E=(0,r.KR)([]),L=(0,r.KR)(!0),$=async()=>{try{const e=await(0,u.hc)();E.value=e.data||[]}catch(e){console.error("Failed to load followees:",e)}finally{L.value=!1}},A=async()=>{w.value=!0;try{const e=await n.x.listFeed(b.value,F.value),t=e.data,a=t.items||[];1===b.value?s.value=a:s.value.push(...a),X.value=a.length>=F.value}catch(e){console.error("Failed to load feed:",e)}finally{w.value=!1}},R=()=>{b.value++,A()},K=e=>{t.push(`/posts/${e}`)},M=e=>{t.push(`/users/${e}`)};return(0,a.sV)(()=>{$(),A()}),(e,t)=>{const r=(0,a.g2)("el-avatar"),o=(0,a.g2)("el-empty"),n=(0,a.g2)("el-button");return(0,a.uX)(),(0,a.CE)("div",c,[(0,a.Lk)("div",d,[L.value?((0,a.uX)(),(0,a.CE)("div",v,"加载关注列表...")):((0,a.uX)(),(0,a.CE)("div",f,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(E.value,e=>((0,a.uX)(),(0,a.CE)("div",{key:e.id,class:"followee-avatar",title:e.username,onClick:t=>M(e.id)},[(0,a.bF)(r,{src:e.avatarUrl,size:48,alt:`${e.username}的头像`},null,8,["src","alt"]),(0,a.Lk)("span",m,(0,l.v_)(e.username),1)],8,p))),128))]))]),(0,a.Lk)("div",h,[w.value&&0===s.value.length?((0,a.uX)(),(0,a.CE)("div",y,"加载中...")):0===s.value.length?((0,a.uX)(),(0,a.CE)("div",k,[(0,a.bF)(o,{description:"还没有关注的动态"})])):((0,a.uX)(),(0,a.CE)("div",g,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(s.value,e=>((0,a.uX)(),(0,a.Wv)(i.A,{key:e.id,post:e,onSelect:t=>K(e.id)},null,8,["post","onSelect"]))),128))])),!w.value&&X.value?((0,a.uX)(),(0,a.CE)("div",C,[(0,a.bF)(n,{onClick:R},{default:(0,a.k6)(()=>[...t[0]||(t[0]=[(0,a.eW)("加载更多",-1)])]),_:1})])):(0,a.Q3)("",!0),!X.value&&s.value.length>0?((0,a.uX)(),(0,a.CE)("div",_," 已加载全部内容 ")):(0,a.Q3)("",!0)])])}}},b=s(6262);const F=(0,b.A)(w,[["__scopeId","data-v-3826e89c"]]);var X=F}}]);
//# sourceMappingURL=563.ebd04bd4.js.map