"use strict";(self["webpackChunkdemo2"]=self["webpackChunkdemo2"]||[]).push([[591],{8591:function(e,a,l){l.r(a),l.d(a,{default:function(){return Y}});var s=l(641),u=l(3751),t=l(33),n=l(953),r=l(4353),i=l.n(r),c=l(5220),d=l(7277);const o=e=>(0,d.A)({url:"/search",method:"get",params:e}),v={class:"search-page"},k={class:"search-hero"},p={class:"search-tabs"},y=["onClick"],m={class:"result-panel"},_={key:0,class:"loading"},b={key:1},L={class:"result-header"},h={class:"eyebrow"},C={class:"result-count"},g={key:0,class:"empty"},w={key:1,class:"result-list"},f={class:"card-meta"},F={class:"card-content"},E={class:"card-actions"},X={class:"card-meta"},A={class:"card-content"},K={class:"card-actions"},q=["onClick"];var W={__name:"Search",setup(e){const a=(0,c.lq)(),l=(0,c.rd)(),r=(0,n.KR)(a.query.q||""),d=(0,n.KR)("post"),W=(0,n.KR)(!1),I=(0,n.Kh)({posts:[],wikis:[],users:[]}),R=[{label:"动态",value:"post",description:"相关动态"},{label:"维基",value:"wiki",description:"百科词条"},{label:"用户",value:"user",description:"创作者与饮者"}],Y=(0,s.EW)(()=>R.find(e=>e.value===d.value)||R[0]),$={post:"posts",wiki:"wikis",user:"users"},x=(0,s.EW)(()=>I[$[d.value]]||[]),S=async()=>{if(!r.value)return;W.value=!0,l.replace({path:"/search",query:{q:r.value}});const e=$[d.value];I[e]=[];try{const a=await o({keyword:r.value,type:d.value}),l=a.data||{};Array.isArray(l.items)?I[e]=l.items:Array.isArray(l[e])?I[e]=l[e]:I[e]=[]}finally{W.value=!1}},U=e=>{d.value!==e&&(d.value=e,r.value&&S())},V=e=>{e&&window.open(`/posts/${e}`,"_blank")},D=e=>{e&&window.open(`/wiki/${e}`,"_blank")},H=e=>{e&&window.open(`/users/${e}`,"_blank")},M=e=>e?i()(e).format("YYYY.MM.DD HH:mm"):"";return(0,s.wB)(()=>a.query.q,e=>{r.value=e||"",r.value&&S()},{immediate:!0}),(e,a)=>{const l=(0,s.g2)("Search",!0),n=(0,s.g2)("el-icon"),i=(0,s.g2)("el-button"),c=(0,s.g2)("el-input"),o=(0,s.g2)("el-skeleton"),I=(0,s.g2)("el-empty"),$=(0,s.g2)("el-tag"),j=(0,s.g2)("User"),z=(0,s.g2)("el-avatar");return(0,s.uX)(),(0,s.CE)("div",v,[(0,s.Lk)("section",k,[a[1]||(a[1]=(0,s.Lk)("div",null,[(0,s.Lk)("p",{class:"eyebrow"},"Search"),(0,s.Lk)("h1",null,"探索醇饮社区")],-1)),(0,s.bF)(c,{modelValue:r.value,"onUpdate:modelValue":a[0]||(a[0]=e=>r.value=e),placeholder:"输入关键词，例如 IPA、陈年葡萄酒、用户名",onKeyup:(0,u.jR)(S,["enter"])},{append:(0,s.k6)(()=>[(0,s.bF)(i,{type:"primary",loading:W.value,onClick:S},{default:(0,s.k6)(()=>[(0,s.bF)(n,null,{default:(0,s.k6)(()=>[(0,s.bF)(l)]),_:1})]),_:1},8,["loading"])]),_:1},8,["modelValue"]),(0,s.Lk)("div",p,[((0,s.uX)(),(0,s.CE)(s.FK,null,(0,s.pI)(R,e=>(0,s.Lk)("button",{key:e.value,class:(0,t.C4)(["tab-chip",{active:d.value===e.value}]),onClick:a=>U(e.value)},(0,t.v_)(e.label),11,y)),64))])]),(0,s.Lk)("section",m,[W.value?((0,s.uX)(),(0,s.CE)("div",_,[(0,s.bF)(o,{rows:5,animated:""})])):((0,s.uX)(),(0,s.CE)("div",b,[(0,s.Lk)("header",L,[(0,s.Lk)("div",null,[(0,s.Lk)("p",h,(0,t.v_)(Y.value.label),1),(0,s.Lk)("h3",null,(0,t.v_)(Y.value.description),1)]),(0,s.Lk)("span",C,(0,t.v_)(x.value.length)+" 条结果",1)]),0===x.value.length?((0,s.uX)(),(0,s.CE)("div",g,[(0,s.bF)(I,{description:"暂无相关内容"})])):((0,s.uX)(),(0,s.CE)("div",w,["post"===d.value?((0,s.uX)(!0),(0,s.CE)(s.FK,{key:0},(0,s.pI)(x.value,e=>((0,s.uX)(),(0,s.CE)("div",{class:"result-card post",key:e.id},[(0,s.Lk)("div",f,[(0,s.Lk)("strong",null,(0,t.v_)(e.author?.username||"匿名用户"),1),(0,s.Lk)("span",null,(0,t.v_)(M(e.createdAt)),1)]),(0,s.Lk)("p",F,(0,t.v_)(e.content),1),(0,s.Lk)("div",E,[e.ipRegion?((0,s.uX)(),(0,s.Wv)($,{key:0,size:"small"},{default:(0,s.k6)(()=>[(0,s.eW)((0,t.v_)(e.ipRegion),1)]),_:2},1024)):(0,s.Q3)("",!0),(0,s.bF)(i,{text:"",type:"primary",onClick:a=>V(e.id)},{default:(0,s.k6)(()=>[...a[2]||(a[2]=[(0,s.eW)("查看动态",-1)])]),_:1},8,["onClick"])])]))),128)):"wiki"===d.value?((0,s.uX)(!0),(0,s.CE)(s.FK,{key:1},(0,s.pI)(x.value,e=>((0,s.uX)(),(0,s.CE)("div",{class:"result-card wiki",key:e.id},[(0,s.Lk)("div",X,[(0,s.Lk)("h4",null,(0,t.v_)(e.title),1),(0,s.Lk)("span",null,(0,t.v_)(M(e.updatedAt)),1)]),(0,s.Lk)("p",A,(0,t.v_)(e.summary||"这条词条暂未添加摘要"),1),(0,s.Lk)("div",K,[(0,s.Lk)("span",null,(0,t.v_)(e.lastEditorName||"系统"),1),(0,s.bF)(i,{text:"",type:"primary",onClick:a=>D(e.slug||e.id)},{default:(0,s.k6)(()=>[...a[3]||(a[3]=[(0,s.eW)("查看词条",-1)])]),_:1},8,["onClick"])])]))),128)):((0,s.uX)(!0),(0,s.CE)(s.FK,{key:2},(0,s.pI)(x.value,e=>((0,s.uX)(),(0,s.CE)("div",{class:"result-card user",key:e.id,onClick:a=>H(e.id)},[(0,s.bF)(z,{src:e.avatarUrl,alt:`${e.username}的头像`},{default:(0,s.k6)(()=>[(0,s.bF)(n,null,{default:(0,s.k6)(()=>[(0,s.bF)(j)]),_:1})]),_:1},8,["src","alt"]),(0,s.Lk)("div",null,[(0,s.Lk)("strong",null,(0,t.v_)(e.username),1),(0,s.Lk)("p",null,(0,t.v_)(e.bio||"这个人还没有简介"),1)]),(0,s.bF)(i,{text:"",type:"primary"},{default:(0,s.k6)(()=>[...a[4]||(a[4]=[(0,s.eW)("查看",-1)])]),_:1})],8,q))),128))]))]))])])}}},I=l(6262);const R=(0,I.A)(W,[["__scopeId","data-v-0f1adc15"]]);var Y=R}}]);
//# sourceMappingURL=591.d7407cf5.js.map