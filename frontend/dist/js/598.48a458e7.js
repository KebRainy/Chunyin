"use strict";(self["webpackChunkChunyin"]=self["webpackChunkChunyin"]||[]).push([[598],{707:function(e,l,n){n.d(l,{_z:function(){return u},iA:function(){return r}});var t=n(7277);const a=()=>(0,t.A)({url:"/messages",method:"get"}),o=e=>(0,t.A)({url:`/messages/with/${e}`,method:"get"}),u=(e,l)=>(0,t.A)({url:`/messages/with/${e}`,method:"post",data:l}),r={fetchConversations:a,fetchConversationWith:o,sendMessage:u}},2549:function(e,l,n){n.d(l,{Eo:function(){return f},Qt:function(){return s},ec:function(){return u},fG:function(){return v},hP:function(){return c},hc:function(){return i},l2:function(){return a},pV:function(){return r},qw:function(){return d},r7:function(){return o}});var t=n(7277);const a=e=>(0,t.A)({url:`/users/${e}`,method:"get"}),o=e=>(0,t.A)({url:"/users/profile",method:"put",data:e}),u=e=>(0,t.A)({url:"/users/password",method:"put",data:e}),r=e=>(0,t.A)({url:`/users/${e}/follow`,method:"post"}),s=e=>(0,t.A)({url:`/users/${e}/follow`,method:"delete"}),i=()=>(0,t.A)({url:"/users/followees",method:"get"}),d=e=>(0,t.A)({url:"/collections",method:"get",params:e}),c=e=>(0,t.A)({url:"/footprints",method:"get",params:e}),v=e=>(0,t.A)({url:"/footprints",method:"post",data:e}),f=e=>(0,t.A)({url:`/users/${e}/block-recommend`,method:"post"})},2598:function(e,l,n){n.r(l),n.d(l,{default:function(){return C}});n(4114);var t=n(641),a=n(953),o=n(33),u=n(5220),r=n(2549),s=n(707),i=n(6400),d=n(163),c=n(8548);const v={key:0,class:"user-home"},f={class:"profile-hero"},p={class:"hero-left"},k={class:"uid"},g={key:0,class:"ip-region"},m={class:"bio"},h={class:"stats"},w={key:0,class:"hero-right"};var _={__name:"UserHome",setup(e){const l=(0,u.rd)(),n=(0,u.lq)(),_=(0,i.k)(),y=(0,a.KR)(null),b=(0,a.KR)(!1),C=(0,a.KR)(!1),L=(0,a.Kh)({content:""}),A=(0,a.KR)(!1),F=async e=>{const l=await(0,r.l2)(e);y.value=l.data},V=()=>!!_.isLoggedIn||(d.nk.warning("请先登录"),l.push("/login"),!1),R=async()=>{if(V()){b.value=!0;try{y.value.following?(await(0,r.Qt)(y.value.id),y.value.following=!1,y.value.followerCount-=1):(await(0,r.pV)(y.value.id),y.value.following=!0,y.value.followerCount+=1)}catch(e){console.error("关注操作失败:",e),d.nk.error(e.response?.data?.message||"操作失败，请稍后再试")}finally{b.value=!1}}},W=()=>{V()&&(C.value=!0)},$=async()=>{if(L.content.trim()){A.value=!0;try{await(0,s._z)(y.value.id,{content:L.content}),d.nk.success("私信已发送"),L.content="",C.value=!1}catch(e){console.error("发送私信失败:",e),d.nk.error(e.response?.data?.message||"发送失败，请稍后再试")}finally{A.value=!1}}else d.nk.warning("请输入私信内容")};return(0,t.wB)(()=>n.params.id,e=>{e&&F(e)},{immediate:!0}),(0,t.sV)(()=>{F(n.params.id)}),(e,l)=>{const n=(0,t.g2)("el-icon"),u=(0,t.g2)("el-avatar"),r=(0,t.g2)("el-button"),s=(0,t.g2)("el-empty"),i=(0,t.g2)("el-card"),d=(0,t.g2)("el-input"),_=(0,t.g2)("el-dialog");return y.value?((0,t.uX)(),(0,t.CE)("div",v,[(0,t.Lk)("div",f,[(0,t.Lk)("div",p,[(0,t.bF)(u,{size:96,src:y.value.avatarUrl,alt:`${y.value.username||"用户"}的头像`},{default:(0,t.k6)(()=>[(0,t.bF)(n,null,{default:(0,t.k6)(()=>[(0,t.bF)((0,a.R1)(c.User))]),_:1})]),_:1},8,["src","alt"]),(0,t.Lk)("div",null,[(0,t.Lk)("h2",null,(0,o.v_)(y.value.username),1),(0,t.Lk)("p",k,[(0,t.eW)(" UID "+(0,o.v_)(y.value.id)+" · "+(0,o.v_)(y.value.role)+" ",1),y.value.ipRegion?((0,t.uX)(),(0,t.CE)("span",g,"· IP属地 "+(0,o.v_)(y.value.ipRegion),1)):(0,t.Q3)("",!0)]),(0,t.Lk)("p",m,(0,o.v_)(y.value.bio||"这位用户很低调，还没有简介"),1),(0,t.Lk)("div",h,[(0,t.Lk)("div",null,[(0,t.Lk)("strong",null,(0,o.v_)(y.value.followerCount),1),l[3]||(l[3]=(0,t.Lk)("span",null,"粉丝",-1))]),(0,t.Lk)("div",null,[(0,t.Lk)("strong",null,(0,o.v_)(y.value.followingCount),1),l[4]||(l[4]=(0,t.Lk)("span",null,"关注",-1))])])])]),y.value.self?(0,t.Q3)("",!0):((0,t.uX)(),(0,t.CE)("div",w,[(0,t.bF)(r,{type:"primary",plain:y.value.following,loading:b.value,onClick:R},{default:(0,t.k6)(()=>[(0,t.eW)((0,o.v_)(y.value.following?"已关注":"关注"),1)]),_:1},8,["plain","loading"]),(0,t.bF)(r,{onClick:W},{default:(0,t.k6)(()=>[...l[5]||(l[5]=[(0,t.eW)("发私信",-1)])]),_:1})]))]),(0,t.bF)(i,null,{header:(0,t.k6)(()=>[...l[6]||(l[6]=[(0,t.Lk)("div",{class:"card-header"},[(0,t.Lk)("span",null,"最近动态")],-1)])]),default:(0,t.k6)(()=>[(0,t.bF)(s,{description:"Ta 的公开动态暂未开放，敬请期待"})]),_:1}),(0,t.bF)(_,{modelValue:C.value,"onUpdate:modelValue":l[2]||(l[2]=e=>C.value=e),title:"发送私信"},{footer:(0,t.k6)(()=>[(0,t.bF)(r,{onClick:l[1]||(l[1]=e=>C.value=!1)},{default:(0,t.k6)(()=>[...l[7]||(l[7]=[(0,t.eW)("取消",-1)])]),_:1}),(0,t.bF)(r,{type:"primary",loading:A.value,onClick:$},{default:(0,t.k6)(()=>[...l[8]||(l[8]=[(0,t.eW)(" 发送 ",-1)])]),_:1},8,["loading"])]),default:(0,t.k6)(()=>[(0,t.bF)(d,{modelValue:L.content,"onUpdate:modelValue":l[0]||(l[0]=e=>L.content=e),type:"textarea",rows:4,placeholder:"把想说的话写在这里..."},null,8,["modelValue"])]),_:1},8,["modelValue"])])):((0,t.uX)(),(0,t.Wv)(s,{key:1,description:"正在加载..."}))}}},y=n(6262);const b=(0,y.A)(_,[["__scopeId","data-v-8b454ed0"]]);var C=b}}]);
//# sourceMappingURL=598.48a458e7.js.map