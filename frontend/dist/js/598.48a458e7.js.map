{"version":3,"file":"js/598.48a458e7.js","mappings":"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","sources":["webpack://Chunyin/./src/api/message.js","webpack://Chunyin/./src/api/user.js","webpack://Chunyin/./src/views/user/UserHome.vue","webpack://Chunyin/./src/views/user/UserHome.vue?c90d"],"sourcesContent":["import request from './request'\n\nexport const fetchConversations = () => {\n  return request({\n    url: '/messages',\n    method: 'get'\n  })\n}\n\nexport const fetchConversationWith = (userId) => {\n  return request({\n    url: `/messages/with/${userId}`,\n    method: 'get'\n  })\n}\n\nexport const sendMessage = (userId, data) => {\n  return request({\n    url: `/messages/with/${userId}`,\n    method: 'post',\n    data\n  })\n}\n\nexport const messageApi = {\n  fetchConversations,\n  fetchConversationWith,\n  sendMessage\n}\n","import request from './request'\n\nexport const fetchUserProfile = (id) => {\n  return request({\n    url: `/users/${id}`,\n    method: 'get'\n  })\n}\n\nexport const updateProfile = (data) => {\n  return request({\n    url: '/users/profile',\n    method: 'put',\n    data\n  })\n}\n\nexport const changePassword = (data) => {\n  return request({\n    url: '/users/password',\n    method: 'put',\n    data\n  })\n}\n\nexport const followUser = (id) => {\n  return request({\n    url: `/users/${id}/follow`,\n    method: 'post'\n  })\n}\n\nexport const unfollowUser = (id) => {\n  return request({\n    url: `/users/${id}/follow`,\n    method: 'delete'\n  })\n}\n\nexport const getFollowees = () => {\n  return request({\n    url: '/users/followees',\n    method: 'get'\n  })\n}\n\nexport const getCollections = (params) => {\n  return request({\n    url: '/collections',\n    method: 'get',\n    params\n  })\n}\n\nexport const getFootprints = (params) => {\n  return request({\n    url: '/footprints',\n    method: 'get',\n    params\n  })\n}\n\nexport const recordFootprint = (data) => {\n  return request({\n    url: '/footprints',\n    method: 'post',\n    data\n  })\n}\n\nexport const blockRecommendedUser = (id) => {\n  return request({\n    url: `/users/${id}/block-recommend`,\n    method: 'post'\n  })\n}","<template>\n  <div class=\"user-home\" v-if=\"profile\">\n    <div class=\"profile-hero\">\n      <div class=\"hero-left\">\n        <el-avatar :size=\"96\" :src=\"profile.avatarUrl\" :alt=\"`${profile.username || '用户'}的头像`\">\n          <el-icon><User /></el-icon>\n        </el-avatar>\n        <div>\n          <h2>{{ profile.username }}</h2>\n          <p class=\"uid\">\n            UID {{ profile.id }} · {{ profile.role }}\n            <span v-if=\"profile.ipRegion\" class=\"ip-region\">· IP属地 {{ profile.ipRegion }}</span>\n          </p>\n          <p class=\"bio\">{{ profile.bio || '这位用户很低调，还没有简介' }}</p>\n          <div class=\"stats\">\n            <div>\n              <strong>{{ profile.followerCount }}</strong>\n              <span>粉丝</span>\n            </div>\n            <div>\n              <strong>{{ profile.followingCount }}</strong>\n              <span>关注</span>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class=\"hero-right\" v-if=\"!profile.self\">\n        <el-button\n          type=\"primary\"\n          :plain=\"profile.following\"\n          :loading=\"followLoading\"\n          @click=\"toggleFollow\"\n        >\n          {{ profile.following ? '已关注' : '关注' }}\n        </el-button>\n        <el-button @click=\"openMessage\">发私信</el-button>\n      </div>\n    </div>\n\n    <el-card>\n      <template #header>\n        <div class=\"card-header\">\n          <span>最近动态</span>\n        </div>\n      </template>\n      <el-empty description=\"Ta 的公开动态暂未开放，敬请期待\" />\n    </el-card>\n\n    <el-dialog v-model=\"messageVisible\" title=\"发送私信\">\n      <el-input\n        v-model=\"messageForm.content\"\n        type=\"textarea\"\n        :rows=\"4\"\n        placeholder=\"把想说的话写在这里...\"\n      />\n      <template #footer>\n        <el-button @click=\"messageVisible = false\">取消</el-button>\n        <el-button type=\"primary\" :loading=\"messageLoading\" @click=\"sendMessageToUser\">\n          发送\n        </el-button>\n      </template>\n    </el-dialog>\n  </div>\n  <el-empty v-else description=\"正在加载...\" />\n</template>\n\n<script setup>\nimport { onMounted, reactive, ref, watch } from 'vue'\nimport { useRouter, useRoute } from 'vue-router'\nimport { fetchUserProfile, followUser, unfollowUser } from '@/api/user'\nimport { sendMessage } from '@/api/message'\nimport { useUserStore } from '@/store/modules/user'\nimport { ElMessage } from 'element-plus'\nimport { User } from '@element-plus/icons-vue'\n\nconst router = useRouter()\nconst route = useRoute()\nconst userStore = useUserStore()\n\nconst profile = ref(null)\nconst followLoading = ref(false)\n\nconst messageVisible = ref(false)\nconst messageForm = reactive({\n  content: ''\n})\nconst messageLoading = ref(false)\n\nconst loadProfile = async (id) => {\n  const res = await fetchUserProfile(id)\n  profile.value = res.data\n}\n\nconst ensureLogin = () => {\n  if (!userStore.isLoggedIn) {\n    ElMessage.warning('请先登录')\n    router.push('/login')\n    return false\n  }\n  return true\n}\n\nconst toggleFollow = async () => {\n  if (!ensureLogin()) return\n  followLoading.value = true\n  try {\n    if (profile.value.following) {\n      await unfollowUser(profile.value.id)\n      profile.value.following = false\n      profile.value.followerCount -= 1\n    } else {\n      await followUser(profile.value.id)\n      profile.value.following = true\n      profile.value.followerCount += 1\n    }\n  } catch (error) {\n    console.error('关注操作失败:', error)\n    ElMessage.error(error.response?.data?.message || '操作失败，请稍后再试')\n  } finally {\n    followLoading.value = false\n  }\n}\n\nconst openMessage = () => {\n  if (!ensureLogin()) return\n  messageVisible.value = true\n}\n\nconst sendMessageToUser = async () => {\n  if (!messageForm.content.trim()) {\n    ElMessage.warning('请输入私信内容')\n    return\n  }\n  messageLoading.value = true\n  try {\n    await sendMessage(profile.value.id, { content: messageForm.content })\n    ElMessage.success('私信已发送')\n    messageForm.content = ''\n    messageVisible.value = false\n  } catch (error) {\n    console.error('发送私信失败:', error)\n    ElMessage.error(error.response?.data?.message || '发送失败，请稍后再试')\n  } finally {\n    messageLoading.value = false\n  }\n}\n\nwatch(\n  () => route.params.id,\n  (newId) => {\n    if (newId) {\n      loadProfile(newId)\n    }\n  },\n  { immediate: true }\n)\n\nonMounted(() => {\n  loadProfile(route.params.id)\n})\n</script>\n\n<style scoped>\n.user-home {\n  max-width: 900px;\n  margin: 0 auto;\n  padding: 24px;\n  display: flex;\n  flex-direction: column;\n  gap: 20px;\n}\n\n.profile-hero {\n  background: #fff;\n  border-radius: 24px;\n  padding: 24px;\n  display: flex;\n  justify-content: space-between;\n  box-shadow: 0 12px 30px rgba(31, 45, 61, 0.08);\n}\n\n.hero-left {\n  display: flex;\n  gap: 20px;\n}\n\n.uid {\n  color: #909399;\n  margin: 4px 0;\n}\n\n.ip-region {\n  color: #909399;\n}\n\n.bio {\n  color: #606266;\n  margin: 8px 0;\n}\n\n.stats {\n  display: flex;\n  gap: 24px;\n}\n\n.stats div {\n  text-align: center;\n}\n\n.stats strong {\n  font-size: 20px;\n  display: block;\n}\n\n.stats span {\n  font-size: 12px;\n  color: #909399;\n}\n\n.hero-right {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n}\n\n.card-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n</style>","import script from \"./UserHome.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./UserHome.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./UserHome.vue?vue&type=style&index=0&id=8b454ed0&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-8b454ed0\"]])\n\nexport default __exports__"],"names":["fetchConversations","request","url","method","fetchConversationWith","userId","sendMessage","data","messageApi","fetchUserProfile","id","updateProfile","changePassword","followUser","unfollowUser","getFollowees","getCollections","params","getFootprints","recordFootprint","blockRecommendedUser","router","useRouter","route","useRoute","userStore","useUserStore","profile","ref","followLoading","messageVisible","messageForm","reactive","content","messageLoading","loadProfile","async","res","value","ensureLogin","isLoggedIn","ElMessage","warning","push","toggleFollow","following","followerCount","error","console","response","message","openMessage","sendMessageToUser","trim","success","watch","newId","immediate","onMounted","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","_createVNode","_component_el_avatar","size","src","avatarUrl","alt","username","_component_el_icon","_unref","User","_toDisplayString","_hoisted_4","role","ipRegion","_hoisted_5","_hoisted_6","bio","_hoisted_7","followingCount","self","_hoisted_8","_component_el_button","type","plain","loading","onClick","_cache","_component_el_card","header","_withCtx","class","_component_el_empty","description","_component_el_dialog","$event","title","footer","_component_el_input","rows","placeholder","_createBlock","__exports__"],"ignoreList":[],"sourceRoot":""}