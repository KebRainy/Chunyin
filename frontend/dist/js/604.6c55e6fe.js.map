{"version":3,"file":"js/604.6c55e6fe.js","mappings":"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","sources":["webpack://Chunyin/./src/views/Nearby.vue","webpack://Chunyin/./src/views/Nearby.vue?3ac6","webpack://Chunyin/./src/components/PostCard.vue","webpack://Chunyin/./src/components/PostCard.vue?4106","webpack://Chunyin/./node_modules/dayjs/plugin/relativeTime.js"],"sourcesContent":["<template>\r\n  <div class=\"nearby-container\">\r\n    <div class=\"city-selector\">\r\n      <label>选择城市:</label>\r\n      <el-select\r\n        v-model=\"selectedCity\"\r\n        filterable\r\n        clearable\r\n        :loading=\"regionsLoading\"\r\n        placeholder=\"选择城市\"\r\n        @change=\"onCityChange\"\r\n      >\r\n        <el-option-group\r\n          v-for=\"province in provinces\"\r\n          :key=\"province.value\"\r\n          :label=\"province.label\"\r\n        >\r\n          <el-option\r\n            v-for=\"city in province.cities\"\r\n            :key=\"city.value\"\r\n            :label=\"city.label\"\r\n            :value=\"city.value\"\r\n          />\r\n        </el-option-group>\r\n      </el-select>\r\n      <el-button text size=\"small\" class=\"locate-btn\" :loading=\"locating\" @click=\"handleAutoLocate\">\r\n        {{ locating ? '定位中…' : '自动定位' }}\r\n      </el-button>\r\n    </div>\r\n\r\n    <div v-if=\"loading && posts.length === 0\" class=\"loading\">加载中...</div>\r\n    <div v-else-if=\"posts.length === 0\" class=\"empty\">\r\n      <el-empty :description=\"`${selectedCity}还没有动态`\" />\r\n    </div>\r\n    <div v-else class=\"masonry-grid\">\r\n      <PostCard\r\n        v-for=\"post in posts\"\r\n        :key=\"post.id\"\r\n        :post=\"post\"\r\n        @select=\"goToPost(post.id)\"\r\n      />\r\n    </div>\r\n\r\n    <!-- 加载更多 -->\r\n    <div v-if=\"!loading && hasMore\" class=\"load-more\">\r\n      <el-button @click=\"loadMore\">加载更多</el-button>\r\n    </div>\r\n    <div v-if=\"!hasMore && posts.length > 0\" class=\"no-more\">\r\n      已加载全部内容\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted } from 'vue'\r\nimport { useRouter } from 'vue-router'\r\nimport { ElMessage } from 'element-plus'\r\nimport { circleApi } from '@/api/circle'\r\nimport PostCard from '@/components/PostCard.vue'\r\nimport { useChinaRegions } from '@/composables/useChinaRegions'\r\nimport { useCityDetection } from '@/composables/useCityDetection'\r\n\r\nconst router = useRouter()\r\n\r\nconst selectedCity = ref('')\r\nconst posts = ref([])\r\nconst loading = ref(false)\r\nconst currentPage = ref(1)\r\nconst pageSize = ref(12)\r\nconst hasMore = ref(true)\r\n\r\nconst { provinces, loading: regionsLoading, ensureLoaded, findCityByName, getDefaultCity } = useChinaRegions()\r\nconst { detecting: locating, detectCity } = useCityDetection()\r\n\r\nconst loadPosts = async () => {\r\n  if (!selectedCity.value) return\r\n  loading.value = true\r\n  try {\r\n    const response = await circleApi.listPostsByCity(selectedCity.value, currentPage.value, pageSize.value)\r\n    const pageData = response.data\r\n\r\n    if (currentPage.value === 1) {\r\n      posts.value = pageData.items || []\r\n    } else {\r\n      posts.value.push(...(pageData.items || []))\r\n    }\r\n    hasMore.value = (pageData.items || []).length >= pageSize.value\r\n  } catch (error) {\r\n    console.error('Failed to load nearby posts:', error)\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\nconst onCityChange = () => {\r\n  if (!selectedCity.value) return\r\n  currentPage.value = 1\r\n  posts.value = []\r\n  hasMore.value = true\r\n  loadPosts()\r\n}\r\n\r\nconst loadMore = () => {\r\n  currentPage.value++\r\n  loadPosts()\r\n}\r\n\r\nconst goToPost = (postId) => {\r\n  router.push(`/posts/${postId}`)\r\n}\r\n\r\nconst initCitySelection = async () => {\r\n  await ensureLoaded()\r\n  const detected = await detectCity()\r\n  const match = detected ? findCityByName(detected) : null\r\n  selectedCity.value = match?.city || getDefaultCity() || '北京市'\r\n  onCityChange()\r\n}\r\n\r\nconst handleAutoLocate = async () => {\r\n  await ensureLoaded()\r\n  const detected = await detectCity()\r\n  if (!detected) {\r\n    ElMessage.warning('无法定位，请手动选择城市')\r\n    return\r\n  }\r\n  const match = findCityByName(detected)\r\n  if (match?.city) {\r\n    selectedCity.value = match.city\r\n    ElMessage.success(`已定位到 ${match.city}`)\r\n    onCityChange()\r\n  } else {\r\n    ElMessage.warning('未找到匹配的城市，请手动选择')\r\n  }\r\n}\r\n\r\nonMounted(() => {\r\n  initCitySelection()\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n.nearby-container {\r\n  max-width: 1300px;\r\n  margin: 0 auto;\r\n  padding: 20px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 20px;\r\n}\r\n\r\n.city-selector {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 12px;\r\n  font-size: 14px;\r\n  color: #333;\r\n  border: 1px solid #eceff5;\r\n  padding: 14px 20px;\r\n  border-radius: 20px;\r\n  background: #fff;\r\n  box-shadow: 0 8px 22px rgba(15, 23, 42, 0.04);\r\n}\r\n\r\n:deep(.el-select) {\r\n  width: 220px;\r\n}\r\n\r\n.locate-btn {\r\n  padding: 0 8px;\r\n}\r\n\r\n.loading, .empty {\r\n  text-align: center;\r\n  padding: 60px 20px;\r\n  color: #999;\r\n  background: #fff;\r\n  border-radius: 28px;\r\n  border: 1px solid #eceff5;\r\n}\r\n\r\n.masonry-grid {\r\n  column-count: 4;\r\n  column-gap: 20px;\r\n  background: #fff;\r\n  border-radius: 28px;\r\n  border: 1px solid #eceff5;\r\n  padding: 24px;\r\n  box-shadow: 0 12px 32px rgba(15, 23, 42, 0.04);\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.masonry-grid > * {\r\n  break-inside: avoid;\r\n  margin-bottom: 20px;\r\n  display: block;\r\n}\r\n\r\n@media (max-width: 1200px) {\r\n  .masonry-grid {\r\n    column-count: 3;\r\n  }\r\n}\r\n\r\n@media (max-width: 900px) {\r\n  .masonry-grid {\r\n    column-count: 2;\r\n  }\r\n}\r\n\r\n@media (max-width: 600px) {\r\n  .masonry-grid {\r\n    column-count: 1;\r\n  }\r\n}\r\n\r\n.load-more {\r\n  text-align: center;\r\n  padding: 20px;\r\n  margin-top: 20px;\r\n}\r\n\r\n.no-more {\r\n  text-align: center;\r\n  padding: 20px;\r\n  color: #999;\r\n  font-size: 12px;\r\n}\r\n</style>\r\n","import script from \"./Nearby.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./Nearby.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./Nearby.vue?vue&type=style&index=0&id=2164ee5d&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-2164ee5d\"]])\n\nexport default __exports__","<template>\n  <div :class=\"['post-card', layout, { 'is-recommended': post.isRecommended }]\" @click=\"$emit('select', post)\">\n    <!-- 推荐标识 -->\n    <div v-if=\"post.isRecommended\" class=\"recommend-badge\">\n      <el-icon><MagicStick /></el-icon>\n      <span>猜你喜欢</span>\n    </div>\n    <div class=\"card-media\" v-if=\"post.imageUrls?.length\">\n      <img\n        :src=\"post.imageUrls[0]\"\n        :alt=\"post.content || `${post.author?.username || '用户'}的分享图片`\"\n      >\n      <div class=\"image-overlay\">\n        <span class=\"overlay-item\"><el-icon><View /></el-icon>{{ post.viewCount || 0 }}</span>\n        <span class=\"overlay-item\"><el-icon><GobletFull /></el-icon>{{ post.likeCount || 0 }}</span>\n      </div>\n      <span v-if=\"post.imageUrls.length > 1\" class=\"count\">+{{ post.imageUrls.length - 1 }}</span>\n    </div>\n    <div class=\"card-media no-image\" v-else>\n      <p class=\"no-image-text\">{{ coverText(post.content) }}</p>\n      <div class=\"image-overlay\">\n        <span class=\"overlay-item\"><el-icon><View /></el-icon>{{ post.viewCount || 0 }}</span>\n        <span class=\"overlay-item\"><el-icon><GobletFull /></el-icon>{{ post.likeCount || 0 }}</span>\n      </div>\n    </div>\n    <div class=\"card-body\">\n      <!-- <div class=\"location\">\n        <el-icon><Location /></el-icon>\n        <span>{{ post.location || '未知地点' }}</span>\n      </div> -->\n      <p class=\"content\">{{ snippet(post.content) }}</p>\n      <div class=\"tags\" v-if=\"post.tags?.length\">\n        <el-tag\n          v-for=\"tag in post.tags.slice(0, 2)\"\n          :key=\"tag\"\n          size=\"small\"\n          effect=\"light\"\n        >\n          # {{ tag }}\n        </el-tag>\n      </div>\n    </div>\n    <div class=\"card-meta\">\n      <div class=\"author\">\n        <el-avatar\n          :src=\"post.author?.avatarUrl\"\n          :size=\"28\"\n          :alt=\"`${post.author?.username || '用户'}的头像`\"\n        />\n        <p class=\"name\">{{ post.author?.username }}</p>\n      </div>\n      <span class=\"time\">{{ formatTime(post.createdAt) }}</span>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport dayjs from 'dayjs'\nimport relativeTime from 'dayjs/plugin/relativeTime'\nimport { Picture, View, GobletFull, Heart, Location, MagicStick } from '@element-plus/icons-vue'\n\ndayjs.extend(relativeTime)\n\ndefineProps({\n  post: {\n    type: Object,\n    required: true\n  },\n  layout: {\n    type: String,\n    default: 'masonry'\n  }\n})\n\ndefineEmits(['select'])\n\nconst snippet = (text) => {\n  if (!text) return ''\n  return text.length > 29 ? `${text.slice(0, 29)}...` : text\n}\n\nconst coverText = (text) => {\n  if (!text) return '分享此刻的灵感'\n  return text.length > 60 ? `${text.slice(0, 60)}...` : text\n}\n\nconst formatTime = (value) => {\n  if (!value) return ''\n  const date = dayjs(value)\n  const now = dayjs()\n  const diffMinutes = now.diff(date, 'minute')\n  if (diffMinutes < 60) return `${diffMinutes || 1}分钟前`\n  const diffHours = now.diff(date, 'hour')\n  if (diffHours < 24) return `${diffHours}小时前`\n  if (date.isSame(now, 'year')) {\n    return date.format('M月D日')\n  }\n  return date.format('YYYY年M月D日')\n}\n</script>\n\n<style scoped>\n.post-card {\n  background: #fff;\n  border-radius: 18px;\n  overflow: hidden;\n  border: 1px solid #f1f1f1;\n  cursor: pointer;\n  display: flex;\n  flex-direction: column;\n  transition: transform 0.2s, box-shadow 0.2s;\n  break-inside: avoid;\n  position: relative;\n}\n\n.post-card:hover {\n  box-shadow: 0 18px 28px rgba(15, 23, 42, 0.08);\n  transform: translateY(-2px);\n}\n\n/* 推荐卡片样式 */\n.post-card.is-recommended {\n  border: 1px solid #e6d9f7;\n  background: linear-gradient(135deg, #fdfbff 0%, #fff 100%);\n}\n\n.post-card.is-recommended:hover {\n  box-shadow: 0 18px 28px rgba(139, 92, 246, 0.12);\n}\n\n.recommend-badge {\n  position: absolute;\n  top: 12px;\n  left: 12px;\n  z-index: 10;\n  display: flex;\n  align-items: center;\n  gap: 4px;\n  padding: 4px 10px;\n  background: linear-gradient(135deg, #8b5cf6 0%, #a78bfa 100%);\n  color: #fff;\n  font-size: 11px;\n  font-weight: 500;\n  border-radius: 999px;\n  box-shadow: 0 2px 8px rgba(139, 92, 246, 0.3);\n}\n\n.recommend-badge .el-icon {\n  font-size: 12px;\n}\n\n.card-media {\n  position: relative;\n  width: 100%;\n  overflow: hidden;\n  border-bottom: 1px solid #f5f5f5;\n}\n\n.card-media img {\n  width: 100%;\n  display: block;\n  object-fit: cover;\n  max-height: 520px;\n}\n\n.card-media.no-image {\n  min-height: 220px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 32px 24px 64px;\n  background: #f8fafc;\n}\n\n.no-image-text {\n  font-size: 18px;\n  color: #1f2d3d;\n  margin: 0;\n  text-align: center;\n  line-height: 1.8;\n  display: -webkit-box;\n  -webkit-line-clamp: 4;\n  -webkit-box-orient: vertical;\n  overflow: hidden;\n}\n\n.image-overlay {\n  position: absolute;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  display: flex;\n  justify-content: space-between;\n  padding: 10px 14px;\n  background: linear-gradient(180deg, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0.45) 100%);\n  color: #fff;\n  font-size: 12px;\n}\n\n.overlay-item {\n  display: inline-flex;\n  align-items: center;\n  gap: 4px;\n}\n\n.card-media .count {\n  position: absolute;\n  top: 12px;\n  right: 12px;\n  background: rgba(0, 0, 0, 0.55);\n  color: #fff;\n  padding: 2px 8px;\n  border-radius: 999px;\n  font-size: 12px;\n}\n\n.card-body {\n  padding: 14px 16px 8px;\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n\n.location {\n  display: flex;\n  align-items: center;\n  gap: 4px;\n  font-size: 12px;\n  color: #909399;\n}\n\n.content {\n  margin: 0;\n  color: #1f2d3d;\n  line-height: 1.6;\n  font-size: 16px;\n  font-weight: 500;\n}\n\n.tags {\n  display: flex;\n  gap: 6px;\n  flex-wrap: wrap;\n}\n\n.card-meta {\n  padding: 10px 16px 16px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  font-size: 12px;\n  color: #909399;\n}\n\n.author {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.author .name {\n  margin: 0;\n  font-weight: 600;\n  font-size: 13px;\n  color: #1f2d3d;\n}\n\n.card-meta .time {\n  font-size: 12px;\n  color: #a0a3ad;\n}\n</style>","import script from \"./PostCard.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./PostCard.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./PostCard.vue?vue&type=style&index=0&id=2be613fd&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-2be613fd\"]])\n\nexport default __exports__","!function(r,e){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=e():\"function\"==typeof define&&define.amd?define(e):(r=\"undefined\"!=typeof globalThis?globalThis:r||self).dayjs_plugin_relativeTime=e()}(this,(function(){\"use strict\";return function(r,e,t){r=r||{};var n=e.prototype,o={future:\"in %s\",past:\"%s ago\",s:\"a few seconds\",m:\"a minute\",mm:\"%d minutes\",h:\"an hour\",hh:\"%d hours\",d:\"a day\",dd:\"%d days\",M:\"a month\",MM:\"%d months\",y:\"a year\",yy:\"%d years\"};function i(r,e,t,o){return n.fromToBase(r,e,t,o)}t.en.relativeTime=o,n.fromToBase=function(e,n,i,d,u){for(var f,a,s,l=i.$locale().relativeTime||o,h=r.thresholds||[{l:\"s\",r:44,d:\"second\"},{l:\"m\",r:89},{l:\"mm\",r:44,d:\"minute\"},{l:\"h\",r:89},{l:\"hh\",r:21,d:\"hour\"},{l:\"d\",r:35},{l:\"dd\",r:25,d:\"day\"},{l:\"M\",r:45},{l:\"MM\",r:10,d:\"month\"},{l:\"y\",r:17},{l:\"yy\",d:\"year\"}],m=h.length,c=0;c<m;c+=1){var y=h[c];y.d&&(f=d?t(e).diff(i,y.d,!0):i.diff(e,y.d,!0));var p=(r.rounding||Math.round)(Math.abs(f));if(s=f>0,p<=y.r||!y.r){p<=1&&c>0&&(y=h[c-1]);var v=l[y.l];u&&(p=u(\"\"+p)),a=\"string\"==typeof v?v.replace(\"%d\",p):v(p,n,y.l,s);break}}if(n)return a;var M=s?l.future:l.past;return\"function\"==typeof M?M(a):M.replace(\"%s\",a)},n.to=function(r,e){return i(r,e,this,!0)},n.from=function(r,e){return i(r,e,this)};var d=function(r){return r.$u?t.utc():t()};n.toNow=function(r){return this.to(d(this),r)},n.fromNow=function(r){return this.from(d(this),r)}}}));"],"names":["router","useRouter","selectedCity","ref","posts","loading","currentPage","pageSize","hasMore","provinces","regionsLoading","ensureLoaded","findCityByName","getDefaultCity","useChinaRegions","detecting","locating","detectCity","useCityDetection","loadPosts","async","value","response","circleApi","listPostsByCity","pageData","data","items","push","length","error","console","onCityChange","loadMore","goToPost","postId","initCitySelection","detected","match","city","handleAutoLocate","ElMessage","warning","success","onMounted","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_createVNode","_component_el_select","$event","filterable","clearable","_unref","placeholder","onChange","_Fragment","_renderList","province","_createBlock","_component_el_option_group","key","label","cities","_component_el_option","_component_el_button","text","size","class","onClick","_hoisted_3","_hoisted_4","_component_el_empty","description","_hoisted_5","post","PostCard","id","onSelect","_hoisted_6","_cache","_hoisted_7","__exports__","dayjs","relativeTime","snippet","slice","coverText","formatTime","date","now","diffMinutes","diff","diffHours","isSame","format","_normalizeClass","__props","layout","isRecommended","_ctx","$emit","_component_el_icon","MagicStick","imageUrls","src","alt","content","author","username","View","viewCount","GobletFull","likeCount","_toDisplayString","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","tags","_hoisted_15","tag","_component_el_tag","effect","_hoisted_16","_hoisted_17","_component_el_avatar","avatarUrl","_hoisted_18","_hoisted_19","createdAt","r","e","module","exports","this","t","n","prototype","o","future","past","s","m","mm","h","hh","d","dd","M","MM","y","yy","i","fromToBase","en","u","f","a","l","$locale","thresholds","c","p","rounding","Math","round","abs","v","replace","to","from","$u","utc","toNow","fromNow"],"ignoreList":[],"sourceRoot":""}