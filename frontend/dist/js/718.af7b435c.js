"use strict";(self["webpackChunkChunyin"]=self["webpackChunkChunyin"]||[]).push([[718],{707:function(e,l,a){a.d(l,{_z:function(){return u},iA:function(){return r}});var t=a(7277);const n=()=>(0,t.A)({url:"/messages",method:"get"}),o=e=>(0,t.A)({url:`/messages/with/${e}`,method:"get"}),u=(e,l)=>(0,t.A)({url:`/messages/with/${e}`,method:"post",data:l}),r={fetchConversations:n,fetchConversationWith:o,sendMessage:u}},2549:function(e,l,a){a.d(l,{Qt:function(){return s},ec:function(){return u},fG:function(){return v},hP:function(){return c},hc:function(){return i},l2:function(){return n},pV:function(){return r},qw:function(){return d},r7:function(){return o}});var t=a(7277);const n=e=>(0,t.A)({url:`/users/${e}`,method:"get"}),o=e=>(0,t.A)({url:"/users/profile",method:"put",data:e}),u=e=>(0,t.A)({url:"/users/password",method:"put",data:e}),r=e=>(0,t.A)({url:`/users/${e}/follow`,method:"post"}),s=e=>(0,t.A)({url:`/users/${e}/follow`,method:"delete"}),i=()=>(0,t.A)({url:"/users/followees",method:"get"}),d=e=>(0,t.A)({url:"/collections",method:"get",params:e}),c=e=>(0,t.A)({url:"/footprints",method:"get",params:e}),v=e=>(0,t.A)({url:"/footprints",method:"post",data:e})},2718:function(e,l,a){a.r(l),a.d(l,{default:function(){return b}});a(4114);var t=a(641),n=a(953),o=a(33),u=a(5220),r=a(2549),s=a(707),i=a(6400),d=a(163),c=a(8548);const v={key:0,class:"user-home"},f={class:"profile-hero"},p={class:"hero-left"},k={class:"uid"},g={class:"bio"},m={class:"stats"},h={key:0,class:"hero-right"};var w={__name:"UserHome",setup(e){const l=(0,u.rd)(),a=(0,u.lq)(),w=(0,i.k)(),_=(0,n.KR)(null),y=(0,n.KR)(!1),b=(0,n.KR)(!1),C=(0,n.Kh)({content:""}),L=(0,n.KR)(!1),A=async e=>{const l=await(0,r.l2)(e);_.value=l.data},F=()=>!!w.isLoggedIn||(d.nk.warning("请先登录"),l.push("/login"),!1),V=async()=>{if(F()){y.value=!0;try{_.value.following?(await(0,r.Qt)(_.value.id),_.value.following=!1,_.value.followerCount-=1):(await(0,r.pV)(_.value.id),_.value.following=!0,_.value.followerCount+=1)}catch(e){console.error("关注操作失败:",e),d.nk.error(e.response?.data?.message||"操作失败，请稍后再试")}finally{y.value=!1}}},U=()=>{F()&&(b.value=!0)},W=async()=>{if(C.content.trim()){L.value=!0;try{await(0,s._z)(_.value.id,{content:C.content}),d.nk.success("私信已发送"),C.content="",b.value=!1}catch(e){console.error("发送私信失败:",e),d.nk.error(e.response?.data?.message||"发送失败，请稍后再试")}finally{L.value=!1}}else d.nk.warning("请输入私信内容")};return(0,t.wB)(()=>a.params.id,e=>{e&&A(e)},{immediate:!0}),(0,t.sV)(()=>{A(a.params.id)}),(e,l)=>{const a=(0,t.g2)("el-icon"),u=(0,t.g2)("el-avatar"),r=(0,t.g2)("el-button"),s=(0,t.g2)("el-empty"),i=(0,t.g2)("el-card"),d=(0,t.g2)("el-input"),w=(0,t.g2)("el-dialog");return _.value?((0,t.uX)(),(0,t.CE)("div",v,[(0,t.Lk)("div",f,[(0,t.Lk)("div",p,[(0,t.bF)(u,{size:96,src:_.value.avatarUrl,alt:`${_.value.username||"用户"}的头像`},{default:(0,t.k6)(()=>[(0,t.bF)(a,null,{default:(0,t.k6)(()=>[(0,t.bF)((0,n.R1)(c.User))]),_:1})]),_:1},8,["src","alt"]),(0,t.Lk)("div",null,[(0,t.Lk)("h2",null,(0,o.v_)(_.value.username),1),(0,t.Lk)("p",k,"UID "+(0,o.v_)(_.value.id)+" · "+(0,o.v_)(_.value.role),1),(0,t.Lk)("p",g,(0,o.v_)(_.value.bio||"这位用户很低调，还没有简介"),1),(0,t.Lk)("div",m,[(0,t.Lk)("div",null,[(0,t.Lk)("strong",null,(0,o.v_)(_.value.followerCount),1),l[3]||(l[3]=(0,t.Lk)("span",null,"粉丝",-1))]),(0,t.Lk)("div",null,[(0,t.Lk)("strong",null,(0,o.v_)(_.value.followingCount),1),l[4]||(l[4]=(0,t.Lk)("span",null,"关注",-1))])])])]),_.value.self?(0,t.Q3)("",!0):((0,t.uX)(),(0,t.CE)("div",h,[(0,t.bF)(r,{type:"primary",plain:_.value.following,loading:y.value,onClick:V},{default:(0,t.k6)(()=>[(0,t.eW)((0,o.v_)(_.value.following?"已关注":"关注"),1)]),_:1},8,["plain","loading"]),(0,t.bF)(r,{onClick:U},{default:(0,t.k6)(()=>[...l[5]||(l[5]=[(0,t.eW)("发私信",-1)])]),_:1})]))]),(0,t.bF)(i,null,{header:(0,t.k6)(()=>[...l[6]||(l[6]=[(0,t.Lk)("div",{class:"card-header"},[(0,t.Lk)("span",null,"最近动态")],-1)])]),default:(0,t.k6)(()=>[(0,t.bF)(s,{description:"Ta 的公开动态暂未开放，敬请期待"})]),_:1}),(0,t.bF)(w,{modelValue:b.value,"onUpdate:modelValue":l[2]||(l[2]=e=>b.value=e),title:"发送私信"},{footer:(0,t.k6)(()=>[(0,t.bF)(r,{onClick:l[1]||(l[1]=e=>b.value=!1)},{default:(0,t.k6)(()=>[...l[7]||(l[7]=[(0,t.eW)("取消",-1)])]),_:1}),(0,t.bF)(r,{type:"primary",loading:L.value,onClick:W},{default:(0,t.k6)(()=>[...l[8]||(l[8]=[(0,t.eW)(" 发送 ",-1)])]),_:1},8,["loading"])]),default:(0,t.k6)(()=>[(0,t.bF)(d,{modelValue:C.content,"onUpdate:modelValue":l[0]||(l[0]=e=>C.content=e),type:"textarea",rows:4,placeholder:"把想说的话写在这里..."},null,8,["modelValue"])]),_:1},8,["modelValue"])])):((0,t.uX)(),(0,t.Wv)(s,{key:1,description:"正在加载..."}))}}},_=a(6262);const y=(0,_.A)(w,[["__scopeId","data-v-7d5f1da7"]]);var b=y}}]);
//# sourceMappingURL=718.af7b435c.js.map