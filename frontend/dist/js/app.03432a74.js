(function(){"use strict";var e={2636:function(e,t,n){n.d(t,{HW:function(){return l},iD:function(){return o},kz:function(){return r},ri:function(){return i}});var a=n(7277);const o=e=>(0,a.A)({url:"/auth/login",method:"post",data:e}),r=e=>(0,a.A)({url:"/auth/register",method:"post",data:e}),l=()=>(0,a.A)({url:"/auth/me",method:"get"}),i=()=>(0,a.A)({url:"/auth/logout",method:"post"})},3945:function(e,t,n){n.d(t,{m:function(){return i}});n(8111),n(116),n(1701);var a=n(953);const o=(0,a.KR)(null);let r=null;const l=(e="")=>e.trim().replace(/(市|地区|特别行政区|自治州|回族自治区|维吾尔自治区|壮族自治区|自治区|省|盟)$/u,"").toLowerCase(),i=()=>{const e=(0,a.KR)([]),t=(0,a.KR)(!1),n=async()=>{if(o.value)return e.value=o.value,o.value;r||(t.value=!0,r=fetch("/cities.json").then(e=>e.json()).then(t=>{const n=(t?.provinces||[]).map(e=>({label:e.provinceName,value:e.provinceName,cities:(e.citys||[]).map(e=>({label:e.cityName,value:e.cityName}))}));return o.value=n,e.value=n,n}).catch(e=>(console.error("加载城市列表失败",e),[])).finally(()=>{t.value=!1}));const n=await r;return e.value=n,n},i=(e="")=>{if(!e||!o.value)return null;const t=l(e);for(const n of o.value){if(l(n.value)===t)return{province:n.value,city:n.value};const e=n.cities.find(e=>l(e.value)===t);if(e)return{province:n.value,city:e.value}}return null},s=()=>{if(!o.value||0===o.value.length)return"";const e=o.value[0];return e.cities?.[0]?.value||e.value};return{provinces:e,loading:t,ensureLoaded:n,findCityByName:i,getDefaultCity:s}}},4402:function(e,t,n){n.d(t,{x:function(){return o}});var a=n(7277);const o={listPosts:(e=1,t=12)=>(0,a.A)({url:"/circle/posts",method:"get",params:{page:e,pageSize:t}}),listFeed:(e=1,t=12)=>(0,a.A)({url:"/circle/feed",method:"get",params:{page:e,pageSize:t}}),listUserPosts:(e,t=1,n=10)=>(0,a.A)({url:`/circle/users/${e}/posts`,method:"get",params:{page:t,pageSize:n}}),createPost:e=>(0,a.A)({url:"/circle/posts",method:"post",data:e}),listPostsByCity:(e,t=1,n=12)=>(0,a.A)({url:"/circle/nearby",method:"get",params:{city:e,page:t,pageSize:n}}),getPost:e=>(0,a.A)({url:`/circle/posts/${e}`,method:"get"}),likePost:e=>(0,a.A)({url:`/circle/posts/${e}/like`,method:"post"}),favoritePost:e=>(0,a.A)({url:`/circle/posts/${e}/favorite`,method:"post"}),getComments:e=>(0,a.A)({url:`/circle/posts/${e}/comments`,method:"get"}),createComment:(e,t)=>(0,a.A)({url:`/circle/posts/${e}/comments`,method:"post",data:t})}},5394:function(e,t,n){n.d(t,{A:function(){return A}});n(4114),n(8111),n(2489);var a=n(641),o=n(33),r=n(953),l=n(6400),i=n(4402),s=n(163),u=n(8548),c=n(3945),d=n(5467);const p={class:"composer-main"},f={class:"composer-avatar"},m={class:"composer-body"},h={class:"composer-fields"},g={class:"location-field"},v={class:"composer-upload"},b={key:1,class:"inline-upload"},k={key:0,class:"inline-preview"},y=["src","alt"],C={class:"composer-footer"},w={class:"meta"},F={key:0};var L={__name:"ShareComposer",props:{mode:{type:String,default:"inline"}},emits:["submitted"],setup(e,{expose:t,emit:n}){const L=n,_=(0,l.k)(),I=(0,r.KR)(!1),A=(0,r.KR)([]),E=(0,r.KR)([]),R=(0,r.KR)(null),P=(0,r.Kh)({content:"",tags:[],location:"",imageIds:[]}),S=(0,r.KR)(""),{provinces:K,loading:V,ensureLoaded:U,findCityByName:W}=(0,c.m)(),{detecting:j,detectCity:x}=(0,d.K)(),O=e=>{const t=e.type.startsWith("image/"),n=e.size/1024/1024<5;return t?!!n||(s.nk.error("图片大小不能超过 5MB"),!1):(s.nk.error("只能上传图片文件"),!1)},z=(e,t,n)=>{200===e.code&&e.data?.id?(P.imageIds.push(e.data.id),A.value=n):s.nk.error("上传失败，请重试")},X=(e,t)=>{const n=e.response?.data?.id;n&&(P.imageIds=P.imageIds.filter(e=>e!==n)),A.value=t},N=()=>{s.nk.error("图片上传失败")},B=()=>{R.value?.click()},T=async e=>{const t=Array.from(e.target.files||[]);for(const a of t){if(!O(a))continue;const e=new FormData;e.append("file",a);try{const t=await fetch("/api/files/upload?category=POST",{method:"POST",body:e,credentials:"include"}).then(e=>e.json());200===t.code&&t.data?.id?(P.imageIds.push(t.data.id),E.value.push({uid:`${Date.now()}-${Math.random()}`,url:t.data.url})):s.nk.error(t.message||"上传失败")}catch(n){s.nk.error("上传失败")}}R.value&&(R.value.value="")},$=e=>{const t=E.value.findIndex(t=>t.uid===e);t>-1&&(E.value.splice(t,1),P.imageIds.splice(t,1))},q=e=>{S.value=e||"",P.location=e||""},D=async e=>{if(!e)return void q("");await U();const t=W(e);q(t?.city||e)},M=e=>{P.location=e||""},H=async(e=!1)=>{await U();const t=await x();if(!t)return void(e&&s.nk.warning("无法自动定位，请手动选择"));const n=W(t);if(n?.city)return q(n.city),void(e&&s.nk.success(`已定位到 ${n.city}`));e&&s.nk.warning("未找到匹配城市，请手动选择")},Q=async()=>{if(P.content.trim()){I.value=!0;try{await i.x.createPost({content:P.content,location:P.location,imageIds:P.imageIds,tags:P.tags}),s.nk.success("发布成功"),L("submitted"),Y()}catch(e){s.nk.error(e.message||"发布失败")}finally{I.value=!1}}else s.nk.warning("请输入分享内容")},Y=()=>{P.content="",P.tags=[],P.location="",P.imageIds=[],A.value=[],E.value=[],S.value=""},G=(e={})=>{P.content=e.content||"",P.tags=e.tags?[...e.tags]:[],P.location=e.location||"",P.imageIds=e.imageIds?[...e.imageIds]:[],D(P.location)},J=(0,a.EW)(()=>!!(P.content.trim()||P.tags.length||P.location||P.imageIds.length)),Z=()=>({content:P.content,tags:P.tags,location:P.location,imageIds:P.imageIds});return(0,a.sV)(async()=>{await U(),P.location?await D(P.location):await H(!1)}),t({resetForm:Y,fillForm:G,hasUnsaved:J,getSnapshot:Z}),(t,n)=>{const l=(0,a.g2)("el-avatar"),i=(0,a.g2)("el-input"),s=(0,a.g2)("el-select"),c=(0,a.g2)("el-option"),d=(0,a.g2)("el-option-group"),L=(0,a.g2)("el-button"),U=(0,a.g2)("el-icon"),W=(0,a.g2)("el-upload");return(0,a.uX)(),(0,a.CE)("div",{class:(0,o.C4)(["share-composer",e.mode])},[(0,a.Lk)("div",p,[(0,a.Lk)("div",f,[(0,a.bF)(l,{src:(0,r.R1)(_).userInfo?.avatarUrl,size:48,alt:`${(0,r.R1)(_).userInfo?.username||"用户"}的头像`},null,8,["src","alt"])]),(0,a.Lk)("div",m,[(0,a.bF)(i,{modelValue:P.content,"onUpdate:modelValue":n[0]||(n[0]=e=>P.content=e),type:"textarea",rows:"modal"===e.mode?6:3,maxlength:"2000","show-word-limit":"",resize:"none",placeholder:"分享此刻，聊聊你正在喝的、看到的、想到的一切..."},null,8,["modelValue","rows"]),(0,a.Lk)("div",h,[(0,a.bF)(s,{modelValue:P.tags,"onUpdate:modelValue":n[1]||(n[1]=e=>P.tags=e),multiple:"",filterable:"","allow-create":"","default-first-option":"","collapse-tags":"","multiple-limit":5,placeholder:"添加话题标签，如 上海、精酿、金酒"},null,8,["modelValue"]),(0,a.Lk)("div",g,[(0,a.bF)(s,{modelValue:S.value,"onUpdate:modelValue":n[2]||(n[2]=e=>S.value=e),filterable:"",clearable:"",loading:(0,r.R1)(V),placeholder:(0,r.R1)(V)?"地区加载中…":"选择地点（可选）",onChange:M},{default:(0,a.k6)(()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)((0,r.R1)(K),e=>((0,a.uX)(),(0,a.Wv)(d,{key:e.value,label:e.label},{default:(0,a.k6)(()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.cities,e=>((0,a.uX)(),(0,a.Wv)(c,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue","loading","placeholder"]),(0,a.bF)(L,{class:"locate-btn",text:"",size:"small",loading:(0,r.R1)(j),onClick:n[3]||(n[3]=e=>H(!0))},{default:(0,a.k6)(()=>[(0,a.eW)((0,o.v_)((0,r.R1)(j)?"定位中…":"自动定位"),1)]),_:1},8,["loading"])])]),(0,a.Lk)("div",v,["modal"===e.mode?((0,a.uX)(),(0,a.Wv)(W,{key:0,"file-list":A.value,"onUpdate:fileList":n[4]||(n[4]=e=>A.value=e),"list-type":"picture-card",action:"/api/files/upload?category=POST",multiple:"","on-success":z,"on-remove":X,"before-upload":O,"on-error":N,accept:"image/*"},{default:(0,a.k6)(()=>[(0,a.bF)(U,null,{default:(0,a.k6)(()=>[(0,a.bF)((0,r.R1)(u.Plus))]),_:1})]),_:1},8,["file-list"])):((0,a.uX)(),(0,a.CE)("div",b,[(0,a.Lk)("button",{type:"button",class:"inline-plus","aria-label":"添加图片",title:"添加图片",onClick:B},[(0,a.bF)(U,null,{default:(0,a.k6)(()=>[(0,a.bF)((0,r.R1)(u.Plus))]),_:1})]),(0,a.Lk)("input",{ref_key:"inlineInputRef",ref:R,type:"file",accept:"image/*",multiple:"",class:"hidden-input",onChange:T},null,544),E.value.length?((0,a.uX)(),(0,a.CE)("div",k,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(E.value,(e,t)=>((0,a.uX)(),(0,a.CE)("div",{key:e.uid,class:"thumb"},[(0,a.Lk)("img",{src:e.url,alt:`已选择的图片${t+1}`},null,8,y),(0,a.bF)(U,{class:"remove",onClick:t=>$(e.uid)},{default:(0,a.k6)(()=>[(0,a.bF)((0,r.R1)(u.Close))]),_:1},8,["onClick"])]))),128))])):(0,a.Q3)("",!0)])),n[5]||(n[5]=(0,a.Lk)("p",{class:"hint"},"可上传 5 张以内图片，单张不超过 5MB",-1))]),(0,a.Lk)("div",C,[(0,a.Lk)("div",w,[(0,a.Lk)("span",null,"已添加 "+(0,o.v_)(P.tags.length)+" 个标签",1),P.imageIds.length?((0,a.uX)(),(0,a.CE)("span",F,"图片 "+(0,o.v_)(P.imageIds.length)+" 张",1)):(0,a.Q3)("",!0)]),(0,a.bF)(L,{type:"primary",size:"small",loading:I.value,onClick:Q},{default:(0,a.k6)(()=>[...n[6]||(n[6]=[(0,a.eW)(" 立即发布 ",-1)])]),_:1},8,["loading"])])])])],2)}}},_=n(6262);const I=(0,_.A)(L,[["__scopeId","data-v-01ddcbe4"]]);var A=I},5467:function(e,t,n){n.d(t,{K:function(){return l}});var a=n(953);let o="",r=null;const l=()=>{const e=(0,a.KR)(!1),t=(0,a.KR)(o),n=async()=>o?(t.value=o,o):r||(e.value=!0,r=fetch("https://api.vore.top/api/IPdata?ip=").then(e=>e.json()).then(e=>{const n=e?.ipdata?.info1||e?.adcode?.c||e?.ipdata?.info2||"";return o=(n||"").replace(/\s+/g,""),t.value=o,o}).catch(e=>(console.error("自动定位失败",e),"")).finally(()=>{e.value=!1,r=null}),r);return{detecting:e,detectedCity:t,detectCity:n}}},6400:function(e,t,n){n.d(t,{k:function(){return r}});var a=n(810),o=n(2636);const r=(0,a.nY)("user",{state:()=>({userInfo:null,loading:!1,initialized:!1}),getters:{isLoggedIn:e=>!!e.userInfo?.id,isAdmin:e=>"ADMIN"===e.userInfo?.role,isSeller:e=>"SELLER"===e.userInfo?.role},actions:{setUserInfo(e){this.userInfo=e},async fetchUserInfo(){this.loading=!0;try{const e=await(0,o.HW)();this.userInfo=e.data}catch(e){return this.userInfo=null,Promise.reject(e)}finally{this.loading=!1,this.initialized=!0}},async logout(){await(0,o.ri)(),this.userInfo=null,this.initialized=!0}}})},6697:function(e,t,n){var a=n(3751),o=n(641);const r={id:"app"};function l(e,t,n,a,l,i){const s=(0,o.g2)("Header"),u=(0,o.g2)("el-header"),c=(0,o.g2)("router-view"),d=(0,o.g2)("el-main"),p=(0,o.g2)("Footer"),f=(0,o.g2)("el-footer"),m=(0,o.g2)("el-container");return(0,o.uX)(),(0,o.CE)("div",r,[(0,o.bF)(m,null,{default:(0,o.k6)(()=>[(0,o.bF)(u,null,{default:(0,o.k6)(()=>[(0,o.bF)(s)]),_:1}),(0,o.bF)(d,null,{default:(0,o.k6)(()=>[(0,o.bF)(c)]),_:1}),(0,o.bF)(f,null,{default:(0,o.k6)(()=>[(0,o.bF)(p)]),_:1})]),_:1})])}n(4114);var i=n(33),s=n(953),u=n(5220),c=n(6400),d=n(163),p=n(7918),f=n(5394),m=n(8548);const h={class:"modal-header"};var g={__name:"ShareModal",props:{modelValue:Boolean},emits:["update:modelValue","posted"],setup(e,{emit:t}){const n=e,a=t,r=(0,o.EW)({get:()=>n.modelValue,set:e=>a("update:modelValue",e)}),l=(0,s.KR)(null),i=e=>{l.value?.resetForm(),"function"===typeof e?e():r.value=!1},u=()=>{r.value=!1,a("posted")},c=e=>{const t=l.value?.hasUnsaved?.value;t?p.s.confirm("草稿将不会保存，确定要关闭吗？","提示",{confirmButtonText:"仍要关闭",cancelButtonText:"继续编辑",type:"warning",distinguishCancelAndClose:!0}).then(()=>{i(e)}).catch(()=>{}):i(e)};return(e,t)=>{const n=(0,o.g2)("el-icon"),a=(0,o.g2)("el-button"),i=(0,o.g2)("el-dialog");return(0,o.uX)(),(0,o.Wv)(i,{modelValue:r.value,"onUpdate:modelValue":t[0]||(t[0]=e=>r.value=e),width:"540px","close-on-click-modal":!1,"show-close":!1,"before-close":c},{header:(0,o.k6)(()=>[(0,o.Lk)("div",h,[t[1]||(t[1]=(0,o.Lk)("h3",null,"分享此刻",-1)),(0,o.bF)(a,{text:"",onClick:c},{default:(0,o.k6)(()=>[(0,o.bF)(n,null,{default:(0,o.k6)(()=>[(0,o.bF)((0,s.R1)(m.Close))]),_:1})]),_:1})])]),default:(0,o.k6)(()=>[(0,o.bF)(f.A,{ref_key:"composerRef",ref:l,mode:"modal",onSubmitted:u},null,512)]),_:1},8,["modelValue"])}}},v=n(6262);const b=(0,v.A)(g,[["__scopeId","data-v-4416fe80"]]);var k=b;const y={class:"header-container"},C={class:"header-content"},w={class:"header-left"},F={class:"nav-menu"},L=["onClick"],_={class:"header-center"},I={class:"header-right"},A={class:"user-entry"},E={class:"user-avatar"};var R={__name:"Header",setup(e){const t=(0,u.rd)(),n=(0,u.lq)(),r=(0,c.k)(),l=(0,s.KR)(""),p=(0,s.KR)(!1),f=[{path:"/",label:"广场"},{path:"/feed",label:"关注"},{path:"/nearby",label:"附近"},{path:"/wiki",label:"维基"}];(0,o.sV)(()=>{r.initialized||r.loading||r.fetchUserInfo().catch(()=>{})});const m=()=>t.push("/"),h=e=>t.push(e),g=()=>{if(!r.isLoggedIn)return d.nk.warning("请先登录"),void t.push("/login");t.push("/messages")},v=()=>t.push("/user/profile?tab=posts"),b=()=>{if(!r.isLoggedIn)return d.nk.warning("请先登录"),void t.push("/login");t.push("/user/profile?tab=collections")},R=()=>{if(!r.isLoggedIn)return d.nk.warning("请先登录"),void t.push("/login");t.push("/user/profile?tab=history")},P=()=>t.push("/login"),S=()=>t.push("/register"),K=()=>{l.value&&t.push({path:"/search",query:{q:l.value}})},V=()=>{if(!r.isLoggedIn)return d.nk.warning("请先登录后再分享"),void t.push("/login");p.value=!0},U=()=>{t.replace({path:t.currentRoute.value.fullPath})},W=async e=>{"profile"===e?t.push("/user/profile"):"settings"===e?t.push("/user/settings"):"logout"===e&&(await r.logout(),d.nk.success("已退出登录"),t.push("/"))};return(e,t)=>{const u=(0,o.g2)("Search"),c=(0,o.g2)("el-icon"),d=(0,o.g2)("el-input"),j=(0,o.g2)("User"),x=(0,o.g2)("el-avatar"),O=(0,o.g2)("el-dropdown-item"),z=(0,o.g2)("el-dropdown-menu"),X=(0,o.g2)("el-dropdown"),N=(0,o.g2)("el-button");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("div",y,[(0,o.Lk)("div",C,[(0,o.Lk)("div",w,[(0,o.Lk)("div",{class:"logo",onClick:m},"醇饮"),(0,o.Lk)("div",F,[((0,o.uX)(),(0,o.CE)(o.FK,null,(0,o.pI)(f,e=>(0,o.Lk)("div",{key:e.path,class:(0,i.C4)(["nav-item",{active:(0,s.R1)(n).path===e.path}]),onClick:t=>h(e.path)},(0,i.v_)(e.label),11,L)),64))])]),(0,o.Lk)("div",_,[(0,o.bF)(d,{modelValue:l.value,"onUpdate:modelValue":t[0]||(t[0]=e=>l.value=e),placeholder:"探索动态 / 酒饮 / 用户",class:"search-input",onKeyup:(0,a.jR)(K,["enter"]),clearable:""},{prefix:(0,o.k6)(()=>[(0,o.bF)(c,{class:"search-icon"},{default:(0,o.k6)(()=>[(0,o.bF)(u)]),_:1})]),_:1},8,["modelValue"])]),(0,o.Lk)("div",I,[(0,o.Lk)("div",A,[(0,s.R1)(r).isLoggedIn?((0,o.uX)(),(0,o.Wv)(X,{key:0,onCommand:W},{dropdown:(0,o.k6)(()=>[(0,o.bF)(z,null,{default:(0,o.k6)(()=>[(0,o.bF)(O,{command:"profile"},{default:(0,o.k6)(()=>[...t[2]||(t[2]=[(0,o.eW)("个人中心",-1)])]),_:1}),(0,o.bF)(O,{command:"settings"},{default:(0,o.k6)(()=>[...t[3]||(t[3]=[(0,o.eW)("设置",-1)])]),_:1}),(0,o.bF)(O,{command:"logout",divided:""},{default:(0,o.k6)(()=>[...t[4]||(t[4]=[(0,o.eW)("退出登录",-1)])]),_:1})]),_:1})]),default:(0,o.k6)(()=>[(0,o.Lk)("span",E,[(0,o.bF)(x,{size:36,src:(0,s.R1)(r).userInfo.avatarUrl,alt:`${(0,s.R1)(r).userInfo?.username||"用户"}的头像`},{default:(0,o.k6)(()=>[(0,o.bF)(c,null,{default:(0,o.k6)(()=>[(0,o.bF)(j)]),_:1})]),_:1},8,["src","alt"])])]),_:1})):((0,o.uX)(),(0,o.CE)(o.FK,{key:1},[(0,o.bF)(N,{text:"",size:"small",onClick:P},{default:(0,o.k6)(()=>[...t[5]||(t[5]=[(0,o.eW)("登录",-1)])]),_:1}),(0,o.bF)(N,{text:"",size:"small",onClick:S},{default:(0,o.k6)(()=>[...t[6]||(t[6]=[(0,o.eW)("注册",-1)])]),_:1})],64))]),(0,o.Lk)("div",{class:"quick-links"},[(0,o.Lk)("span",{onClick:g},"消息"),(0,o.Lk)("span",{onClick:v},"动态"),(0,o.Lk)("span",{onClick:b},"收藏"),(0,o.Lk)("span",{onClick:R},"足迹")]),(0,o.bF)(N,{type:"primary",class:"share-btn",plain:"",onClick:V},{default:(0,o.k6)(()=>[...t[7]||(t[7]=[(0,o.eW)(" 分享此刻 ",-1)])]),_:1})])])]),(0,o.bF)(k,{modelValue:p.value,"onUpdate:modelValue":t[1]||(t[1]=e=>p.value=e),onPosted:U},null,8,["modelValue"])],64)}}};const P=(0,v.A)(R,[["__scopeId","data-v-3f04ab64"]]);var S=P;const K={class:"footer-container"};function V(e,t,n,a,r,l){return(0,o.uX)(),(0,o.CE)("div",K,[...t[0]||(t[0]=[(0,o.Lk)("p",null,"© 2025 酒饮平台 | 酒精饮料信息分享社区",-1)])])}var U={name:"Footer"};const W=(0,v.A)(U,[["render",V],["__scopeId","data-v-a8084066"]]);var j=W,x={name:"App",components:{Header:S,Footer:j}};const O=(0,v.A)(x,[["render",l]]);var z=O,X=n(810);const N=(0,X.Ey)();var B=N;const T=[{path:"/",name:"Home",component:()=>n.e(311).then(n.bind(n,2311))},{path:"/feed",name:"Feed",component:()=>n.e(563).then(n.bind(n,9563)),meta:{requiresAuth:!0}},{path:"/nearby",name:"Nearby",component:()=>n.e(604).then(n.bind(n,2604))},{path:"/beverages",name:"BeverageList",component:()=>n.e(423).then(n.bind(n,4423))},{path:"/beverages/:id",name:"BeverageDetail",component:()=>n.e(508).then(n.bind(n,4508))},{path:"/announcements",name:"AnnouncementList",component:()=>n.e(953).then(n.bind(n,5953))},{path:"/wiki",name:"WikiList",component:()=>n.e(384).then(n.bind(n,7384))},{path:"/wiki/edit/:id?",name:"WikiEditor",component:()=>Promise.all([n.e(257),n.e(315)]).then(n.bind(n,7315)),meta:{requiresAuth:!0}},{path:"/wiki/:slug",name:"WikiDetail",component:()=>Promise.all([n.e(257),n.e(614)]).then(n.bind(n,5614))},{path:"/posts/:id",name:"PostDetail",component:()=>n.e(144).then(n.bind(n,6144))},{path:"/search",name:"Search",component:()=>n.e(591).then(n.bind(n,8591))},{path:"/messages",name:"Messages",component:()=>n.e(363).then(n.bind(n,1363)),meta:{requiresAuth:!0}},{path:"/login",name:"Login",component:()=>n.e(827).then(n.bind(n,7827))},{path:"/register",name:"Register",component:()=>n.e(969).then(n.bind(n,3969))},{path:"/user/profile",name:"UserProfile",component:()=>n.e(444).then(n.bind(n,1444)),meta:{requiresAuth:!0}},{path:"/user/settings",name:"UserSettings",component:()=>n.e(889).then(n.bind(n,1889)),meta:{requiresAuth:!0}},{path:"/users/:id",name:"UserHome",component:()=>n.e(116).then(n.bind(n,1116))}],$=(0,u.aE)({history:(0,u.LA)("/"),routes:T});$.beforeEach(async(e,t,n)=>{const a=(0,c.k)(B);a.initialized||a.loading||await a.fetchUserInfo().catch(()=>{}),e.meta.requiresAuth&&!a.isLoggedIn?n("/login"):n()});var q=$,D=n(6444);n(4188);const M=(0,a.Ef)(z);for(const[H,Q]of Object.entries(m))M.component(H,Q);M.use(q),M.use(B),M.use(D.A),M.mount("#app")},7277:function(e,t,n){var a=n(4335),o=n(163);const r=a.A.create({baseURL:"/api",timeout:3e4,withCredentials:!0});r.interceptors.response.use(e=>{const t=e.data;return 200!==t.code?(o.nk.error(t.message||"请求失败"),Promise.reject(new Error(t.message||"Error"))):t},e=>{if(e.response){const{status:t,config:n,data:a}=e.response,r=n?.url||"",l=r.includes("/auth/me"),i=["/login","/register"].some(e=>window.location.pathname.startsWith(e)),s=["/auth/login","/auth/register"].some(e=>r.includes(e)),u=a?.message;switch(t){case 401:if(l)break;s||o.nk.error(u||"请先登录"),i||s||(window.location.href="/login");break;case 403:o.nk.error(u||"没有访问权限");break;case 404:o.nk.error(u||"请求的资源不存在");break;default:o.nk.error(u||e.message||"请求失败")}}else o.nk.error("网络错误，请稍后再试");return Promise.reject(e)}),t.A=r}},t={};function n(a){var o=t[a];if(void 0!==o)return o.exports;var r=t[a]={exports:{}};return e[a].call(r.exports,r,r.exports,n),r.exports}n.m=e,function(){var e=[];n.O=function(t,a,o,r){if(!a){var l=1/0;for(c=0;c<e.length;c++){a=e[c][0],o=e[c][1],r=e[c][2];for(var i=!0,s=0;s<a.length;s++)(!1&r||l>=r)&&Object.keys(n.O).every(function(e){return n.O[e](a[s])})?a.splice(s--,1):(i=!1,r<l&&(l=r));if(i){e.splice(c--,1);var u=o();void 0!==u&&(t=u)}}return t}r=r||0;for(var c=e.length;c>0&&e[c-1][2]>r;c--)e[c]=e[c-1];e[c]=[a,o,r]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){n.f={},n.e=function(e){return Promise.all(Object.keys(n.f).reduce(function(t,a){return n.f[a](e,t),t},[]))}}(),function(){n.u=function(e){return"js/"+e+"."+{116:"e6d90f28",144:"e08a3d96",257:"a242faa7",311:"15d7e7ea",315:"db42e7fd",363:"f34e47c7",384:"ab0d22c9",423:"9f72dfc1",444:"53483388",508:"1400d871",563:"ebd04bd4",591:"d7407cf5",604:"4da23742",614:"54e03e75",827:"cca93b91",889:"3ac8c43e",953:"45964599",969:"f3cadb39"}[e]+".js"}}(),function(){n.miniCssF=function(e){return"css/"+e+"."+{116:"64cba01f",144:"28bad5fd",311:"413b8e0d",315:"6771e582",363:"4188e47e",384:"62b76153",423:"97895b15",444:"41014737",508:"45abe418",563:"0f92b3e1",591:"0e4d345d",604:"00365e4c",614:"3a605256",827:"3e1a8be9",889:"9d5d2bce",953:"f22993bd",969:"853c8f16"}[e]+".css"}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="demo2:";n.l=function(a,o,r,l){if(e[a])e[a].push(o);else{var i,s;if(void 0!==r)for(var u=document.getElementsByTagName("script"),c=0;c<u.length;c++){var d=u[c];if(d.getAttribute("src")==a||d.getAttribute("data-webpack")==t+r){i=d;break}}i||(s=!0,i=document.createElement("script"),i.charset="utf-8",n.nc&&i.setAttribute("nonce",n.nc),i.setAttribute("data-webpack",t+r),i.src=a),e[a]=[o];var p=function(t,n){i.onerror=i.onload=null,clearTimeout(f);var o=e[a];if(delete e[a],i.parentNode&&i.parentNode.removeChild(i),o&&o.forEach(function(e){return e(n)}),t)return t(n)},f=setTimeout(p.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=p.bind(null,i.onerror),i.onload=p.bind(null,i.onload),s&&document.head.appendChild(i)}}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){n.p="/"}(),function(){if("undefined"!==typeof document){var e=function(e,t,a,o,r){var l=document.createElement("link");l.rel="stylesheet",l.type="text/css",n.nc&&(l.nonce=n.nc);var i=function(n){if(l.onerror=l.onload=null,"load"===n.type)o();else{var a=n&&n.type,i=n&&n.target&&n.target.href||t,s=new Error("Loading CSS chunk "+e+" failed.\n("+a+": "+i+")");s.name="ChunkLoadError",s.code="CSS_CHUNK_LOAD_FAILED",s.type=a,s.request=i,l.parentNode&&l.parentNode.removeChild(l),r(s)}};return l.onerror=l.onload=i,l.href=t,a?a.parentNode.insertBefore(l,a.nextSibling):document.head.appendChild(l),l},t=function(e,t){for(var n=document.getElementsByTagName("link"),a=0;a<n.length;a++){var o=n[a],r=o.getAttribute("data-href")||o.getAttribute("href");if("stylesheet"===o.rel&&(r===e||r===t))return o}var l=document.getElementsByTagName("style");for(a=0;a<l.length;a++){o=l[a],r=o.getAttribute("data-href");if(r===e||r===t)return o}},a=function(a){return new Promise(function(o,r){var l=n.miniCssF(a),i=n.p+l;if(t(l,i))return o();e(a,i,null,o,r)})},o={524:0};n.f.miniCss=function(e,t){var n={116:1,144:1,311:1,315:1,363:1,384:1,423:1,444:1,508:1,563:1,591:1,604:1,614:1,827:1,889:1,953:1,969:1};o[e]?t.push(o[e]):0!==o[e]&&n[e]&&t.push(o[e]=a(e).then(function(){o[e]=0},function(t){throw delete o[e],t}))}}}(),function(){var e={524:0};n.f.j=function(t,a){var o=n.o(e,t)?e[t]:void 0;if(0!==o)if(o)a.push(o[2]);else{var r=new Promise(function(n,a){o=e[t]=[n,a]});a.push(o[2]=r);var l=n.p+n.u(t),i=new Error,s=function(a){if(n.o(e,t)&&(o=e[t],0!==o&&(e[t]=void 0),o)){var r=a&&("load"===a.type?"missing":a.type),l=a&&a.target&&a.target.src;i.message="Loading chunk "+t+" failed.\n("+r+": "+l+")",i.name="ChunkLoadError",i.type=r,i.request=l,o[1](i)}};n.l(l,s,"chunk-"+t,t)}},n.O.j=function(t){return 0===e[t]};var t=function(t,a){var o,r,l=a[0],i=a[1],s=a[2],u=0;if(l.some(function(t){return 0!==e[t]})){for(o in i)n.o(i,o)&&(n.m[o]=i[o]);if(s)var c=s(n)}for(t&&t(a);u<l.length;u++)r=l[u],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return n.O(c)},a=self["webpackChunkdemo2"]=self["webpackChunkdemo2"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=n.O(void 0,[504],function(){return n(6697)});a=n.O(a)})();
//# sourceMappingURL=app.03432a74.js.map