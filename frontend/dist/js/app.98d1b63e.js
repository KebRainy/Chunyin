(function(){"use strict";var e={1072:function(e,t,n){var a=n(3751),i=n(641);const o={id:"app"};function l(e,t,n,a,l,s){const r=(0,i.g2)("Header"),u=(0,i.g2)("el-header"),c=(0,i.g2)("router-view"),d=(0,i.g2)("el-main"),m=(0,i.g2)("Footer"),v=(0,i.g2)("el-footer"),p=(0,i.g2)("el-container"),g=(0,i.g2)("RAGFloatingWindow");return(0,i.uX)(),(0,i.CE)("div",o,[(0,i.bF)(p,null,{default:(0,i.k6)(()=>[(0,i.bF)(u,null,{default:(0,i.k6)(()=>[(0,i.bF)(r)]),_:1}),(0,i.bF)(d,null,{default:(0,i.k6)(()=>[(0,i.bF)(c)]),_:1}),(0,i.bF)(v,null,{default:(0,i.k6)(()=>[(0,i.bF)(m)]),_:1})]),_:1}),(0,i.bF)(g)])}n(4114);var s=n(33),r=n(953),u=n(5220),c=n(6400),d=n(163),m=n(7918),v=n(5394),p=n(8548);const g={class:"modal-header"};var h={__name:"ShareModal",props:{modelValue:Boolean},emits:["update:modelValue","posted"],setup(e,{emit:t}){const n=e,a=t,o=(0,i.EW)({get:()=>n.modelValue,set:e=>a("update:modelValue",e)}),l=(0,r.KR)(null),s=e=>{l.value?.resetForm(),"function"===typeof e?e():o.value=!1},u=()=>{o.value=!1,a("posted")},c=e=>{const t=l.value?.hasUnsaved?.value;t?m.s.confirm("草稿将不会保存，确定要关闭吗？","提示",{confirmButtonText:"仍要关闭",cancelButtonText:"继续编辑",type:"warning",distinguishCancelAndClose:!0}).then(()=>{s(e)}).catch(()=>{}):s(e)};return(e,t)=>{const n=(0,i.g2)("el-icon"),a=(0,i.g2)("el-button"),s=(0,i.g2)("el-dialog");return(0,i.uX)(),(0,i.Wv)(s,{modelValue:o.value,"onUpdate:modelValue":t[0]||(t[0]=e=>o.value=e),width:"540px","close-on-click-modal":!1,"show-close":!1,"before-close":c},{header:(0,i.k6)(()=>[(0,i.Lk)("div",g,[t[1]||(t[1]=(0,i.Lk)("h3",null,"分享此刻",-1)),(0,i.bF)(a,{text:"",onClick:c},{default:(0,i.k6)(()=>[(0,i.bF)(n,null,{default:(0,i.k6)(()=>[(0,i.bF)((0,r.R1)(p.Close))]),_:1})]),_:1})])]),default:(0,i.k6)(()=>[(0,i.bF)(v.A,{ref_key:"composerRef",ref:l,mode:"modal",onSubmitted:u},null,512)]),_:1},8,["modelValue"])}}},f=n(6262);const k=(0,f.A)(h,[["__scopeId","data-v-4416fe80"]]);var b=k;const y={class:"header-container"},w={class:"header-content"},C={class:"header-left"},L={class:"nav-menu"},R=["onClick"],_={class:"header-center"},F={class:"header-right"},I={class:"user-entry"},A={class:"user-avatar"},E={class:"quick-links"};var x={__name:"Header",setup(e){const t=(0,u.rd)(),n=(0,u.lq)(),o=(0,c.k)(),l=(0,r.KR)(""),m=(0,r.KR)(!1),v=(0,i.EW)(()=>{const e=[{path:"/",label:"广场"},{path:"/nearby",label:"附近"},{path:"/ranking",label:"排行榜"},{path:"/bars",label:"酒吧"},{path:"/wiki",label:"维基"}];return o.isAdmin?e.splice(1,0,{path:"/admin/activities/review",label:"活动审核"}):o.isSeller?e.splice(1,0,{path:"/seller/activity",label:"管理"}):e.splice(1,0,{path:"/activities",label:"活动"}),e});(0,i.sV)(()=>{o.initialized||o.loading||o.fetchUserInfo().catch(()=>{})});const p=()=>t.push("/"),g=e=>{if("/activities"===e){if(!o.isLoggedIn)return d.nk.warning("请先登录"),void t.push("/login");t.push("/activities")}else if("/seller/activity"===e){if(!o.isLoggedIn)return d.nk.warning("请先登录"),void t.push("/login");t.push("/seller/activity")}else if("/seller/activity"===e){if(!o.isLoggedIn)return d.nk.warning("请先登录"),void t.push("/login");if(!o.isSeller)return void d.nk.warning("此功能仅限商家用户");t.push("/seller/activity")}else if("/admin/activities/review"===e){if(!o.isLoggedIn)return d.nk.warning("请先登录"),void t.push("/login");if(!o.isAdmin)return void d.nk.warning("此功能仅限管理员");t.push("/admin/activities/review")}else t.push(e)},h=()=>{if(!o.isLoggedIn)return d.nk.warning("请先登录"),void t.push("/login");t.push("/feed")},f=()=>{if(!o.isLoggedIn)return d.nk.warning("请先登录"),void t.push("/login");t.push("/messages")},k=()=>t.push("/user/profile?tab=posts"),x=()=>{if(!o.isLoggedIn)return d.nk.warning("请先登录"),void t.push("/login");t.push("/user/profile?tab=collections")},X=()=>{if(!o.isLoggedIn)return d.nk.warning("请先登录"),void t.push("/login");t.push("/user/profile?tab=history")},P=()=>{if(!o.isLoggedIn)return d.nk.warning("请先登录"),void t.push("/login");t.push("/activities")},S=()=>{o.isLoggedIn&&o.isSeller?t.push("/seller/activity"):d.nk.warning("此功能仅限商家用户")},W=()=>{o.isLoggedIn&&o.isAdmin?t.push("/admin/activities/review"):d.nk.warning("此功能仅限管理员")},K=()=>t.push("/login"),z=()=>t.push("/register"),q=()=>{l.value&&t.push({path:"/search",query:{q:l.value}})},$=()=>{if(!o.isLoggedIn)return d.nk.warning("请先登录后再分享"),void t.push("/login");m.value=!0},V=()=>{t.replace({path:t.currentRoute.value.fullPath})},U=async e=>{"profile"===e?t.push("/user/profile"):"settings"===e?t.push("/user/settings"):"admin"===e?t.push("/admin/moderation"):"logout"===e&&(await o.logout(),d.nk.success("已退出登录"),t.push("/"))};return(e,t)=>{const u=(0,i.g2)("Search"),c=(0,i.g2)("el-icon"),d=(0,i.g2)("el-input"),j=(0,i.g2)("User"),N=(0,i.g2)("el-avatar"),B=(0,i.g2)("el-dropdown-item"),O=(0,i.g2)("el-dropdown-menu"),Q=(0,i.g2)("el-dropdown"),D=(0,i.g2)("el-button");return(0,i.uX)(),(0,i.CE)(i.FK,null,[(0,i.Lk)("div",y,[(0,i.Lk)("div",w,[(0,i.Lk)("div",C,[(0,i.Lk)("div",{class:"logo",onClick:p},"醇饮"),(0,i.Lk)("div",L,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(v.value,e=>((0,i.uX)(),(0,i.CE)("div",{key:e.path,class:(0,s.C4)(["nav-item",{active:(0,r.R1)(n).path===e.path||"/activities"===e.path&&(0,r.R1)(n).path.startsWith("/activities")&&!(0,r.R1)(n).path.startsWith("/activities/create")||"/seller/activity"===e.path&&(0,r.R1)(n).path.startsWith("/seller/activity")||"/admin/activities/review"===e.path&&(0,r.R1)(n).path.startsWith("/admin/activities/review")}]),onClick:t=>g(e.path)},(0,s.v_)(e.label),11,R))),128))])]),(0,i.Lk)("div",_,[(0,i.bF)(d,{modelValue:l.value,"onUpdate:modelValue":t[0]||(t[0]=e=>l.value=e),placeholder:"探索动态 / 酒饮 / 用户",class:"search-input",onKeyup:(0,a.jR)(q,["enter"]),clearable:""},{prefix:(0,i.k6)(()=>[(0,i.bF)(c,{class:"search-icon"},{default:(0,i.k6)(()=>[(0,i.bF)(u)]),_:1})]),_:1},8,["modelValue"])]),(0,i.Lk)("div",F,[(0,i.Lk)("div",I,[(0,r.R1)(o).isLoggedIn?((0,i.uX)(),(0,i.Wv)(Q,{key:0,onCommand:U},{dropdown:(0,i.k6)(()=>[(0,i.bF)(O,null,{default:(0,i.k6)(()=>[(0,i.bF)(B,{command:"profile"},{default:(0,i.k6)(()=>[...t[2]||(t[2]=[(0,i.eW)("个人中心",-1)])]),_:1}),(0,i.bF)(B,{command:"settings"},{default:(0,i.k6)(()=>[...t[3]||(t[3]=[(0,i.eW)("设置",-1)])]),_:1}),(0,r.R1)(o).isAdmin?((0,i.uX)(),(0,i.Wv)(B,{key:0,command:"admin",divided:""},{default:(0,i.k6)(()=>[...t[4]||(t[4]=[(0,i.Lk)("span",{style:{color:"#409EFF","font-weight":"600"}},"管理后台",-1)])]),_:1})):(0,i.Q3)("",!0),(0,i.bF)(B,{command:"logout",divided:""},{default:(0,i.k6)(()=>[...t[5]||(t[5]=[(0,i.eW)("退出登录",-1)])]),_:1})]),_:1})]),default:(0,i.k6)(()=>[(0,i.Lk)("span",A,[(0,i.bF)(N,{size:36,src:(0,r.R1)(o).userInfo.avatarUrl,alt:`${(0,r.R1)(o).userInfo?.username||"用户"}的头像`},{default:(0,i.k6)(()=>[(0,i.bF)(c,null,{default:(0,i.k6)(()=>[(0,i.bF)(j)]),_:1})]),_:1},8,["src","alt"])])]),_:1})):((0,i.uX)(),(0,i.CE)(i.FK,{key:1},[(0,i.bF)(D,{text:"",size:"small",onClick:K},{default:(0,i.k6)(()=>[...t[6]||(t[6]=[(0,i.eW)("登录",-1)])]),_:1}),(0,i.bF)(D,{text:"",size:"small",onClick:z},{default:(0,i.k6)(()=>[...t[7]||(t[7]=[(0,i.eW)("注册",-1)])]),_:1})],64))]),(0,i.Lk)("div",E,[(0,r.R1)(o).isLoggedIn?((0,i.uX)(),(0,i.CE)("span",{key:0,onClick:h},"关注")):(0,i.Q3)("",!0),(0,i.Lk)("span",{onClick:f},"消息"),(0,i.Lk)("span",{onClick:k},"动态"),(0,i.Lk)("span",{onClick:x},"收藏"),(0,i.Lk)("span",{onClick:X},"足迹"),!(0,r.R1)(o).isLoggedIn||(0,r.R1)(o).isSeller||(0,r.R1)(o).isAdmin?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("span",{key:1,onClick:P},"活动")),(0,r.R1)(o).isSeller?((0,i.uX)(),(0,i.CE)("span",{key:2,onClick:S},"管理")):(0,i.Q3)("",!0),(0,r.R1)(o).isAdmin?((0,i.uX)(),(0,i.CE)("span",{key:3,onClick:W},"活动审核")):(0,i.Q3)("",!0)]),(0,i.bF)(D,{type:"primary",class:"share-btn",plain:"",onClick:$},{default:(0,i.k6)(()=>[...t[8]||(t[8]=[(0,i.eW)(" 分享此刻 ",-1)])]),_:1})])])]),(0,i.bF)(b,{modelValue:m.value,"onUpdate:modelValue":t[1]||(t[1]=e=>m.value=e),onPosted:V},null,8,["modelValue"])],64)}}};const X=(0,f.A)(x,[["__scopeId","data-v-307afa7a"]]);var P=X;const S={class:"footer-container"};function W(e,t,n,a,o,l){return(0,i.uX)(),(0,i.CE)("div",S,[...t[0]||(t[0]=[(0,i.Lk)("p",null,"© 2025 酒饮平台 | 酒精饮料信息分享社区",-1)])])}var K={name:"Footer"};const z=(0,f.A)(K,[["render",W],["__scopeId","data-v-a8084066"]]);var q=z,$=(n(8111),n(1701),n(3110),n(716),n(9686));const V={class:"header-actions"},U={key:0,class:"window-body"},j={key:0,class:"window-content"},N={class:"search-section"},B={class:"query-examples"},O={class:"search-actions"},Q={key:0,class:"recommendation-reason"},D=["innerHTML"],T={key:1,class:"loading-section"},M={key:2,class:"results-section"},H={class:"wiki-list"},G=["onClick"],Y={class:"wiki-info"},J={key:0,class:"wiki-summary"},Z={key:1,class:"wiki-similarity"},ee={key:3,class:"results-section"},te={class:"beverages-list"},ne=["onClick"],ae={key:0,class:"beverage-image"},ie=["src","alt"],oe={key:1,class:"beverage-image no-image"},le={class:"beverage-info"},se={class:"beverage-type"},re={key:0,class:"beverage-origin"},ue={key:1,class:"beverage-rating"},ce={key:4,class:"empty-section"},de={key:1,class:"history-view"},me={class:"history-header"},ve={class:"history-content"},pe={key:0,class:"empty-history"},ge={key:1,class:"history-list"},he={class:"user-message"},fe={key:0,class:"ai-message"};var ke={__name:"RAGFloatingWindow",setup(e){const t=(0,u.rd)(),n=(0,r.KR)(!1),o=(0,r.KR)(""),l=(0,r.KR)(!1),c=(0,r.KR)(null),m=(0,r.KR)(!1),v=(0,r.KR)([]),g=(0,r.KR)(!1),h=(0,r.KR)({position:"fixed",bottom:"20px",right:"20px",width:"480px",zIndex:2e3}),f=(0,r.KR)(!1),k=(0,r.KR)({x:0,y:0}),b=["适合晚餐的红酒","清淡口味的啤酒","适合聚会的鸡尾酒","高端的威士忌","适合女性的甜酒"];(0,i.sV)(()=>{const e=localStorage.getItem("ragWindowPosition"),t=localStorage.getItem("ragWindowVisible");if(e)try{const{x:t,y:n,width:a}=JSON.parse(e);h.value={...h.value,left:`${t}px`,top:`${n}px`,bottom:"auto",right:"auto",width:a||"600px"}}catch(a){console.error("恢复窗口位置失败",a)}"true"===t&&(n.value=!0)}),(0,i.wB)(n,e=>{localStorage.setItem("ragWindowVisible",String(e)),e&&(h.value.zIndex=2e3)});const y=()=>{if(n.value=!0,g.value=!1,h.value.left){const{top:e,...t}=h.value;h.value={...t,bottom:"20px"}}else h.value={...h.value,bottom:"20px",right:"20px"}},w=()=>{n.value=!1},C=()=>{const e=m.value;if(m.value=!m.value,m.value)g.value=!1;else if(e){g.value=!1;const{top:e,...t}=h.value;h.value={...t,bottom:"20px"}}const t=m.value?"300px":"480px";h.value={...h.value,width:t},F()},L=e=>{if(e.target.closest(".header-actions"))return;f.value=!0;const t=e.currentTarget.getBoundingClientRect();k.value={x:e.clientX-t.left,y:e.clientY-t.top},document.addEventListener("mousemove",R),document.addEventListener("mouseup",_)},R=e=>{if(!f.value)return;const t=e.clientX-k.value.x,n=e.clientY-k.value.y,a=parseInt(h.value.width)||600;h.value={...h.value,left:`${Math.max(0,Math.min(t,window.innerWidth-a))}px`,top:`${Math.max(0,Math.min(n,window.innerHeight-200))}px`,bottom:"auto",right:"auto"}},_=()=>{f.value&&(f.value=!1,F()),document.removeEventListener("mousemove",R),document.removeEventListener("mouseup",_)},F=()=>{const e=h.value;e.left&&e.top&&localStorage.setItem("ragWindowPosition",JSON.stringify({x:parseInt(e.left),y:parseInt(e.top),width:e.width}))};(0,i.xo)(()=>{document.removeEventListener("mousemove",R),document.removeEventListener("mouseup",_)});const I=async()=>{if(o.value.trim()){l.value=!0,c.value=null;try{const e={query:o.value,topK:10,includeReason:!0,conversationHistory:v.value.map(e=>({userQuery:e.userQuery,aiResponse:e.aiResponse}))},t=await $.L.ragRecommendBeveragesWithHistory(e);200===t.code&&t.data?(c.value=t.data,v.value.push({userQuery:o.value,aiResponse:c.value.recommendationReason||""}),v.value.length>10&&(v.value=v.value.slice(-10)),c.value.wikiContents&&c.value.wikiContents.length>0?d.nk.success(`为您找到 ${c.value.wikiContents.length} 条Wiki内容`):c.value.beverages&&c.value.beverages.length>0&&d.nk.success(`为您找到 ${c.value.beverages.length} 款推荐酒类`)):d.nk.error(t.message||"推荐失败，请稍后重试")}catch(e){console.error("推荐失败",e),d.nk.error("推荐失败，请稍后重试")}finally{l.value=!1}}else d.nk.warning("请输入查询内容")},A=()=>{o.value="",c.value=null},E=()=>{v.value=[]},x=()=>{if(!m.value)if(g.value=!g.value,g.value)h.value={...h.value,top:"0",bottom:"auto"};else{const{top:e,...t}=h.value;h.value={...t,bottom:"20px"}}},X=e=>{t.push(`/beverage/${e}`)},P=e=>{if(e.slug)t.push(`/wiki/${encodeURIComponent(e.slug)}`);else if(e.title){const n=e.title.toLowerCase().replace(/\s+/g,"-").replace(/[^\w\u4e00-\u9fa5-]/g,"");t.push(`/wiki/${encodeURIComponent(n)}`)}else t.push("/wiki")},S=e=>`/api/file/${e}`,W=e=>e?e.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/\n/g,"<br/>"):"";return(e,t)=>{const u=(0,i.g2)("el-icon"),d=(0,i.g2)("el-button"),f=(0,i.g2)("el-input"),k=(0,i.g2)("el-tag"),R=(0,i.g2)("el-skeleton"),_=(0,i.g2)("el-rate"),F=(0,i.g2)("el-empty");return(0,i.uX)(),(0,i.Wv)(i.Im,{to:"body"},[n.value?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("div",{key:0,class:"rag-trigger-button",onClick:y},[(0,i.bF)(u,null,{default:(0,i.k6)(()=>[(0,i.bF)((0,r.R1)(p.ChatDotRound))]),_:1}),t[1]||(t[1]=(0,i.Lk)("span",null,"智能荐酒",-1))])),n.value?((0,i.uX)(),(0,i.CE)("div",{key:1,class:"rag-floating-window-wrapper",style:(0,s.Tr)(h.value)},[(0,i.Lk)("div",{class:(0,s.C4)(["rag-floating-window",{minimized:m.value,"show-history":g.value}])},[(0,i.Lk)("div",{class:"window-header",onMousedown:L},[(0,i.bF)(u,null,{default:(0,i.k6)(()=>[(0,i.bF)((0,r.R1)(p.ChatDotRound))]),_:1}),t[2]||(t[2]=(0,i.Lk)("span",null,"智能荐酒",-1)),(0,i.Lk)("div",V,[m.value?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.Wv)(d,{key:0,text:"",icon:g.value?(0,r.R1)(p.ChatDotRound):(0,r.R1)(p.Document),onClick:x,title:g.value?"返回输入框":"查看对话历史"},null,8,["icon","title"])),(0,i.bF)(d,{text:"",icon:m.value?(0,r.R1)(p.FullScreen):(0,r.R1)(p.Minus),onClick:C},null,8,["icon"]),(0,i.bF)(d,{text:"",icon:(0,r.R1)(p.Close),onClick:w},null,8,["icon"])])],32),m.value?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("div",U,[g.value?((0,i.uX)(),(0,i.CE)("div",de,[(0,i.Lk)("div",me,[t[11]||(t[11]=(0,i.Lk)("span",null,"对话历史",-1)),(0,i.bF)(d,{text:"",size:"small",onClick:E},{default:(0,i.k6)(()=>[(0,i.bF)(u,null,{default:(0,i.k6)(()=>[(0,i.bF)((0,r.R1)(p.Delete))]),_:1}),t[10]||(t[10]=(0,i.eW)(" 清空历史 ",-1))]),_:1})]),(0,i.Lk)("div",ve,[0===v.value.length?((0,i.uX)(),(0,i.CE)("div",pe,[(0,i.bF)(F,{description:"暂无对话历史","image-size":80})])):((0,i.uX)(),(0,i.CE)("div",ge,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(v.value,(e,t)=>((0,i.uX)(),(0,i.CE)("div",{key:t,class:"history-item"},[(0,i.Lk)("div",he,[(0,i.bF)(u,null,{default:(0,i.k6)(()=>[(0,i.bF)((0,r.R1)(p.User))]),_:1}),(0,i.Lk)("span",null,(0,s.v_)(e.userQuery),1)]),e.aiResponse?((0,i.uX)(),(0,i.CE)("div",fe,[(0,i.bF)(u,null,{default:(0,i.k6)(()=>[(0,i.bF)((0,r.R1)(p.ChatDotRound))]),_:1}),(0,i.Lk)("span",null,(0,s.v_)(e.aiResponse),1)])):(0,i.Q3)("",!0)]))),128))]))])])):((0,i.uX)(),(0,i.CE)("div",j,[(0,i.Lk)("div",N,[(0,i.bF)(f,{modelValue:o.value,"onUpdate:modelValue":t[0]||(t[0]=e=>o.value=e),type:"textarea",rows:3,placeholder:"例如：我想要一款适合晚餐的清淡红酒",maxlength:200,"show-word-limit":"",onKeyup:(0,a.jR)((0,a.D$)(I,["ctrl"]),["enter"])},null,8,["modelValue","onKeyup"]),(0,i.Lk)("div",B,[t[3]||(t[3]=(0,i.Lk)("span",{class:"example-label"},"查询示例：",-1)),((0,i.uX)(),(0,i.CE)(i.FK,null,(0,i.pI)(b,e=>(0,i.bF)(k,{key:e,class:"example-tag",size:"small",onClick:t=>o.value=e},{default:(0,i.k6)(()=>[(0,i.eW)((0,s.v_)(e),1)]),_:2},1032,["onClick"])),64))]),(0,i.Lk)("div",O,[(0,i.bF)(d,{type:"primary",loading:l.value,onClick:I},{default:(0,i.k6)(()=>[(0,i.bF)(u,null,{default:(0,i.k6)(()=>[(0,i.bF)((0,r.R1)(p.Search))]),_:1}),t[4]||(t[4]=(0,i.eW)(" 智能推荐 ",-1))]),_:1},8,["loading"]),(0,i.bF)(d,{onClick:A},{default:(0,i.k6)(()=>[...t[5]||(t[5]=[(0,i.eW)("清空",-1)])]),_:1})])]),c.value?.recommendationReason?((0,i.uX)(),(0,i.CE)("div",Q,[t[6]||(t[6]=(0,i.Lk)("h4",null,"推荐理由",-1)),(0,i.Lk)("div",{class:"reason-content",innerHTML:W(c.value.recommendationReason)},null,8,D)])):(0,i.Q3)("",!0),l.value&&!c.value?((0,i.uX)(),(0,i.CE)("div",T,[(0,i.bF)(R,{rows:3,animated:""}),t[7]||(t[7]=(0,i.Lk)("p",{class:"loading-text"},"AI正在分析您的需求...",-1))])):(0,i.Q3)("",!0),c.value&&c.value.wikiContents&&c.value.wikiContents.length>0?((0,i.uX)(),(0,i.CE)("div",M,[t[8]||(t[8]=(0,i.Lk)("h4",null,"推荐Wiki内容",-1)),(0,i.Lk)("div",H,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(c.value.wikiContents,e=>((0,i.uX)(),(0,i.CE)("div",{key:e.id,class:"wiki-item",onClick:t=>P(e)},[(0,i.Lk)("div",Y,[(0,i.Lk)("h5",null,(0,s.v_)(e.title),1),e.summary?((0,i.uX)(),(0,i.CE)("p",J,(0,s.v_)(e.summary),1)):(0,i.Q3)("",!0),e.similarity?((0,i.uX)(),(0,i.CE)("div",Z," 相似度: "+(0,s.v_)((100*e.similarity).toFixed(1))+"% ",1)):(0,i.Q3)("",!0)])],8,G))),128))])])):c.value&&c.value.beverages&&c.value.beverages.length>0?((0,i.uX)(),(0,i.CE)("div",ee,[t[9]||(t[9]=(0,i.Lk)("h4",null,"推荐结果",-1)),(0,i.Lk)("div",te,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(c.value.beverages,e=>((0,i.uX)(),(0,i.CE)("div",{key:e.id,class:"beverage-item",onClick:t=>X(e.id)},[e.coverImageId?((0,i.uX)(),(0,i.CE)("div",ae,[(0,i.Lk)("img",{src:S(e.coverImageId),alt:e.name},null,8,ie)])):((0,i.uX)(),(0,i.CE)("div",oe,[(0,i.bF)(u,null,{default:(0,i.k6)(()=>[(0,i.bF)((0,r.R1)(p.Picture))]),_:1})])),(0,i.Lk)("div",le,[(0,i.Lk)("h5",null,(0,s.v_)(e.name),1),(0,i.Lk)("p",se,(0,s.v_)(e.type),1),e.origin?((0,i.uX)(),(0,i.CE)("p",re,(0,s.v_)(e.origin),1)):(0,i.Q3)("",!0),e.rating?((0,i.uX)(),(0,i.CE)("div",ue,[(0,i.bF)(_,{"model-value":e.rating,disabled:"","show-score":"","text-color":"#ff9900","score-template":"{value}"},null,8,["model-value"])])):(0,i.Q3)("",!0)])],8,ne))),128))])])):!c.value||c.value.recommendationReason||c.value.beverages&&0!==c.value.beverages.length||c.value.wikiContents&&0!==c.value.wikiContents.length?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("div",ce,[(0,i.bF)(F,{description:"没有找到匹配的内容","image-size":80})]))]))]))],2)],4)):(0,i.Q3)("",!0)])}}};const be=(0,f.A)(ke,[["__scopeId","data-v-d774821e"]]);var ye=be,we={name:"App",components:{Header:P,Footer:q,RAGFloatingWindow:ye}};const Ce=(0,f.A)(we,[["render",l]]);var Le=Ce,Re=n(5129);const _e=[{path:"/",name:"Home",component:()=>Promise.all([n.e(504),n.e(72)]).then(n.bind(n,3072))},{path:"/feed",name:"Feed",component:()=>Promise.all([n.e(504),n.e(747)]).then(n.bind(n,747)),meta:{requiresAuth:!0}},{path:"/nearby",name:"Nearby",component:()=>Promise.all([n.e(504),n.e(857)]).then(n.bind(n,5857))},{path:"/ranking",name:"Ranking",component:()=>Promise.all([n.e(504),n.e(77)]).then(n.bind(n,77)),meta:{title:"热门排行"}},{path:"/beverages",name:"BeverageList",component:()=>n.e(423).then(n.bind(n,4423))},{path:"/beverages/:id",name:"BeverageDetail",component:()=>n.e(508).then(n.bind(n,4508))},{path:"/bars",name:"BarList",component:()=>Promise.all([n.e(504),n.e(99)]).then(n.bind(n,6480))},{path:"/bars/register",name:"BarRegister",component:()=>n.e(62).then(n.bind(n,7062)),meta:{requiresAuth:!0}},{path:"/bars/:id",name:"BarDetail",component:()=>n.e(545).then(n.bind(n,545))},{path:"/announcements",name:"AnnouncementList",component:()=>n.e(953).then(n.bind(n,5953))},{path:"/wiki",name:"WikiList",component:()=>Promise.all([n.e(504),n.e(493)]).then(n.bind(n,9493))},{path:"/wiki/edit/:id?",name:"WikiEditor",component:()=>Promise.all([n.e(504),n.e(660)]).then(n.bind(n,9660)),meta:{requiresAuth:!0}},{path:"/wiki/:slug",name:"WikiDetail",component:()=>Promise.all([n.e(504),n.e(357)]).then(n.bind(n,2357))},{path:"/posts/:id",name:"PostDetail",component:()=>Promise.all([n.e(504),n.e(215)]).then(n.bind(n,2215))},{path:"/search",name:"Search",component:()=>n.e(209).then(n.bind(n,5209))},{path:"/messages",name:"Messages",component:()=>n.e(529).then(n.bind(n,4529)),meta:{requiresAuth:!0}},{path:"/login",name:"Login",component:()=>n.e(448).then(n.bind(n,6448))},{path:"/register",name:"Register",component:()=>n.e(961).then(n.bind(n,8961))},{path:"/user/profile",name:"UserProfile",component:()=>n.e(79).then(n.bind(n,5079)),meta:{requiresAuth:!0}},{path:"/user/settings",name:"UserSettings",component:()=>n.e(889).then(n.bind(n,1889)),meta:{requiresAuth:!0}},{path:"/users/:id",name:"UserHome",component:()=>n.e(598).then(n.bind(n,2598))},{path:"/admin/moderation",name:"AdminModeration",component:()=>n.e(882).then(n.bind(n,5882)),meta:{requiresAuth:!0,requiresAdmin:!0}},{path:"/seller/activity",name:"SellerActivity",component:()=>n.e(852).then(n.bind(n,3852)),meta:{requiresAuth:!0,requiresSeller:!0}},{path:"/admin/management",name:"AdminManagement",redirect:"/seller/activity",meta:{requiresAuth:!0,requiresSeller:!0}},{path:"/activities",name:"ActivityList",component:()=>n.e(379).then(n.bind(n,379)),meta:{requiresAuth:!0}},{path:"/activities/create",name:"CreateActivity",component:()=>n.e(661).then(n.bind(n,8661)),meta:{requiresAuth:!0,requiresSeller:!0}},{path:"/activities/:id",name:"ActivityDetail",component:()=>n.e(481).then(n.bind(n,2481))},{path:"/admin/activities/review",name:"ActivityReview",component:()=>n.e(379).then(n.bind(n,379)),meta:{requiresAuth:!0,requiresAdmin:!0}}],Fe=(0,u.aE)({history:(0,u.LA)("/"),routes:_e});Fe.onError(e=>{const t=/Loading chunk (\d)+ failed/g,n=e.message&&e.message.match(t);if(n){const e=Fe.currentRoute.value?.fullPath||window.location.pathname;e&&"/login"!==e&&(window.location.href=e)}}),Fe.beforeEach(async(e,t,n)=>{const a=(0,c.k)(Re.A);if(!a.initialized&&!a.loading)if(a.userInfo&&a.userInfo.id)a.initialized=!0;else try{await a.fetchUserInfo()}catch(i){401===i?.response?.status||(console.log("获取用户信息失败（非401），保留现有状态:",i),a.userInfo&&(a.initialized=!0))}if(a.loading){let e=0;while(a.loading&&e<40)await new Promise(e=>setTimeout(e,50)),e++}if(e.meta.requiresAuth){if(a.isLoggedIn)return e.meta.requiresAdmin&&!a.isAdmin?(d.nk.warning("需要管理员权限"),void n("/")):e.meta.requiresSeller&&!a.isSeller?(d.nk.warning("需要商家权限"),void n("/")):void n();if("/login"===e.path)return void n();n({path:"/login",query:{redirect:e.fullPath}})}else n()});var Ie=Fe,Ae=n(6444);n(4188);const Ee=(0,a.Ef)(Le);for(const[xe,Xe]of Object.entries(p))Ee.component(xe,Xe);Ee.use(Ie),Ee.use(Re.A),Ee.use(Ae.A),Ee.mount("#app")},2636:function(e,t,n){n.d(t,{HW:function(){return l},iD:function(){return i},kz:function(){return o},ri:function(){return s}});var a=n(7277);const i=e=>(0,a.A)({url:"/auth/login",method:"post",data:e}),o=e=>(0,a.A)({url:"/auth/register",method:"post",data:e}),l=()=>(0,a.A)({url:"/auth/me",method:"get"}),s=()=>(0,a.A)({url:"/auth/logout",method:"post"})},3945:function(e,t,n){n.d(t,{m:function(){return s}});n(8111),n(116),n(1701);var a=n(953);const i=(0,a.KR)(null);let o=null;const l=(e="")=>e.trim().replace(/(市|地区|特别行政区|自治州|回族自治区|维吾尔自治区|壮族自治区|自治区|省|盟)$/u,"").toLowerCase(),s=()=>{const e=(0,a.KR)([]),t=(0,a.KR)(!1),n=async()=>{if(i.value)return e.value=i.value,i.value;o||(t.value=!0,o=fetch("/cities.json").then(e=>e.json()).then(t=>{const n=(t?.provinces||[]).map(e=>({label:e.provinceName,value:e.provinceName,cities:(e.citys||[]).map(e=>({label:e.cityName,value:e.cityName}))}));return i.value=n,e.value=n,n}).catch(e=>(console.error("加载城市列表失败",e),[])).finally(()=>{t.value=!1}));const n=await o;return e.value=n,n},s=(e="")=>{if(!e||!i.value)return null;const t=l(e);for(const n of i.value){if(l(n.value)===t)return{province:n.value,city:n.value};const e=n.cities.find(e=>l(e.value)===t);if(e)return{province:n.value,city:e.value}}return null},r=()=>{if(!i.value||0===i.value.length)return"";const e=i.value[0];return e.cities?.[0]?.value||e.value};return{provinces:e,loading:t,ensureLoaded:n,findCityByName:s,getDefaultCity:r}}},4402:function(e,t,n){n.d(t,{x:function(){return i}});var a=n(7277);const i={listPosts:(e=1,t=12)=>(0,a.A)({url:"/circle/posts",method:"get",params:{page:e,pageSize:t}}),listFeed:(e=1,t=12)=>(0,a.A)({url:"/circle/feed",method:"get",params:{page:e,pageSize:t}}),listUserPosts:(e,t=1,n=10)=>(0,a.A)({url:`/circle/users/${e}/posts`,method:"get",params:{page:t,pageSize:n}}),createPost:e=>(0,a.A)({url:"/circle/posts",method:"post",data:e}),listPostsByCity:(e,t=1,n=12)=>(0,a.A)({url:"/circle/nearby",method:"get",params:{city:e,page:t,pageSize:n}}),getPost:e=>(0,a.A)({url:`/circle/posts/${e}`,method:"get"}),likePost:e=>(0,a.A)({url:`/circle/posts/${e}/like`,method:"post"}),favoritePost:e=>(0,a.A)({url:`/circle/posts/${e}/favorite`,method:"post"}),getComments:e=>(0,a.A)({url:`/circle/posts/${e}/comments`,method:"get"}),createComment:(e,t)=>(0,a.A)({url:`/circle/posts/${e}/comments`,method:"post",data:t}),deletePost:e=>(0,a.A)({url:`/circle/posts/${e}`,method:"delete"}),deleteComment:e=>(0,a.A)({url:`/circle/comments/${e}`,method:"delete"}),getHotPosts:(e="WEEK",t=1,n=12)=>(0,a.A)({url:"/ranking/hot",method:"get",params:{timeDimension:e,page:t,pageSize:n}})}},5129:function(e,t,n){var a=n(810);const i=(0,a.Ey)();t.A=i},5394:function(e,t,n){n.d(t,{A:function(){return I}});n(4114),n(8111),n(2489);var a=n(641),i=n(33),o=n(953),l=n(6400),s=n(4402),r=n(163),u=n(8548),c=n(3945),d=n(5467);const m={class:"composer-main"},v={class:"composer-avatar"},p={class:"composer-body"},g={class:"composer-fields"},h={class:"location-field"},f={class:"composer-upload"},k={key:1,class:"inline-upload"},b={key:0,class:"inline-preview"},y=["src","alt"],w={class:"composer-footer"},C={class:"meta"},L={key:0};var R={__name:"ShareComposer",props:{mode:{type:String,default:"inline"}},emits:["submitted"],setup(e,{expose:t,emit:n}){const R=n,_=(0,l.k)(),F=(0,o.KR)(!1),I=(0,o.KR)([]),A=(0,o.KR)([]),E=(0,o.KR)(null),x=(0,o.Kh)({content:"",tags:[],location:"",imageIds:[]}),X=(0,o.KR)(""),{provinces:P,loading:S,ensureLoaded:W,findCityByName:K}=(0,c.m)(),{detecting:z,detectCity:q}=(0,d.K)(),$=e=>{const t=e.type.startsWith("image/"),n=e.size/1024/1024<5;return t?!!n||(r.nk.error("图片大小不能超过 5MB"),!1):(r.nk.error("只能上传图片文件"),!1)},V=(e,t,n)=>{200===e.code&&e.data?.id?(x.imageIds.push(e.data.id),I.value=n):r.nk.error("上传失败，请重试")},U=(e,t)=>{const n=e.response?.data?.id;n&&(x.imageIds=x.imageIds.filter(e=>e!==n)),I.value=t},j=()=>{r.nk.error("图片上传失败")},N=()=>{E.value?.click()},B=async e=>{const t=Array.from(e.target.files||[]);for(const a of t){if(!$(a))continue;const e=new FormData;e.append("file",a);try{const t=await fetch("/api/files/upload?category=POST",{method:"POST",body:e,credentials:"include"}).then(e=>e.json());200===t.code&&t.data?.id?(x.imageIds.push(t.data.id),A.value.push({uid:`${Date.now()}-${Math.random()}`,url:t.data.url})):r.nk.error(t.message||"上传失败")}catch(n){r.nk.error("上传失败")}}E.value&&(E.value.value="")},O=e=>{const t=A.value.findIndex(t=>t.uid===e);t>-1&&(A.value.splice(t,1),x.imageIds.splice(t,1))},Q=e=>{X.value=e||"",x.location=e||""},D=async e=>{if(!e)return void Q("");await W();const t=K(e);Q(t?.city||e)},T=e=>{x.location=e||""},M=async(e=!1)=>{await W();const t=await q();if(!t)return void(e&&r.nk.warning("无法自动定位，请手动选择"));const n=K(t);if(n?.city)return Q(n.city),void(e&&r.nk.success(`已定位到 ${n.city}`));e&&r.nk.warning("未找到匹配城市，请手动选择")},H=async()=>{if(x.content.trim()){F.value=!0;try{await s.x.createPost({content:x.content,location:x.location,imageIds:x.imageIds,tags:x.tags}),r.nk.success("发布成功"),R("submitted"),G()}catch(e){r.nk.error(e.message||"发布失败")}finally{F.value=!1}}else r.nk.warning("请输入分享内容")},G=()=>{x.content="",x.tags=[],x.location="",x.imageIds=[],I.value=[],A.value=[],X.value=""},Y=(e={})=>{x.content=e.content||"",x.tags=e.tags?[...e.tags]:[],x.location=e.location||"",x.imageIds=e.imageIds?[...e.imageIds]:[],D(x.location)},J=(0,a.EW)(()=>!!(x.content.trim()||x.tags.length||x.location||x.imageIds.length)),Z=()=>({content:x.content,tags:x.tags,location:x.location,imageIds:x.imageIds});return(0,a.sV)(async()=>{await W(),x.location?await D(x.location):await M(!1)}),t({resetForm:G,fillForm:Y,hasUnsaved:J,getSnapshot:Z}),(t,n)=>{const l=(0,a.g2)("el-avatar"),s=(0,a.g2)("el-input"),r=(0,a.g2)("el-select"),c=(0,a.g2)("el-option"),d=(0,a.g2)("el-option-group"),R=(0,a.g2)("el-button"),W=(0,a.g2)("el-icon"),K=(0,a.g2)("el-upload");return(0,a.uX)(),(0,a.CE)("div",{class:(0,i.C4)(["share-composer",e.mode])},[(0,a.Lk)("div",m,[(0,a.Lk)("div",v,[(0,a.bF)(l,{src:(0,o.R1)(_).userInfo?.avatarUrl,size:48,alt:`${(0,o.R1)(_).userInfo?.username||"用户"}的头像`},null,8,["src","alt"])]),(0,a.Lk)("div",p,[(0,a.bF)(s,{modelValue:x.content,"onUpdate:modelValue":n[0]||(n[0]=e=>x.content=e),type:"textarea",rows:"modal"===e.mode?6:3,maxlength:"2000","show-word-limit":"",resize:"none",placeholder:"分享此刻，聊聊你正在喝的、看到的、想到的一切..."},null,8,["modelValue","rows"]),(0,a.Lk)("div",g,[(0,a.bF)(r,{modelValue:x.tags,"onUpdate:modelValue":n[1]||(n[1]=e=>x.tags=e),multiple:"",filterable:"","allow-create":"","default-first-option":"","collapse-tags":"","multiple-limit":5,placeholder:"添加话题标签，如 上海、精酿、金酒"},null,8,["modelValue"]),(0,a.Lk)("div",h,[(0,a.bF)(r,{modelValue:X.value,"onUpdate:modelValue":n[2]||(n[2]=e=>X.value=e),filterable:"",clearable:"",loading:(0,o.R1)(S),placeholder:(0,o.R1)(S)?"地区加载中…":"选择地点（可选）",onChange:T},{default:(0,a.k6)(()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)((0,o.R1)(P),e=>((0,a.uX)(),(0,a.Wv)(d,{key:e.value,label:e.label},{default:(0,a.k6)(()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.cities,e=>((0,a.uX)(),(0,a.Wv)(c,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue","loading","placeholder"]),(0,a.bF)(R,{class:"locate-btn",text:"",size:"small",loading:(0,o.R1)(z),onClick:n[3]||(n[3]=e=>M(!0))},{default:(0,a.k6)(()=>[(0,a.eW)((0,i.v_)((0,o.R1)(z)?"定位中…":"自动定位"),1)]),_:1},8,["loading"])])]),(0,a.Lk)("div",f,["modal"===e.mode?((0,a.uX)(),(0,a.Wv)(K,{key:0,"file-list":I.value,"onUpdate:fileList":n[4]||(n[4]=e=>I.value=e),"list-type":"picture-card",action:"/api/files/upload?category=POST",multiple:"","on-success":V,"on-remove":U,"before-upload":$,"on-error":j,accept:"image/*"},{default:(0,a.k6)(()=>[(0,a.bF)(W,null,{default:(0,a.k6)(()=>[(0,a.bF)((0,o.R1)(u.Plus))]),_:1})]),_:1},8,["file-list"])):((0,a.uX)(),(0,a.CE)("div",k,[(0,a.Lk)("button",{type:"button",class:"inline-plus","aria-label":"添加图片",title:"添加图片",onClick:N},[(0,a.bF)(W,null,{default:(0,a.k6)(()=>[(0,a.bF)((0,o.R1)(u.Plus))]),_:1})]),(0,a.Lk)("input",{ref_key:"inlineInputRef",ref:E,type:"file",accept:"image/*",multiple:"",class:"hidden-input",onChange:B},null,544),A.value.length?((0,a.uX)(),(0,a.CE)("div",b,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(A.value,(e,t)=>((0,a.uX)(),(0,a.CE)("div",{key:e.uid,class:"thumb"},[(0,a.Lk)("img",{src:e.url,alt:`已选择的图片${t+1}`},null,8,y),(0,a.bF)(W,{class:"remove",onClick:t=>O(e.uid)},{default:(0,a.k6)(()=>[(0,a.bF)((0,o.R1)(u.Close))]),_:1},8,["onClick"])]))),128))])):(0,a.Q3)("",!0)])),n[5]||(n[5]=(0,a.Lk)("p",{class:"hint"},"可上传 5 张以内图片，单张不超过 5MB",-1))]),(0,a.Lk)("div",w,[(0,a.Lk)("div",C,[(0,a.Lk)("span",null,"已添加 "+(0,i.v_)(x.tags.length)+" 个标签",1),x.imageIds.length?((0,a.uX)(),(0,a.CE)("span",L,"图片 "+(0,i.v_)(x.imageIds.length)+" 张",1)):(0,a.Q3)("",!0)]),(0,a.bF)(R,{type:"primary",size:"small",loading:F.value,onClick:H},{default:(0,a.k6)(()=>[...n[6]||(n[6]=[(0,a.eW)(" 立即发布 ",-1)])]),_:1},8,["loading"])])])])],2)}}},_=n(6262);const F=(0,_.A)(R,[["__scopeId","data-v-01ddcbe4"]]);var I=F},5467:function(e,t,n){n.d(t,{K:function(){return l}});var a=n(953);let i="",o=null;const l=()=>{const e=(0,a.KR)(!1),t=(0,a.KR)(i),n=async()=>i?(t.value=i,i):o||(e.value=!0,o=fetch("https://api.vore.top/api/IPdata?ip=").then(e=>e.json()).then(e=>{const n=e?.ipdata?.info1||e?.adcode?.c||e?.ipdata?.info2||"";return i=(n||"").replace(/\s+/g,""),t.value=i,i}).catch(e=>(console.error("自动定位失败",e),"")).finally(()=>{e.value=!1,o=null}),o);return{detecting:e,detectedCity:t,detectCity:n}}},6400:function(e,t,n){n.d(t,{k:function(){return o}});var a=n(810),i=n(2636);const o=(0,a.nY)("user",{state:()=>({userInfo:null,loading:!1,initialized:!1}),getters:{isLoggedIn:e=>!!e.userInfo?.id,isAdmin:e=>"ADMIN"===e.userInfo?.role,isSeller:e=>"SELLER"===e.userInfo?.role},actions:{setUserInfo(e){this.userInfo=e,this.initialized=!0},async fetchUserInfo(){if(this.userInfo&&this.userInfo.id)this.initialized=!0;else{if(this.loading){while(this.loading)await new Promise(e=>setTimeout(e,50));if(this.userInfo&&this.userInfo.id)return void(this.initialized=!0)}this.loading=!0;try{const e=await(0,i.HW)();this.userInfo=e.data,this.initialized=!0}catch(e){return 401===e?.response?.status?(this.userInfo=null,this.initialized=!0):(console.log("获取用户信息失败（非401），保留现有状态:",e),this.userInfo&&console.log("保留现有用户信息，不因网络错误而清空")),Promise.reject(e)}finally{this.loading=!1}}},async logout(){await(0,i.ri)(),this.userInfo=null,this.initialized=!0}}})},7277:function(e,t,n){var a=n(4335),i=n(163),o=n(5129),l=n(6400);const s=a.A.create({baseURL:"/api",timeout:3e4,withCredentials:!0}),r=3,u=1e3,c=2,d=e=>"ECONNREFUSED"===e.code||e.message?.includes("ECONNREFUSED")||e.message?.includes("Network Error")||void 0===e.response&&void 0!==e.request,m=e=>{const t=e?.url||"",n=["/auth/me","/recommend/posts","/circle/posts","/daily-question/today"];return n.some(e=>t.includes(e))};s.interceptors.request.use(e=>(e.__retryCount||(e.__retryCount=0),e),e=>Promise.reject(e)),s.interceptors.response.use(e=>{const t=e.data;return 200!==t.code?(i.nk.error(t.message||"请求失败"),Promise.reject(new Error(t.message||"Error"))):t},async e=>{const t=e.config||{};if(d(e)&&t.__retryCount<r){t.__retryCount=t.__retryCount||0,t.__retryCount+=1;const e=u*Math.pow(c,t.__retryCount-1);return m(t)?(await new Promise(t=>setTimeout(t,e)),s(t)):(console.log(`请求失败，${e}ms后重试 (${t.__retryCount}/${r}):`,t.url),await new Promise(t=>setTimeout(t,e)),s(t))}if(e.response){const{status:t,config:n,data:a}=e.response,s=n?.url||"",r=s.includes("/auth/me"),u=["/login","/register"].some(e=>window.location.pathname.startsWith(e)),c=["/auth/login","/auth/register"].some(e=>s.includes(e)),v=a?.message;switch(t){case 400:return i.nk.error(v||"请求参数错误"),Promise.reject(e);case 401:if(r){const e=(0,l.k)(o.A);e.userInfo;e.userInfo=null,e.initialized=!0;break}if(c)break;if(u)break;i.nk.error(v||"没有权限访问此资源");break;case 403:i.nk.error(v||"没有访问权限");break;case 404:i.nk.error(v||"请求的资源不存在");break;default:d(e)?m(n)||i.nk.error("无法连接到服务器，请检查后端服务是否已启动"):i.nk.error(v||e.message||"请求失败")}}else d(e)&&t.__retryCount>=r?m(t)||i.nk.error("无法连接到服务器，请检查后端服务是否已启动"):d(e)||i.nk.error("网络错误，请稍后再试");return Promise.reject(e)}),t.A=s},9686:function(e,t,n){n.d(t,{L:function(){return i}});var a=n(7277);const i={getRecommendedPosts:(e=1,t=10)=>(0,a.A)({url:"/recommend/posts",method:"get",params:{page:e,size:t}}),getRecommendedUsers:(e=10)=>(0,a.A)({url:"/recommend/users",method:"get",params:{size:e}}),getRecommendedBars:(e=1,t=10)=>(0,a.A)({url:"/recommend/bars",method:"get",params:{page:e,size:t}}),getRecommendedBeverages:(e=1,t=10)=>(0,a.A)({url:"/recommend/beverages",method:"get",params:{page:e,size:t}}),getSimilarPosts:(e,t=5)=>(0,a.A)({url:`/recommend/similar-posts/${e}`,method:"get",params:{size:t}}),ragRecommendBeveragesWithHistory:e=>(0,a.A)({url:"/recommend/beverages/rag",method:"post",data:e})}}},t={};function n(a){var i=t[a];if(void 0!==i)return i.exports;var o=t[a]={exports:{}};return e[a].call(o.exports,o,o.exports,n),o.exports}n.m=e,function(){var e=[];n.O=function(t,a,i,o){if(!a){var l=1/0;for(c=0;c<e.length;c++){a=e[c][0],i=e[c][1],o=e[c][2];for(var s=!0,r=0;r<a.length;r++)(!1&o||l>=o)&&Object.keys(n.O).every(function(e){return n.O[e](a[r])})?a.splice(r--,1):(s=!1,o<l&&(l=o));if(s){e.splice(c--,1);var u=i();void 0!==u&&(t=u)}}return t}o=o||0;for(var c=e.length;c>0&&e[c-1][2]>o;c--)e[c]=e[c-1];e[c]=[a,i,o]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){n.f={},n.e=function(e){return Promise.all(Object.keys(n.f).reduce(function(t,a){return n.f[a](e,t),t},[]))}}(),function(){n.u=function(e){return"js/"+e+"."+{62:"967d48a9",72:"467ecb3f",77:"fabff78e",79:"484da575",99:"2e1e00ee",209:"8fe80946",215:"5f829307",357:"287bfe03",379:"1d4da5f8",423:"880b109e",448:"940a591f",481:"80c13581",493:"4caa633a",508:"369558ee",529:"687fb907",545:"615a8ab5",598:"48a458e7",660:"a3173fd6",661:"8558f0e8",747:"826ca2db",852:"b4d4d30c",857:"238fbb21",882:"46325840",889:"03e8acfa",953:"f2338462",961:"39519383"}[e]+".js"}}(),function(){n.miniCssF=function(e){return"css/"+e+"."+{62:"0702b1be",72:"a8a3e300",77:"de55bd90",79:"cd578793",99:"9dbec6b8",209:"faf4d9f2",215:"058e7250",357:"b72e25c8",379:"79902278",423:"97895b15",448:"a812670a",481:"fad25851",493:"d122cfb1",508:"45abe418",529:"403807fa",545:"394355ec",598:"a9a046df",660:"67213bc4",661:"e17b2dc0",747:"ab0a420e",852:"e57a2a5d",857:"e5a0ac62",882:"39421062",889:"d90c4199",953:"f22993bd",961:"a4b1f1f1"}[e]+".css"}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="Chunyin:";n.l=function(a,i,o,l){if(e[a])e[a].push(i);else{var s,r;if(void 0!==o)for(var u=document.getElementsByTagName("script"),c=0;c<u.length;c++){var d=u[c];if(d.getAttribute("src")==a||d.getAttribute("data-webpack")==t+o){s=d;break}}s||(r=!0,s=document.createElement("script"),s.charset="utf-8",n.nc&&s.setAttribute("nonce",n.nc),s.setAttribute("data-webpack",t+o),s.src=a),e[a]=[i];var m=function(t,n){s.onerror=s.onload=null,clearTimeout(v);var i=e[a];if(delete e[a],s.parentNode&&s.parentNode.removeChild(s),i&&i.forEach(function(e){return e(n)}),t)return t(n)},v=setTimeout(m.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=m.bind(null,s.onerror),s.onload=m.bind(null,s.onload),r&&document.head.appendChild(s)}}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){n.p="/"}(),function(){if("undefined"!==typeof document){var e=function(e,t,a,i,o){var l=document.createElement("link");l.rel="stylesheet",l.type="text/css",n.nc&&(l.nonce=n.nc);var s=function(n){if(l.onerror=l.onload=null,"load"===n.type)i();else{var a=n&&n.type,s=n&&n.target&&n.target.href||t,r=new Error("Loading CSS chunk "+e+" failed.\n("+a+": "+s+")");r.name="ChunkLoadError",r.code="CSS_CHUNK_LOAD_FAILED",r.type=a,r.request=s,l.parentNode&&l.parentNode.removeChild(l),o(r)}};return l.onerror=l.onload=s,l.href=t,a?a.parentNode.insertBefore(l,a.nextSibling):document.head.appendChild(l),l},t=function(e,t){for(var n=document.getElementsByTagName("link"),a=0;a<n.length;a++){var i=n[a],o=i.getAttribute("data-href")||i.getAttribute("href");if("stylesheet"===i.rel&&(o===e||o===t))return i}var l=document.getElementsByTagName("style");for(a=0;a<l.length;a++){i=l[a],o=i.getAttribute("data-href");if(o===e||o===t)return i}},a=function(a){return new Promise(function(i,o){var l=n.miniCssF(a),s=n.p+l;if(t(l,s))return i();e(a,s,null,i,o)})},i={524:0};n.f.miniCss=function(e,t){var n={62:1,72:1,77:1,79:1,99:1,209:1,215:1,357:1,379:1,423:1,448:1,481:1,493:1,508:1,529:1,545:1,598:1,660:1,661:1,747:1,852:1,857:1,882:1,889:1,953:1,961:1};i[e]?t.push(i[e]):0!==i[e]&&n[e]&&t.push(i[e]=a(e).then(function(){i[e]=0},function(t){throw delete i[e],t}))}}}(),function(){var e={524:0};n.f.j=function(t,a){var i=n.o(e,t)?e[t]:void 0;if(0!==i)if(i)a.push(i[2]);else{var o=new Promise(function(n,a){i=e[t]=[n,a]});a.push(i[2]=o);var l=n.p+n.u(t),s=new Error,r=function(a){if(n.o(e,t)&&(i=e[t],0!==i&&(e[t]=void 0),i)){var o=a&&("load"===a.type?"missing":a.type),l=a&&a.target&&a.target.src;s.message="Loading chunk "+t+" failed.\n("+o+": "+l+")",s.name="ChunkLoadError",s.type=o,s.request=l,i[1](s)}};n.l(l,r,"chunk-"+t,t)}},n.O.j=function(t){return 0===e[t]};var t=function(t,a){var i,o,l=a[0],s=a[1],r=a[2],u=0;if(l.some(function(t){return 0!==e[t]})){for(i in s)n.o(s,i)&&(n.m[i]=s[i]);if(r)var c=r(n)}for(t&&t(a);u<l.length;u++)o=l[u],n.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return n.O(c)},a=self["webpackChunkChunyin"]=self["webpackChunkChunyin"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=n.O(void 0,[504],function(){return n(1072)});a=n.O(a)})();
//# sourceMappingURL=app.98d1b63e.js.map