(function(){"use strict";var e={2636:function(e,t,n){n.d(t,{HW:function(){return i},iD:function(){return o},kz:function(){return r},ri:function(){return l}});var a=n(7277);const o=e=>(0,a.A)({url:"/auth/login",method:"post",data:e}),r=e=>(0,a.A)({url:"/auth/register",method:"post",data:e}),i=()=>(0,a.A)({url:"/auth/me",method:"get"}),l=()=>(0,a.A)({url:"/auth/logout",method:"post"})},3945:function(e,t,n){n.d(t,{m:function(){return l}});n(8111),n(116),n(1701);var a=n(953);const o=(0,a.KR)(null);let r=null;const i=(e="")=>e.trim().replace(/(市|地区|特别行政区|自治州|回族自治区|维吾尔自治区|壮族自治区|自治区|省|盟)$/u,"").toLowerCase(),l=()=>{const e=(0,a.KR)([]),t=(0,a.KR)(!1),n=async()=>{if(o.value)return e.value=o.value,o.value;r||(t.value=!0,r=fetch("/cities.json").then(e=>e.json()).then(t=>{const n=(t?.provinces||[]).map(e=>({label:e.provinceName,value:e.provinceName,cities:(e.citys||[]).map(e=>({label:e.cityName,value:e.cityName}))}));return o.value=n,e.value=n,n}).catch(e=>(console.error("加载城市列表失败",e),[])).finally(()=>{t.value=!1}));const n=await r;return e.value=n,n},l=(e="")=>{if(!e||!o.value)return null;const t=i(e);for(const n of o.value){if(i(n.value)===t)return{province:n.value,city:n.value};const e=n.cities.find(e=>i(e.value)===t);if(e)return{province:n.value,city:e.value}}return null},s=()=>{if(!o.value||0===o.value.length)return"";const e=o.value[0];return e.cities?.[0]?.value||e.value};return{provinces:e,loading:t,ensureLoaded:n,findCityByName:l,getDefaultCity:s}}},4402:function(e,t,n){n.d(t,{x:function(){return o}});var a=n(7277);const o={listPosts:(e=1,t=12)=>(0,a.A)({url:"/circle/posts",method:"get",params:{page:e,pageSize:t}}),listFeed:(e=1,t=12)=>(0,a.A)({url:"/circle/feed",method:"get",params:{page:e,pageSize:t}}),listUserPosts:(e,t=1,n=10)=>(0,a.A)({url:`/circle/users/${e}/posts`,method:"get",params:{page:t,pageSize:n}}),createPost:e=>(0,a.A)({url:"/circle/posts",method:"post",data:e}),listPostsByCity:(e,t=1,n=12)=>(0,a.A)({url:"/circle/nearby",method:"get",params:{city:e,page:t,pageSize:n}}),getPost:e=>(0,a.A)({url:`/circle/posts/${e}`,method:"get"}),likePost:e=>(0,a.A)({url:`/circle/posts/${e}/like`,method:"post"}),favoritePost:e=>(0,a.A)({url:`/circle/posts/${e}/favorite`,method:"post"}),getComments:e=>(0,a.A)({url:`/circle/posts/${e}/comments`,method:"get"}),createComment:(e,t)=>(0,a.A)({url:`/circle/posts/${e}/comments`,method:"post",data:t}),deletePost:e=>(0,a.A)({url:`/circle/posts/${e}`,method:"delete"}),deleteComment:e=>(0,a.A)({url:`/circle/comments/${e}`,method:"delete"}),getHotPosts:(e="WEEK",t=1,n=12)=>(0,a.A)({url:"/ranking/hot",method:"get",params:{timeDimension:e,page:t,pageSize:n}})}},5394:function(e,t,n){n.d(t,{A:function(){return I}});n(4114),n(8111),n(2489);var a=n(641),o=n(33),r=n(953),i=n(6400),l=n(4402),s=n(163),u=n(8548),c=n(3945),d=n(5467);const p={class:"composer-main"},m={class:"composer-avatar"},f={class:"composer-body"},h={class:"composer-fields"},g={class:"location-field"},v={class:"composer-upload"},b={key:1,class:"inline-upload"},k={key:0,class:"inline-preview"},y=["src","alt"],C={class:"composer-footer"},w={class:"meta"},F={key:0};var L={__name:"ShareComposer",props:{mode:{type:String,default:"inline"}},emits:["submitted"],setup(e,{expose:t,emit:n}){const L=n,A=(0,i.k)(),_=(0,r.KR)(!1),I=(0,r.KR)([]),E=(0,r.KR)([]),R=(0,r.KR)(null),P=(0,r.Kh)({content:"",tags:[],location:"",imageIds:[]}),S=(0,r.KR)(""),{provinces:K,loading:V,ensureLoaded:W,findCityByName:U}=(0,c.m)(),{detecting:j,detectCity:x}=(0,d.K)(),z=e=>{const t=e.type.startsWith("image/"),n=e.size/1024/1024<5;return t?!!n||(s.nk.error("图片大小不能超过 5MB"),!1):(s.nk.error("只能上传图片文件"),!1)},O=(e,t,n)=>{200===e.code&&e.data?.id?(P.imageIds.push(e.data.id),I.value=n):s.nk.error("上传失败，请重试")},X=(e,t)=>{const n=e.response?.data?.id;n&&(P.imageIds=P.imageIds.filter(e=>e!==n)),I.value=t},B=()=>{s.nk.error("图片上传失败")},N=()=>{R.value?.click()},q=async e=>{const t=Array.from(e.target.files||[]);for(const a of t){if(!z(a))continue;const e=new FormData;e.append("file",a);try{const t=await fetch("/api/files/upload?category=POST",{method:"POST",body:e,credentials:"include"}).then(e=>e.json());200===t.code&&t.data?.id?(P.imageIds.push(t.data.id),E.value.push({uid:`${Date.now()}-${Math.random()}`,url:t.data.url})):s.nk.error(t.message||"上传失败")}catch(n){s.nk.error("上传失败")}}R.value&&(R.value.value="")},$=e=>{const t=E.value.findIndex(t=>t.uid===e);t>-1&&(E.value.splice(t,1),P.imageIds.splice(t,1))},T=e=>{S.value=e||"",P.location=e||""},D=async e=>{if(!e)return void T("");await W();const t=U(e);T(t?.city||e)},M=e=>{P.location=e||""},H=async(e=!1)=>{await W();const t=await x();if(!t)return void(e&&s.nk.warning("无法自动定位，请手动选择"));const n=U(t);if(n?.city)return T(n.city),void(e&&s.nk.success(`已定位到 ${n.city}`));e&&s.nk.warning("未找到匹配城市，请手动选择")},Q=async()=>{if(P.content.trim()){_.value=!0;try{await l.x.createPost({content:P.content,location:P.location,imageIds:P.imageIds,tags:P.tags}),s.nk.success("发布成功"),L("submitted"),Y()}catch(e){s.nk.error(e.message||"发布失败")}finally{_.value=!1}}else s.nk.warning("请输入分享内容")},Y=()=>{P.content="",P.tags=[],P.location="",P.imageIds=[],I.value=[],E.value=[],S.value=""},G=(e={})=>{P.content=e.content||"",P.tags=e.tags?[...e.tags]:[],P.location=e.location||"",P.imageIds=e.imageIds?[...e.imageIds]:[],D(P.location)},J=(0,a.EW)(()=>!!(P.content.trim()||P.tags.length||P.location||P.imageIds.length)),Z=()=>({content:P.content,tags:P.tags,location:P.location,imageIds:P.imageIds});return(0,a.sV)(async()=>{await W(),P.location?await D(P.location):await H(!1)}),t({resetForm:Y,fillForm:G,hasUnsaved:J,getSnapshot:Z}),(t,n)=>{const i=(0,a.g2)("el-avatar"),l=(0,a.g2)("el-input"),s=(0,a.g2)("el-select"),c=(0,a.g2)("el-option"),d=(0,a.g2)("el-option-group"),L=(0,a.g2)("el-button"),W=(0,a.g2)("el-icon"),U=(0,a.g2)("el-upload");return(0,a.uX)(),(0,a.CE)("div",{class:(0,o.C4)(["share-composer",e.mode])},[(0,a.Lk)("div",p,[(0,a.Lk)("div",m,[(0,a.bF)(i,{src:(0,r.R1)(A).userInfo?.avatarUrl,size:48,alt:`${(0,r.R1)(A).userInfo?.username||"用户"}的头像`},null,8,["src","alt"])]),(0,a.Lk)("div",f,[(0,a.bF)(l,{modelValue:P.content,"onUpdate:modelValue":n[0]||(n[0]=e=>P.content=e),type:"textarea",rows:"modal"===e.mode?6:3,maxlength:"2000","show-word-limit":"",resize:"none",placeholder:"分享此刻，聊聊你正在喝的、看到的、想到的一切..."},null,8,["modelValue","rows"]),(0,a.Lk)("div",h,[(0,a.bF)(s,{modelValue:P.tags,"onUpdate:modelValue":n[1]||(n[1]=e=>P.tags=e),multiple:"",filterable:"","allow-create":"","default-first-option":"","collapse-tags":"","multiple-limit":5,placeholder:"添加话题标签，如 上海、精酿、金酒"},null,8,["modelValue"]),(0,a.Lk)("div",g,[(0,a.bF)(s,{modelValue:S.value,"onUpdate:modelValue":n[2]||(n[2]=e=>S.value=e),filterable:"",clearable:"",loading:(0,r.R1)(V),placeholder:(0,r.R1)(V)?"地区加载中…":"选择地点（可选）",onChange:M},{default:(0,a.k6)(()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)((0,r.R1)(K),e=>((0,a.uX)(),(0,a.Wv)(d,{key:e.value,label:e.label},{default:(0,a.k6)(()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.cities,e=>((0,a.uX)(),(0,a.Wv)(c,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue","loading","placeholder"]),(0,a.bF)(L,{class:"locate-btn",text:"",size:"small",loading:(0,r.R1)(j),onClick:n[3]||(n[3]=e=>H(!0))},{default:(0,a.k6)(()=>[(0,a.eW)((0,o.v_)((0,r.R1)(j)?"定位中…":"自动定位"),1)]),_:1},8,["loading"])])]),(0,a.Lk)("div",v,["modal"===e.mode?((0,a.uX)(),(0,a.Wv)(U,{key:0,"file-list":I.value,"onUpdate:fileList":n[4]||(n[4]=e=>I.value=e),"list-type":"picture-card",action:"/api/files/upload?category=POST",multiple:"","on-success":O,"on-remove":X,"before-upload":z,"on-error":B,accept:"image/*"},{default:(0,a.k6)(()=>[(0,a.bF)(W,null,{default:(0,a.k6)(()=>[(0,a.bF)((0,r.R1)(u.Plus))]),_:1})]),_:1},8,["file-list"])):((0,a.uX)(),(0,a.CE)("div",b,[(0,a.Lk)("button",{type:"button",class:"inline-plus","aria-label":"添加图片",title:"添加图片",onClick:N},[(0,a.bF)(W,null,{default:(0,a.k6)(()=>[(0,a.bF)((0,r.R1)(u.Plus))]),_:1})]),(0,a.Lk)("input",{ref_key:"inlineInputRef",ref:R,type:"file",accept:"image/*",multiple:"",class:"hidden-input",onChange:q},null,544),E.value.length?((0,a.uX)(),(0,a.CE)("div",k,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(E.value,(e,t)=>((0,a.uX)(),(0,a.CE)("div",{key:e.uid,class:"thumb"},[(0,a.Lk)("img",{src:e.url,alt:`已选择的图片${t+1}`},null,8,y),(0,a.bF)(W,{class:"remove",onClick:t=>$(e.uid)},{default:(0,a.k6)(()=>[(0,a.bF)((0,r.R1)(u.Close))]),_:1},8,["onClick"])]))),128))])):(0,a.Q3)("",!0)])),n[5]||(n[5]=(0,a.Lk)("p",{class:"hint"},"可上传 5 张以内图片，单张不超过 5MB",-1))]),(0,a.Lk)("div",C,[(0,a.Lk)("div",w,[(0,a.Lk)("span",null,"已添加 "+(0,o.v_)(P.tags.length)+" 个标签",1),P.imageIds.length?((0,a.uX)(),(0,a.CE)("span",F,"图片 "+(0,o.v_)(P.imageIds.length)+" 张",1)):(0,a.Q3)("",!0)]),(0,a.bF)(L,{type:"primary",size:"small",loading:_.value,onClick:Q},{default:(0,a.k6)(()=>[...n[6]||(n[6]=[(0,a.eW)(" 立即发布 ",-1)])]),_:1},8,["loading"])])])])],2)}}},A=n(6262);const _=(0,A.A)(L,[["__scopeId","data-v-01ddcbe4"]]);var I=_},5467:function(e,t,n){n.d(t,{K:function(){return i}});var a=n(953);let o="",r=null;const i=()=>{const e=(0,a.KR)(!1),t=(0,a.KR)(o),n=async()=>o?(t.value=o,o):r||(e.value=!0,r=fetch("https://api.vore.top/api/IPdata?ip=").then(e=>e.json()).then(e=>{const n=e?.ipdata?.info1||e?.adcode?.c||e?.ipdata?.info2||"";return o=(n||"").replace(/\s+/g,""),t.value=o,o}).catch(e=>(console.error("自动定位失败",e),"")).finally(()=>{e.value=!1,r=null}),r);return{detecting:e,detectedCity:t,detectCity:n}}},6400:function(e,t,n){n.d(t,{k:function(){return r}});var a=n(810),o=n(2636);const r=(0,a.nY)("user",{state:()=>({userInfo:null,loading:!1,initialized:!1}),getters:{isLoggedIn:e=>!!e.userInfo?.id,isAdmin:e=>"ADMIN"===e.userInfo?.role,isSeller:e=>"SELLER"===e.userInfo?.role},actions:{setUserInfo(e){this.userInfo=e,this.initialized=!0},async fetchUserInfo(){this.loading=!0;try{const e=await(0,o.HW)();this.userInfo=e.data}catch(e){return this.userInfo=null,Promise.reject(e)}finally{this.loading=!1,this.initialized=!0}},async logout(){await(0,o.ri)(),this.userInfo=null,this.initialized=!0}}})},6668:function(e,t,n){var a=n(3751),o=n(641);const r={id:"app"};function i(e,t,n,a,i,l){const s=(0,o.g2)("Header"),u=(0,o.g2)("el-header"),c=(0,o.g2)("router-view"),d=(0,o.g2)("el-main"),p=(0,o.g2)("Footer"),m=(0,o.g2)("el-footer"),f=(0,o.g2)("el-container");return(0,o.uX)(),(0,o.CE)("div",r,[(0,o.bF)(f,null,{default:(0,o.k6)(()=>[(0,o.bF)(u,null,{default:(0,o.k6)(()=>[(0,o.bF)(s)]),_:1}),(0,o.bF)(d,null,{default:(0,o.k6)(()=>[(0,o.bF)(c)]),_:1}),(0,o.bF)(m,null,{default:(0,o.k6)(()=>[(0,o.bF)(p)]),_:1})]),_:1})])}n(4114);var l=n(33),s=n(953),u=n(5220),c=n(6400),d=n(163),p=n(7918),m=n(5394),f=n(8548);const h={class:"modal-header"};var g={__name:"ShareModal",props:{modelValue:Boolean},emits:["update:modelValue","posted"],setup(e,{emit:t}){const n=e,a=t,r=(0,o.EW)({get:()=>n.modelValue,set:e=>a("update:modelValue",e)}),i=(0,s.KR)(null),l=e=>{i.value?.resetForm(),"function"===typeof e?e():r.value=!1},u=()=>{r.value=!1,a("posted")},c=e=>{const t=i.value?.hasUnsaved?.value;t?p.s.confirm("草稿将不会保存，确定要关闭吗？","提示",{confirmButtonText:"仍要关闭",cancelButtonText:"继续编辑",type:"warning",distinguishCancelAndClose:!0}).then(()=>{l(e)}).catch(()=>{}):l(e)};return(e,t)=>{const n=(0,o.g2)("el-icon"),a=(0,o.g2)("el-button"),l=(0,o.g2)("el-dialog");return(0,o.uX)(),(0,o.Wv)(l,{modelValue:r.value,"onUpdate:modelValue":t[0]||(t[0]=e=>r.value=e),width:"540px","close-on-click-modal":!1,"show-close":!1,"before-close":c},{header:(0,o.k6)(()=>[(0,o.Lk)("div",h,[t[1]||(t[1]=(0,o.Lk)("h3",null,"分享此刻",-1)),(0,o.bF)(a,{text:"",onClick:c},{default:(0,o.k6)(()=>[(0,o.bF)(n,null,{default:(0,o.k6)(()=>[(0,o.bF)((0,s.R1)(f.Close))]),_:1})]),_:1})])]),default:(0,o.k6)(()=>[(0,o.bF)(m.A,{ref_key:"composerRef",ref:i,mode:"modal",onSubmitted:u},null,512)]),_:1},8,["modelValue"])}}},v=n(6262);const b=(0,v.A)(g,[["__scopeId","data-v-4416fe80"]]);var k=b;const y={class:"header-container"},C={class:"header-content"},w={class:"header-left"},F={class:"nav-menu"},L=["onClick"],A={class:"header-center"},_={class:"header-right"},I={class:"user-entry"},E={class:"user-avatar"};var R={__name:"Header",setup(e){const t=(0,u.rd)(),n=(0,u.lq)(),r=(0,c.k)(),i=(0,s.KR)(""),p=(0,s.KR)(!1),m=[{path:"/",label:"广场"},{path:"/feed",label:"关注"},{path:"/nearby",label:"附近"},{path:"/ranking",label:"排行榜"},{path:"/bars",label:"酒吧"},{path:"/wiki",label:"维基"}];(0,o.sV)(()=>{r.initialized||r.loading||r.fetchUserInfo().catch(()=>{})});const f=()=>t.push("/"),h=e=>t.push(e),g=()=>{if(!r.isLoggedIn)return d.nk.warning("请先登录"),void t.push("/login");t.push("/messages")},v=()=>t.push("/user/profile?tab=posts"),b=()=>{if(!r.isLoggedIn)return d.nk.warning("请先登录"),void t.push("/login");t.push("/user/profile?tab=collections")},R=()=>{if(!r.isLoggedIn)return d.nk.warning("请先登录"),void t.push("/login");t.push("/user/profile?tab=history")},P=()=>t.push("/login"),S=()=>t.push("/register"),K=()=>{i.value&&t.push({path:"/search",query:{q:i.value}})},V=()=>{if(!r.isLoggedIn)return d.nk.warning("请先登录后再分享"),void t.push("/login");p.value=!0},W=()=>{t.replace({path:t.currentRoute.value.fullPath})},U=async e=>{"profile"===e?t.push("/user/profile"):"settings"===e?t.push("/user/settings"):"admin"===e?t.push("/admin/moderation"):"logout"===e&&(await r.logout(),d.nk.success("已退出登录"),t.push("/"))};return(e,t)=>{const u=(0,o.g2)("Search"),c=(0,o.g2)("el-icon"),d=(0,o.g2)("el-input"),j=(0,o.g2)("User"),x=(0,o.g2)("el-avatar"),z=(0,o.g2)("el-dropdown-item"),O=(0,o.g2)("el-dropdown-menu"),X=(0,o.g2)("el-dropdown"),B=(0,o.g2)("el-button");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("div",y,[(0,o.Lk)("div",C,[(0,o.Lk)("div",w,[(0,o.Lk)("div",{class:"logo",onClick:f},"醇饮"),(0,o.Lk)("div",F,[((0,o.uX)(),(0,o.CE)(o.FK,null,(0,o.pI)(m,e=>(0,o.Lk)("div",{key:e.path,class:(0,l.C4)(["nav-item",{active:(0,s.R1)(n).path===e.path}]),onClick:t=>h(e.path)},(0,l.v_)(e.label),11,L)),64))])]),(0,o.Lk)("div",A,[(0,o.bF)(d,{modelValue:i.value,"onUpdate:modelValue":t[0]||(t[0]=e=>i.value=e),placeholder:"探索动态 / 酒饮 / 用户",class:"search-input",onKeyup:(0,a.jR)(K,["enter"]),clearable:""},{prefix:(0,o.k6)(()=>[(0,o.bF)(c,{class:"search-icon"},{default:(0,o.k6)(()=>[(0,o.bF)(u)]),_:1})]),_:1},8,["modelValue"])]),(0,o.Lk)("div",_,[(0,o.Lk)("div",I,[(0,s.R1)(r).isLoggedIn?((0,o.uX)(),(0,o.Wv)(X,{key:0,onCommand:U},{dropdown:(0,o.k6)(()=>[(0,o.bF)(O,null,{default:(0,o.k6)(()=>[(0,o.bF)(z,{command:"profile"},{default:(0,o.k6)(()=>[...t[2]||(t[2]=[(0,o.eW)("个人中心",-1)])]),_:1}),(0,o.bF)(z,{command:"settings"},{default:(0,o.k6)(()=>[...t[3]||(t[3]=[(0,o.eW)("设置",-1)])]),_:1}),(0,s.R1)(r).isAdmin?((0,o.uX)(),(0,o.Wv)(z,{key:0,command:"admin",divided:""},{default:(0,o.k6)(()=>[...t[4]||(t[4]=[(0,o.Lk)("span",{style:{color:"#409EFF","font-weight":"600"}},"管理后台",-1)])]),_:1})):(0,o.Q3)("",!0),(0,o.bF)(z,{command:"logout",divided:""},{default:(0,o.k6)(()=>[...t[5]||(t[5]=[(0,o.eW)("退出登录",-1)])]),_:1})]),_:1})]),default:(0,o.k6)(()=>[(0,o.Lk)("span",E,[(0,o.bF)(x,{size:36,src:(0,s.R1)(r).userInfo.avatarUrl,alt:`${(0,s.R1)(r).userInfo?.username||"用户"}的头像`},{default:(0,o.k6)(()=>[(0,o.bF)(c,null,{default:(0,o.k6)(()=>[(0,o.bF)(j)]),_:1})]),_:1},8,["src","alt"])])]),_:1})):((0,o.uX)(),(0,o.CE)(o.FK,{key:1},[(0,o.bF)(B,{text:"",size:"small",onClick:P},{default:(0,o.k6)(()=>[...t[6]||(t[6]=[(0,o.eW)("登录",-1)])]),_:1}),(0,o.bF)(B,{text:"",size:"small",onClick:S},{default:(0,o.k6)(()=>[...t[7]||(t[7]=[(0,o.eW)("注册",-1)])]),_:1})],64))]),(0,o.Lk)("div",{class:"quick-links"},[(0,o.Lk)("span",{onClick:g},"消息"),(0,o.Lk)("span",{onClick:v},"动态"),(0,o.Lk)("span",{onClick:b},"收藏"),(0,o.Lk)("span",{onClick:R},"足迹")]),(0,o.bF)(B,{type:"primary",class:"share-btn",plain:"",onClick:V},{default:(0,o.k6)(()=>[...t[8]||(t[8]=[(0,o.eW)(" 分享此刻 ",-1)])]),_:1})])])]),(0,o.bF)(k,{modelValue:p.value,"onUpdate:modelValue":t[1]||(t[1]=e=>p.value=e),onPosted:W},null,8,["modelValue"])],64)}}};const P=(0,v.A)(R,[["__scopeId","data-v-4d92aa1d"]]);var S=P;const K={class:"footer-container"};function V(e,t,n,a,r,i){return(0,o.uX)(),(0,o.CE)("div",K,[...t[0]||(t[0]=[(0,o.Lk)("p",null,"© 2025 酒饮平台 | 酒精饮料信息分享社区",-1)])])}var W={name:"Footer"};const U=(0,v.A)(W,[["render",V],["__scopeId","data-v-a8084066"]]);var j=U,x={name:"App",components:{Header:S,Footer:j}};const z=(0,v.A)(x,[["render",i]]);var O=z,X=n(810);const B=(0,X.Ey)();var N=B;const q=[{path:"/",name:"Home",component:()=>n.e(309).then(n.bind(n,5309))},{path:"/feed",name:"Feed",component:()=>n.e(563).then(n.bind(n,9563)),meta:{requiresAuth:!0}},{path:"/nearby",name:"Nearby",component:()=>n.e(604).then(n.bind(n,2604))},{path:"/ranking",name:"Ranking",component:()=>n.e(77).then(n.bind(n,77)),meta:{title:"热门排行"}},{path:"/beverages",name:"BeverageList",component:()=>n.e(423).then(n.bind(n,4423))},{path:"/beverages/:id",name:"BeverageDetail",component:()=>n.e(508).then(n.bind(n,4508))},{path:"/bars",name:"BarList",component:()=>n.e(869).then(n.bind(n,5869))},{path:"/bars/register",name:"BarRegister",component:()=>n.e(62).then(n.bind(n,7062)),meta:{requiresAuth:!0}},{path:"/bars/:id",name:"BarDetail",component:()=>n.e(545).then(n.bind(n,545))},{path:"/announcements",name:"AnnouncementList",component:()=>n.e(953).then(n.bind(n,5953))},{path:"/wiki",name:"WikiList",component:()=>Promise.all([n.e(257),n.e(493)]).then(n.bind(n,9493))},{path:"/wiki/edit/:id?",name:"WikiEditor",component:()=>Promise.all([n.e(257),n.e(882)]).then(n.bind(n,3882)),meta:{requiresAuth:!0}},{path:"/wiki/:slug",name:"WikiDetail",component:()=>Promise.all([n.e(257),n.e(357)]).then(n.bind(n,2357))},{path:"/posts/:id",name:"PostDetail",component:()=>n.e(754).then(n.bind(n,2754))},{path:"/search",name:"Search",component:()=>n.e(209).then(n.bind(n,5209))},{path:"/messages",name:"Messages",component:()=>n.e(529).then(n.bind(n,4529)),meta:{requiresAuth:!0}},{path:"/login",name:"Login",component:()=>n.e(827).then(n.bind(n,7827))},{path:"/register",name:"Register",component:()=>n.e(961).then(n.bind(n,8961))},{path:"/user/profile",name:"UserProfile",component:()=>n.e(301).then(n.bind(n,2301)),meta:{requiresAuth:!0}},{path:"/user/settings",name:"UserSettings",component:()=>n.e(889).then(n.bind(n,1889)),meta:{requiresAuth:!0}},{path:"/users/:id",name:"UserHome",component:()=>n.e(718).then(n.bind(n,2718))},{path:"/admin/moderation",name:"AdminModeration",component:()=>n.e(501).then(n.bind(n,5882)),meta:{requiresAuth:!0,requiresAdmin:!0}}],$=(0,u.aE)({history:(0,u.LA)("/"),routes:q});$.beforeEach(async(e,t,n)=>{const a=(0,c.k)(N);a.initialized||a.loading||await a.fetchUserInfo().catch(()=>{}),e.meta.requiresAuth&&!a.isLoggedIn?n("/login"):e.meta.requiresAdmin&&!a.isAdmin?n("/"):n()});var T=$,D=n(6444);n(4188);const M=(0,a.Ef)(O);for(const[H,Q]of Object.entries(f))M.component(H,Q);M.use(T),M.use(N),M.use(D.A),M.mount("#app")},7277:function(e,t,n){var a=n(4335),o=n(163);const r=a.A.create({baseURL:"/api",timeout:3e4,withCredentials:!0});r.interceptors.response.use(e=>{const t=e.data;return 200!==t.code?(o.nk.error(t.message||"请求失败"),Promise.reject(new Error(t.message||"Error"))):t},e=>{if(e.response){const{status:t,config:n,data:a}=e.response,r=n?.url||"",i=r.includes("/auth/me"),l=["/login","/register"].some(e=>window.location.pathname.startsWith(e)),s=["/auth/login","/auth/register"].some(e=>r.includes(e)),u=a?.message;switch(t){case 401:if(i)break;s||o.nk.error(u||"请先登录"),l||s||(window.location.href="/login");break;case 403:o.nk.error(u||"没有访问权限");break;case 404:o.nk.error(u||"请求的资源不存在");break;default:o.nk.error(u||e.message||"请求失败")}}else o.nk.error("网络错误，请稍后再试");return Promise.reject(e)}),t.A=r}},t={};function n(a){var o=t[a];if(void 0!==o)return o.exports;var r=t[a]={exports:{}};return e[a].call(r.exports,r,r.exports,n),r.exports}n.m=e,function(){var e=[];n.O=function(t,a,o,r){if(!a){var i=1/0;for(c=0;c<e.length;c++){a=e[c][0],o=e[c][1],r=e[c][2];for(var l=!0,s=0;s<a.length;s++)(!1&r||i>=r)&&Object.keys(n.O).every(function(e){return n.O[e](a[s])})?a.splice(s--,1):(l=!1,r<i&&(i=r));if(l){e.splice(c--,1);var u=o();void 0!==u&&(t=u)}}return t}r=r||0;for(var c=e.length;c>0&&e[c-1][2]>r;c--)e[c]=e[c-1];e[c]=[a,o,r]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){n.f={},n.e=function(e){return Promise.all(Object.keys(n.f).reduce(function(t,a){return n.f[a](e,t),t},[]))}}(),function(){n.u=function(e){return"js/"+e+"."+{62:"a28f144b",77:"00104f70",209:"94d40b91",257:"c1860bf0",301:"95254581",309:"50f878bf",357:"68ed466d",423:"4f677125",493:"f4b8b6b0",501:"5f8db14f",508:"0b4413e3",529:"155ea361",545:"5570fbcf",563:"de293c66",604:"6c55e6fe",718:"af7b435c",754:"41d9b9e8",827:"ae85944d",869:"8725478f",882:"6ff553d1",889:"d80a629b",953:"d851306e",961:"39519383"}[e]+".js"}}(),function(){n.miniCssF=function(e){return"css/"+e+"."+{62:"0702b1be",77:"efab60a1",209:"faf4d9f2",301:"06e5617e",309:"41066060",357:"53236452",423:"826f373d",493:"2c2d9ba9",501:"39421062",508:"ac6609cf",529:"a44f9994",545:"394355ec",563:"5566bbeb",604:"401f4295",718:"78ce43df",754:"e399accc",827:"3e1a8be9",869:"5179f4aa",882:"feb45850",889:"9d5d2bce",953:"6fb5a4a4",961:"a4b1f1f1"}[e]+".css"}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="Chunyin:";n.l=function(a,o,r,i){if(e[a])e[a].push(o);else{var l,s;if(void 0!==r)for(var u=document.getElementsByTagName("script"),c=0;c<u.length;c++){var d=u[c];if(d.getAttribute("src")==a||d.getAttribute("data-webpack")==t+r){l=d;break}}l||(s=!0,l=document.createElement("script"),l.charset="utf-8",n.nc&&l.setAttribute("nonce",n.nc),l.setAttribute("data-webpack",t+r),l.src=a),e[a]=[o];var p=function(t,n){l.onerror=l.onload=null,clearTimeout(m);var o=e[a];if(delete e[a],l.parentNode&&l.parentNode.removeChild(l),o&&o.forEach(function(e){return e(n)}),t)return t(n)},m=setTimeout(p.bind(null,void 0,{type:"timeout",target:l}),12e4);l.onerror=p.bind(null,l.onerror),l.onload=p.bind(null,l.onload),s&&document.head.appendChild(l)}}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){n.p="/"}(),function(){if("undefined"!==typeof document){var e=function(e,t,a,o,r){var i=document.createElement("link");i.rel="stylesheet",i.type="text/css",n.nc&&(i.nonce=n.nc);var l=function(n){if(i.onerror=i.onload=null,"load"===n.type)o();else{var a=n&&n.type,l=n&&n.target&&n.target.href||t,s=new Error("Loading CSS chunk "+e+" failed.\n("+a+": "+l+")");s.name="ChunkLoadError",s.code="CSS_CHUNK_LOAD_FAILED",s.type=a,s.request=l,i.parentNode&&i.parentNode.removeChild(i),r(s)}};return i.onerror=i.onload=l,i.href=t,a?a.parentNode.insertBefore(i,a.nextSibling):document.head.appendChild(i),i},t=function(e,t){for(var n=document.getElementsByTagName("link"),a=0;a<n.length;a++){var o=n[a],r=o.getAttribute("data-href")||o.getAttribute("href");if("stylesheet"===o.rel&&(r===e||r===t))return o}var i=document.getElementsByTagName("style");for(a=0;a<i.length;a++){o=i[a],r=o.getAttribute("data-href");if(r===e||r===t)return o}},a=function(a){return new Promise(function(o,r){var i=n.miniCssF(a),l=n.p+i;if(t(i,l))return o();e(a,l,null,o,r)})},o={524:0};n.f.miniCss=function(e,t){var n={62:1,77:1,209:1,301:1,309:1,357:1,423:1,493:1,501:1,508:1,529:1,545:1,563:1,604:1,718:1,754:1,827:1,869:1,882:1,889:1,953:1,961:1};o[e]?t.push(o[e]):0!==o[e]&&n[e]&&t.push(o[e]=a(e).then(function(){o[e]=0},function(t){throw delete o[e],t}))}}}(),function(){var e={524:0};n.f.j=function(t,a){var o=n.o(e,t)?e[t]:void 0;if(0!==o)if(o)a.push(o[2]);else{var r=new Promise(function(n,a){o=e[t]=[n,a]});a.push(o[2]=r);var i=n.p+n.u(t),l=new Error,s=function(a){if(n.o(e,t)&&(o=e[t],0!==o&&(e[t]=void 0),o)){var r=a&&("load"===a.type?"missing":a.type),i=a&&a.target&&a.target.src;l.message="Loading chunk "+t+" failed.\n("+r+": "+i+")",l.name="ChunkLoadError",l.type=r,l.request=i,o[1](l)}};n.l(i,s,"chunk-"+t,t)}},n.O.j=function(t){return 0===e[t]};var t=function(t,a){var o,r,i=a[0],l=a[1],s=a[2],u=0;if(i.some(function(t){return 0!==e[t]})){for(o in l)n.o(l,o)&&(n.m[o]=l[o]);if(s)var c=s(n)}for(t&&t(a);u<i.length;u++)r=i[u],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return n.O(c)},a=self["webpackChunkChunyin"]=self["webpackChunkChunyin"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=n.O(void 0,[504],function(){return n(6668)});a=n.O(a)})();
//# sourceMappingURL=app.d963277e.js.map